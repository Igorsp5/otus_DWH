2022-01-08 14:20:19.606306 (MainThread): Running with dbt=0.21.1
2022-01-08 14:20:19.773874 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-01-08 14:20:19.774275 (MainThread): Tracking: do not track
2022-01-08 14:20:19.781821 (MainThread): Set downloads directory='/tmp/dbt-downloads-dnzho4h7'
2022-01-08 14:20:19.782136 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-01-08 14:20:20.926287 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-01-08 14:20:20.926936 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-08 14:20:21.874070 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-08 14:20:21.889974 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json
2022-01-08 14:20:22.655245 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json 200
2022-01-08 14:20:22.655745 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
2022-01-08 14:20:23.365198 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
2022-01-08 14:20:23.367958 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json
2022-01-08 14:20:24.262073 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json 200
2022-01-08 14:20:24.264819 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-08 14:20:25.040904 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-08 14:20:25.085073 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json
2022-01-08 14:20:25.841983 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json 200
2022-01-08 14:20:25.843381 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-08 14:20:26.592594 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-08 14:20:26.614393 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
2022-01-08 14:20:27.392371 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
2022-01-08 14:20:27.395181 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json
2022-01-08 14:20:28.367094 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json 200
2022-01-08 14:20:28.367512 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json
2022-01-08 14:20:29.191995 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json 200
2022-01-08 14:20:29.192868 (MainThread): Installing dbt-labs/dbt_utils@0.7.1
2022-01-08 14:20:29.794528 (MainThread):   Installed from version 0.7.1
2022-01-08 14:20:29.794743 (MainThread):   Updated version available: 0.8.0
2022-01-08 14:20:29.794946 (MainThread): Installing dbt-labs/codegen@0.4.0
2022-01-08 14:20:30.097832 (MainThread):   Installed from version 0.4.0
2022-01-08 14:20:30.098069 (MainThread):   Updated version available: 0.5.0
2022-01-08 14:20:30.098336 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
2022-01-08 14:20:30.098781 (MainThread): Flushing usage events
2022-01-08 14:25:22.991192 (MainThread): Running with dbt=0.21.1
2022-01-08 14:25:23.158865 (MainThread): running dbt with arguments Namespace(args='{}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='init_s3_sources', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='run-operation', write_json=True)
2022-01-08 14:25:23.159679 (MainThread): Tracking: do not track
2022-01-08 14:25:23.189316 (MainThread): Unable to do partial parsing because target/partial_parse.msgpack not found
2022-01-08 14:25:23.208166 (MainThread): Parsing macros/init_s3_sources.sql
2022-01-08 14:25:23.210293 (MainThread): Parsing macros/get_audit_schema.sql
2022-01-08 14:25:23.210828 (MainThread): Parsing macros/clickhouse__test_relationships.sql
2022-01-08 14:25:23.211486 (MainThread): Parsing macros/adapters.sql
2022-01-08 14:25:23.239903 (MainThread): Parsing macros/catalog.sql
2022-01-08 14:25:23.241285 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-08 14:25:23.242126 (MainThread): Parsing macros/materializations/test.sql
2022-01-08 14:25:23.243176 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-08 14:25:23.265671 (MainThread): Parsing macros/materializations/seed.sql
2022-01-08 14:25:23.269778 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-08 14:25:23.290266 (MainThread): Parsing macros/core.sql
2022-01-08 14:25:23.293522 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-08 14:25:23.294617 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-08 14:25:23.295840 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-08 14:25:23.297810 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-08 14:25:23.299273 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-08 14:25:23.301420 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-08 14:25:23.302822 (MainThread): Parsing macros/etc/datetime.sql
2022-01-08 14:25:23.310079 (MainThread): Parsing macros/etc/query.sql
2022-01-08 14:25:23.310967 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-08 14:25:23.312304 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-08 14:25:23.313638 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-08 14:25:23.315278 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-08 14:25:23.323639 (MainThread): Parsing macros/materializations/test.sql
2022-01-08 14:25:23.329533 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-08 14:25:23.348570 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-08 14:25:23.360185 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-08 14:25:23.361711 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-08 14:25:23.378187 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-08 14:25:23.386683 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-08 14:25:23.392804 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-08 14:25:23.398640 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-08 14:25:23.402000 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-08 14:25:23.416611 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-08 14:25:23.418086 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-08 14:25:23.443692 (MainThread): Parsing macros/adapters/common.sql
2022-01-08 14:25:23.489356 (MainThread): Parsing macros/sql/nullcheck.sql
2022-01-08 14:25:23.490914 (MainThread): Parsing macros/sql/star.sql
2022-01-08 14:25:23.493891 (MainThread): Parsing macros/sql/safe_add.sql
2022-01-08 14:25:23.495409 (MainThread): Parsing macros/sql/union.sql
2022-01-08 14:25:23.502563 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-01-08 14:25:23.507897 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-01-08 14:25:23.510886 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-01-08 14:25:23.512376 (MainThread): Parsing macros/sql/groupby.sql
2022-01-08 14:25:23.513608 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-01-08 14:25:23.515677 (MainThread): Parsing macros/sql/pivot.sql
2022-01-08 14:25:23.519173 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-01-08 14:25:23.520675 (MainThread): Parsing macros/sql/generate_series.sql
2022-01-08 14:25:23.524512 (MainThread): Parsing macros/sql/date_spine.sql
2022-01-08 14:25:23.528511 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-01-08 14:25:23.533599 (MainThread): Parsing macros/sql/unpivot.sql
2022-01-08 14:25:23.540442 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-01-08 14:25:23.543427 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-01-08 14:25:23.546490 (MainThread): Parsing macros/sql/get_column_values.sql
2022-01-08 14:25:23.550679 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-01-08 14:25:23.552160 (MainThread): Parsing macros/schema_tests/equality.sql
2022-01-08 14:25:23.555332 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-01-08 14:25:23.556645 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-01-08 14:25:23.559092 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-01-08 14:25:23.560570 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-01-08 14:25:23.562875 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-01-08 14:25:23.564022 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-01-08 14:25:23.566067 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-01-08 14:25:23.567693 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-01-08 14:25:23.574932 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-01-08 14:25:23.576806 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-01-08 14:25:23.578141 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-01-08 14:25:23.579290 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-01-08 14:25:23.581522 (MainThread): Parsing macros/schema_tests/recency.sql
2022-01-08 14:25:23.583105 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-01-08 14:25:23.584885 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-01-08 14:25:23.586005 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-01-08 14:25:23.587037 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-01-08 14:25:23.588115 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-01-08 14:25:23.589262 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-01-08 14:25:23.591294 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-01-08 14:25:23.592462 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-01-08 14:25:23.593494 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-01-08 14:25:23.594411 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-01-08 14:25:23.595661 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-01-08 14:25:23.597432 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-01-08 14:25:23.598387 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-01-08 14:25:23.600015 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-01-08 14:25:23.601565 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-01-08 14:25:23.603268 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-01-08 14:25:23.606702 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-01-08 14:25:23.608492 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-01-08 14:25:23.609503 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-01-08 14:25:23.610500 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-01-08 14:25:23.613660 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-01-08 14:25:23.617109 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-01-08 14:25:23.625432 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-01-08 14:25:23.627001 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-01-08 14:25:23.628909 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-01-08 14:25:23.633386 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-01-08 14:25:23.656222 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-01-08 14:25:23.661854 (MainThread): Parsing macros/web/get_url_path.sql
2022-01-08 14:25:23.664199 (MainThread): Parsing macros/web/get_url_host.sql
2022-01-08 14:25:23.665856 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-01-08 14:25:23.667335 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-01-08 14:25:23.688276 (MainThread): Parsing macros/generate_base_model.sql
2022-01-08 14:25:23.690898 (MainThread): Parsing macros/generate_source.sql
2022-01-08 14:25:23.696562 (MainThread): Parsing macros/generate_model_yaml.sql
2022-01-08 14:25:24.053018 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder_flat".
2022-01-08 14:25:24.078365 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder".
2022-01-08 14:25:24.083415 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.supplier".
2022-01-08 14:25:24.090386 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:25:24.098407 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.part".
2022-01-08 14:25:24.105078 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q4_2".
2022-01-08 14:25:24.110274 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q2_1".
2022-01-08 14:25:24.115232 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q3_3".
2022-01-08 14:25:24.162476 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.180704 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.182458 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.191770 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.192072 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.197336 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.197628 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.205573 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.209824 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.214274 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.215870 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.217677 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.219257 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.220814 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.226063 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.226338 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.249039 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.252967 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.256712 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:25:24.283850 (MainThread): Acquiring new clickhouse connection "macro_init_s3_sources".
2022-01-08 14:25:24.292185 (MainThread): Opening a new connection, currently in state init
2022-01-08 14:25:24.292433 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  ...
2022-01-08 14:25:24.292668 (MainThread): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:25:24.292832 (MainThread): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:25:24.888257 (MainThread): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:25:24.888691 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  
2022-01-08 14:25:24.889071 (MainThread): Block "" send time: 0.000044
2022-01-08 14:25:24.999306 (MainThread): SQL status: OK in 0.71 seconds
2022-01-08 14:25:25.000497 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
2022-01-08 14:25:25.105476 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  
2022-01-08 14:25:25.105782 (MainThread): Block "" send time: 0.000026
2022-01-08 14:25:25.223242 (MainThread): SQL status: OK in 0.22 seconds
2022-01-08 14:25:25.224345 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  ...
2022-01-08 14:25:25.328849 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  
2022-01-08 14:25:25.329147 (MainThread): Block "" send time: 0.000026
2022-01-08 14:25:25.508180 (MainThread): SQL status: OK in 0.28 seconds
2022-01-08 14:25:25.509244 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
2022-01-08 14:25:25.635117 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  
2022-01-08 14:25:25.635512 (MainThread): Block "" send time: 0.000026
2022-01-08 14:25:25.752815 (MainThread): SQL status: OK in 0.24 seconds
2022-01-08 14:25:25.753874 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  ...
2022-01-08 14:25:25.857751 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  
2022-01-08 14:25:25.858064 (MainThread): Block "" send time: 0.000027
2022-01-08 14:25:25.967182 (MainThread): SQL status: OK in 0.21 seconds
2022-01-08 14:25:25.968282 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
2022-01-08 14:25:26.076735 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  
2022-01-08 14:25:26.077090 (MainThread): Block "" send time: 0.000028
2022-01-08 14:25:26.200621 (MainThread): SQL status: OK in 0.23 seconds
2022-01-08 14:25:26.201728 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  ...
2022-01-08 14:25:26.305616 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  
2022-01-08 14:25:26.305924 (MainThread): Block "" send time: 0.000025
2022-01-08 14:25:26.423760 (MainThread): SQL status: OK in 0.22 seconds
2022-01-08 14:25:26.424843 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
2022-01-08 14:25:26.546686 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  
2022-01-08 14:25:26.547100 (MainThread): Block "" send time: 0.000034
2022-01-08 14:25:26.663141 (MainThread): SQL status: OK in 0.24 seconds
2022-01-08 14:25:26.664073 (MainThread): On macro_init_s3_sources: No close available on handle
2022-01-08 14:25:26.664496 (MainThread): Flushing usage events
2022-01-08 14:25:26.664662 (MainThread): Connection 'macro_init_s3_sources' was properly closed.
2022-01-08 14:25:26.664845 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 34522), raddr=('51.250.28.188', 9440)>
2022-01-08 14:25:56.408998 (MainThread): Running with dbt=0.21.1
2022-01-08 14:25:56.575012 (MainThread): running dbt with arguments Namespace(args='{}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='init_s3_sources', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='run-operation', write_json=True)
2022-01-08 14:25:56.575689 (MainThread): Tracking: do not track
2022-01-08 14:25:56.631194 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 14:25:56.631476 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 14:25:56.645086 (MainThread): Acquiring new clickhouse connection "macro_init_s3_sources".
2022-01-08 14:25:56.678165 (MainThread): Opening a new connection, currently in state init
2022-01-08 14:25:56.678428 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  ...
2022-01-08 14:25:56.678684 (MainThread): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:25:56.678872 (MainThread): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:25:57.252002 (MainThread): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:25:57.253398 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  
2022-01-08 14:25:57.254483 (MainThread): Block "" send time: 0.000129
2022-01-08 14:25:57.452296 (MainThread): SQL status: OK in 0.77 seconds
2022-01-08 14:25:57.456404 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
2022-01-08 14:25:57.656754 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  
2022-01-08 14:25:57.657528 (MainThread): Block "" send time: 0.000068
2022-01-08 14:25:57.774972 (MainThread): SQL status: OK in 0.32 seconds
2022-01-08 14:25:57.778662 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  ...
2022-01-08 14:25:57.903903 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  
2022-01-08 14:25:57.904527 (MainThread): Block "" send time: 0.000052
2022-01-08 14:25:58.012468 (MainThread): SQL status: OK in 0.23 seconds
2022-01-08 14:25:58.014414 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
2022-01-08 14:25:58.120044 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  
2022-01-08 14:25:58.121070 (MainThread): Block "" send time: 0.000089
2022-01-08 14:25:58.269620 (MainThread): SQL status: OK in 0.25 seconds
2022-01-08 14:25:58.273483 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  ...
2022-01-08 14:25:58.475945 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  
2022-01-08 14:25:58.477085 (MainThread): Block "" send time: 0.000094
2022-01-08 14:25:58.609754 (MainThread): SQL status: OK in 0.34 seconds
2022-01-08 14:25:58.613769 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
2022-01-08 14:25:58.818220 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  
2022-01-08 14:25:58.819289 (MainThread): Block "" send time: 0.000088
2022-01-08 14:25:58.993293 (MainThread): SQL status: OK in 0.38 seconds
2022-01-08 14:25:58.999043 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  ...
2022-01-08 14:25:59.104730 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  
2022-01-08 14:25:59.105802 (MainThread): Block "" send time: 0.000088
2022-01-08 14:25:59.213881 (MainThread): SQL status: OK in 0.21 seconds
2022-01-08 14:25:59.217784 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
2022-01-08 14:25:59.322925 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  
2022-01-08 14:25:59.323995 (MainThread): Block "" send time: 0.000097
2022-01-08 14:25:59.442459 (MainThread): SQL status: OK in 0.22 seconds
2022-01-08 14:25:59.445903 (MainThread): On macro_init_s3_sources: No close available on handle
2022-01-08 14:25:59.447423 (MainThread): Flushing usage events
2022-01-08 14:25:59.448098 (MainThread): Connection 'macro_init_s3_sources' was properly closed.
2022-01-08 14:25:59.448840 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 34562), raddr=('51.250.28.188', 9440)>
2022-01-08 14:27:50.579362 (MainThread): Running with dbt=0.21.1
2022-01-08 14:27:50.743890 (MainThread): running dbt with arguments Namespace(args='{}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='init_s3_sources', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='run-operation', write_json=True)
2022-01-08 14:27:50.752923 (MainThread): Tracking: do not track
2022-01-08 14:27:50.803818 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 14:27:50.804109 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 14:27:50.817063 (MainThread): Acquiring new clickhouse connection "macro_init_s3_sources".
2022-01-08 14:27:50.849520 (MainThread): Opening a new connection, currently in state init
2022-01-08 14:27:50.849750 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  ...
2022-01-08 14:27:50.849986 (MainThread): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:27:50.850147 (MainThread): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:27:51.276747 (MainThread): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:27:51.277172 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  
2022-01-08 14:27:51.277411 (MainThread): Block "" send time: 0.000028
2022-01-08 14:27:51.382295 (MainThread): SQL status: OK in 0.53 seconds
2022-01-08 14:27:51.383450 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
2022-01-08 14:27:51.489803 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  
2022-01-08 14:27:51.490095 (MainThread): Block "" send time: 0.000025
2022-01-08 14:27:51.626730 (MainThread): SQL status: OK in 0.24 seconds
2022-01-08 14:27:51.627811 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  ...
2022-01-08 14:27:51.732301 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  
2022-01-08 14:27:51.732592 (MainThread): Block "" send time: 0.000024
2022-01-08 14:27:51.837248 (MainThread): SQL status: OK in 0.21 seconds
2022-01-08 14:27:51.838350 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
2022-01-08 14:27:51.992831 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  
2022-01-08 14:27:51.994073 (MainThread): Block "" send time: 0.000082
2022-01-08 14:27:52.107675 (MainThread): SQL status: OK in 0.27 seconds
2022-01-08 14:27:52.110344 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  ...
2022-01-08 14:27:52.214593 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  
2022-01-08 14:27:52.214943 (MainThread): Block "" send time: 0.000030
2022-01-08 14:27:52.320001 (MainThread): SQL status: OK in 0.21 seconds
2022-01-08 14:27:52.321107 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
2022-01-08 14:27:52.425339 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  
2022-01-08 14:27:52.425652 (MainThread): Block "" send time: 0.000024
2022-01-08 14:27:52.538709 (MainThread): SQL status: OK in 0.22 seconds
2022-01-08 14:27:52.539781 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  ...
2022-01-08 14:27:52.752681 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  
2022-01-08 14:27:52.752976 (MainThread): Block "" send time: 0.000026
2022-01-08 14:27:52.857887 (MainThread): SQL status: OK in 0.32 seconds
2022-01-08 14:27:52.859262 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
2022-01-08 14:27:52.988890 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  
2022-01-08 14:27:52.989801 (MainThread): Block "" send time: 0.000078
2022-01-08 14:27:53.101391 (MainThread): SQL status: OK in 0.24 seconds
2022-01-08 14:27:53.102424 (MainThread): On macro_init_s3_sources: No close available on handle
2022-01-08 14:27:53.102891 (MainThread): Flushing usage events
2022-01-08 14:27:53.103082 (MainThread): Connection 'macro_init_s3_sources' was properly closed.
2022-01-08 14:27:53.103291 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 34690), raddr=('51.250.28.188', 9440)>
2022-01-08 14:29:10.693957 (MainThread): Running with dbt=0.21.1
2022-01-08 14:29:10.862269 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-01-08 14:29:10.871060 (MainThread): Tracking: do not track
2022-01-08 14:29:10.878940 (MainThread): Set downloads directory='/tmp/dbt-downloads-th0etmrc'
2022-01-08 14:29:10.879261 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-01-08 14:29:11.822850 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-01-08 14:29:11.823334 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-08 14:29:12.578997 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-08 14:29:12.594239 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json
2022-01-08 14:29:13.308543 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json 200
2022-01-08 14:29:13.308865 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
2022-01-08 14:29:14.051239 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
2022-01-08 14:29:14.060914 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json
2022-01-08 14:29:14.805259 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json 200
2022-01-08 14:29:14.805997 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-08 14:29:15.544623 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-08 14:29:15.560835 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json
2022-01-08 14:29:16.280196 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json 200
2022-01-08 14:29:16.280924 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-08 14:29:16.974800 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-08 14:29:17.016503 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
2022-01-08 14:29:17.750154 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
2022-01-08 14:29:17.752897 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json
2022-01-08 14:29:18.476345 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json 200
2022-01-08 14:29:18.476882 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json
2022-01-08 14:29:19.192279 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json 200
2022-01-08 14:29:19.192646 (MainThread): Installing dbt-labs/dbt_utils@0.7.1
2022-01-08 14:29:19.786442 (MainThread):   Installed from version 0.7.1
2022-01-08 14:29:19.786657 (MainThread):   Updated version available: 0.8.0
2022-01-08 14:29:19.786912 (MainThread): Installing dbt-labs/codegen@0.4.0
2022-01-08 14:29:20.122310 (MainThread):   Installed from version 0.4.0
2022-01-08 14:29:20.122515 (MainThread):   Updated version available: 0.5.0
2022-01-08 14:29:20.122709 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
2022-01-08 14:29:20.123047 (MainThread): Flushing usage events
2022-01-08 14:47:53.367339 (MainThread): Running with dbt=0.21.1
2022-01-08 14:47:53.543259 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 14:47:53.543962 (MainThread): Tracking: do not track
2022-01-08 14:47:53.599411 (MainThread): Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
2022-01-08 14:47:53.599730 (MainThread): Partial parsing: added file: clickhouse_starschema://macros/source/sources.yml
2022-01-08 14:47:53.615011 (MainThread): Flushing usage events
2022-01-08 14:47:53.615309 (MainThread): Encountered an error:
2022-01-08 14:47:53.615491 (MainThread): Compilation Error
  dbt found two resources with the name "dbgen_customer". Since these resources have the same name,
  dbt will be unable to find the correct resource when source("dbgen", "customer") is used. To fix this,
  change the name of one of these resources:
  - source.clickhouse_starschema.dbgen.customer (macros/source/sources.yml)
  - source.clickhouse_starschema.dbgen.customer (models/source/sources.yml)
2022-01-08 14:47:53.616614 (MainThread): Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/parser/manifest.py", line 325, in load
    self.parse_project(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/parser/manifest.py", line 414, in parse_project
    parser.parse_file(block, dct=dct)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/parser/schemas.py", line 512, in parse_file
    parser.parse()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/parser/schemas.py", line 662, in parse
    self.add_source_definitions(source)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/parser/schemas.py", line 689, in add_source_definitions
    self.manifest.add_source(self.yaml.file, source_def)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1047, in add_source
    _check_duplicates(source, self.sources)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/contracts/graph/manifest.py", line 1184, in _check_duplicates
    raise_duplicate_resource_name(value, src[value.unique_id])
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/exceptions.py", line 800, in raise_duplicate_resource_name
    raise_compiler_error(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/exceptions.py", line 447, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two resources with the name "dbgen_customer". Since these resources have the same name,
  dbt will be unable to find the correct resource when source("dbgen", "customer") is used. To fix this,
  change the name of one of these resources:
  - source.clickhouse_starschema.dbgen.customer (macros/source/sources.yml)
  - source.clickhouse_starschema.dbgen.customer (models/source/sources.yml)

2022-01-08 14:49:59.028589 (MainThread): Running with dbt=0.21.1
2022-01-08 14:49:59.223397 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 14:49:59.225428 (MainThread): Tracking: do not track
2022-01-08 14:49:59.280778 (MainThread): Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
2022-01-08 14:49:59.281122 (MainThread): Partial parsing: added file: clickhouse_starschema://macros/source/sources.yml
2022-01-08 14:49:59.281413 (MainThread): Partial parsing: deleted source source.clickhouse_starschema.dbgen.customer
2022-01-08 14:49:59.281573 (MainThread): Partial parsing: deleted source source.clickhouse_starschema.dbgen.lineorder
2022-01-08 14:49:59.281725 (MainThread): Partial parsing: deleted source source.clickhouse_starschema.dbgen.part
2022-01-08 14:49:59.281876 (MainThread): Partial parsing: deleted source source.clickhouse_starschema.dbgen.supplier
2022-01-08 14:49:59.293404 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q2_1".
2022-01-08 14:49:59.330079 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q3_3".
2022-01-08 14:49:59.333589 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q4_2".
2022-01-08 14:49:59.337049 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder_flat".
2022-01-08 14:49:59.354335 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:49:59.358923 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder".
2022-01-08 14:49:59.363489 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.part".
2022-01-08 14:49:59.367953 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.supplier".
2022-01-08 14:49:59.413663 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.415461 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.427134 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.427444 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.432617 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.432902 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.441260 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.445582 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.449978 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.451609 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.453392 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.454949 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.456519 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.461758 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.462029 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.474837 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.485479 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.489007 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.492269 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:49:59.511531 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 14:49:59.511999 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 370 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 14:49:59.513568 (MainThread): 
2022-01-08 14:49:59.513927 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:49:59.514588 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 14:49:59.523431 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 14:49:59.523696 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 14:49:59.523928 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:49:59.524161 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:50:00.278286 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:50:00.278605 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 14:50:00.278831 (ThreadPoolExecutor-0_0): Block "" send time: 0.000025
2022-01-08 14:50:00.379411 (ThreadPoolExecutor-0_0): SQL status: OK in 0.86 seconds
2022-01-08 14:50:00.380478 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 14:50:00.381633 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 14:50:00.381833 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35406), raddr=('51.250.28.188', 9440)>
2022-01-08 14:50:00.386428 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 14:50:00.386606 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 14:50:00.386879 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:50:00.387043 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:50:00.796504 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:50:00.796795 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 14:50:00.797019 (ThreadPoolExecutor-1_0): Block "" send time: 0.000023
2022-01-08 14:50:00.899841 (ThreadPoolExecutor-1_0): SQL status: OK in 0.51 seconds
2022-01-08 14:50:00.900967 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 14:50:00.901724 (MainThread): 17:50:00 | Concurrency: 4 threads (target='dev')
2022-01-08 14:50:00.901913 (MainThread): 17:50:00 | 
2022-01-08 14:50:00.903774 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 14:50:00.904051 (Thread-1): 17:50:00 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 14:50:00.904348 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:50:00.904537 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35408), raddr=('51.250.28.188', 9440)>
2022-01-08 14:50:00.904714 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 14:50:00.913888 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 14:50:00.914147 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  ...
2022-01-08 14:50:00.914369 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:50:00.914613 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:50:01.390327 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:50:01.390641 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  
2022-01-08 14:50:01.390864 (Thread-1): Block "" send time: 0.000024
2022-01-08 14:50:01.498460 (Thread-1): SQL status: OK in 0.58 seconds
2022-01-08 14:50:01.499605 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:50:01.499958 (Thread-1): finished collecting timing info
2022-01-08 14:50:01.529492 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:50:01.529886 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT 
FROM dbt.src_customer
  )...
2022-01-08 14:50:01.634730 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT 
FROM dbt.src_customer
  )
2022-01-08 14:50:01.635025 (Thread-1): Block "" send time: 0.000026
2022-01-08 14:50:01.871862 (Thread-1): Clickhouse error: Code: 62.
DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
  ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so

2022-01-08 14:50:01.872100 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 14:50:01.872301 (Thread-1): finished collecting timing info
2022-01-08 14:50:01.872628 (Thread-1): Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
    ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 65, in exception_handler
    yield
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 164, in execute
    response, columns = client.execute(sql, with_column_types=True)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 286, in execute
    rv = self.process_ordinary_query(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 479, in process_ordinary_query
    return self.receive_result(with_column_types=with_column_types,
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 136, in receive_result
    return result.get_result()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/result.py", line 50, in get_result
    for packet in self.packet_generator:
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 152, in packet_generator
    packet = self.receive_packet()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 169, in receive_packet
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 62.
DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
  ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 178, in execute
    return status, table
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 77, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
    ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:50:01.882480 (Thread-1): 17:50:01 | 1 of 1 ERROR creating table model db.customer........................ [ERROR in 0.98s]
2022-01-08 14:50:01.882650 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 14:50:01.883843 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:50:01.884152 (MainThread): 17:50:01 | 
2022-01-08 14:50:01.884318 (MainThread): 17:50:01 | Finished running 1 table model in 2.37s.
2022-01-08 14:50:01.884459 (MainThread): Connection 'master' was properly closed.
2022-01-08 14:50:01.884581 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 14:50:01.897548 (MainThread): 
2022-01-08 14:50:01.897853 (MainThread): Completed with 1 error and 0 warnings:
2022-01-08 14:50:01.898095 (MainThread): 
2022-01-08 14:50:01.898351 (MainThread): Database Error in model customer (models/staging/customer.sql)
2022-01-08 14:50:01.898590 (MainThread):   Code: 62.
2022-01-08 14:50:01.898820 (MainThread):   DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
2022-01-08 14:50:01.899048 (MainThread):     ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:
2022-01-08 14:50:01.899276 (MainThread):   
2022-01-08 14:50:01.899500 (MainThread):   0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.899726 (MainThread):   1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.899962 (MainThread):   2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.900203 (MainThread):   3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.900430 (MainThread):   4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.900653 (MainThread):   5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.900877 (MainThread):   6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.901099 (MainThread):   7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.901323 (MainThread):   8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.901541 (MainThread):   9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:50:01.901745 (MainThread):   10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2022-01-08 14:50:01.901960 (MainThread):   11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
2022-01-08 14:50:01.902174 (MainThread):   compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:50:01.902407 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-08 14:50:01.902723 (MainThread): Flushing usage events
2022-01-08 14:51:25.776727 (MainThread): Running with dbt=0.21.1
2022-01-08 14:51:25.958634 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-01-08 14:51:25.958996 (MainThread): Tracking: do not track
2022-01-08 14:51:25.967401 (MainThread): Set downloads directory='/tmp/dbt-downloads-6d31fc8p'
2022-01-08 14:51:25.967733 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-01-08 14:51:27.214677 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-01-08 14:51:27.215128 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-08 14:51:27.925311 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-08 14:51:27.940296 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json
2022-01-08 14:51:28.658929 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json 200
2022-01-08 14:51:28.659241 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
2022-01-08 14:51:29.406783 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
2022-01-08 14:51:29.410095 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json
2022-01-08 14:51:30.169787 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json 200
2022-01-08 14:51:30.170486 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-08 14:51:31.380487 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-08 14:51:31.395321 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json
2022-01-08 14:51:32.138798 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json 200
2022-01-08 14:51:32.139816 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-01-08 14:51:32.956458 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-01-08 14:51:32.984134 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
2022-01-08 14:51:33.728022 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
2022-01-08 14:51:33.732915 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json
2022-01-08 14:51:34.453680 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.7.1.json 200
2022-01-08 14:51:34.454138 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json
2022-01-08 14:51:35.186271 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen/0.4.0.json 200
2022-01-08 14:51:35.186790 (MainThread): Installing dbt-labs/dbt_utils@0.7.1
2022-01-08 14:51:36.364096 (MainThread):   Installed from version 0.7.1
2022-01-08 14:51:36.364337 (MainThread):   Updated version available: 0.8.0
2022-01-08 14:51:36.364559 (MainThread): Installing dbt-labs/codegen@0.4.0
2022-01-08 14:51:37.063233 (MainThread):   Installed from version 0.4.0
2022-01-08 14:51:37.063485 (MainThread):   Updated version available: 0.5.0
2022-01-08 14:51:37.063750 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils', 'dbt-labs/codegen']                 
Update your versions in packages.yml, then run dbt deps
2022-01-08 14:51:37.064338 (MainThread): Flushing usage events
2022-01-08 14:51:51.588158 (MainThread): Running with dbt=0.21.1
2022-01-08 14:51:51.787044 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 14:51:51.796114 (MainThread): Tracking: do not track
2022-01-08 14:51:51.869234 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 14:51:51.869528 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 14:51:51.927897 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 14:51:51.928468 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 370 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 14:51:51.929643 (MainThread): 
2022-01-08 14:51:51.929992 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:51:51.930762 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 14:51:51.938622 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 14:51:51.938877 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 14:51:51.939115 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:51:51.939286 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:51:52.374558 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:51:52.375034 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 14:51:52.375322 (ThreadPoolExecutor-0_0): Block "" send time: 0.000037
2022-01-08 14:51:52.475624 (ThreadPoolExecutor-0_0): SQL status: OK in 0.54 seconds
2022-01-08 14:51:52.476700 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 14:51:52.477848 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 14:51:52.478051 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35490), raddr=('51.250.28.188', 9440)>
2022-01-08 14:51:52.482527 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 14:51:52.482714 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 14:51:52.482907 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:51:52.483065 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:51:52.871170 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:51:52.871469 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 14:51:52.871692 (ThreadPoolExecutor-1_0): Block "" send time: 0.000023
2022-01-08 14:51:52.970047 (ThreadPoolExecutor-1_0): SQL status: OK in 0.49 seconds
2022-01-08 14:51:52.971290 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 14:51:52.972060 (MainThread): 17:51:52 | Concurrency: 4 threads (target='dev')
2022-01-08 14:51:52.972268 (MainThread): 17:51:52 | 
2022-01-08 14:51:52.974216 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 14:51:52.974529 (Thread-1): 17:51:52 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 14:51:52.974842 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:51:52.975090 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35492), raddr=('51.250.28.188', 9440)>
2022-01-08 14:51:52.975282 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 14:51:53.000872 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 14:51:53.001249 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  ...
2022-01-08 14:51:53.001613 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:51:53.001880 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:51:53.418093 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:51:53.418398 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  
2022-01-08 14:51:53.418633 (Thread-1): Block "" send time: 0.000025
2022-01-08 14:51:53.521481 (Thread-1): SQL status: OK in 0.52 seconds
2022-01-08 14:51:53.522661 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:51:53.522972 (Thread-1): finished collecting timing info
2022-01-08 14:51:53.552771 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:51:53.553118 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT 
FROM dbt.src_customer
  )...
2022-01-08 14:51:53.666874 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT 
FROM dbt.src_customer
  )
2022-01-08 14:51:53.667175 (Thread-1): Block "" send time: 0.000026
2022-01-08 14:51:53.769739 (Thread-1): Clickhouse error: Code: 62.
DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
  ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so

2022-01-08 14:51:53.769978 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 14:51:53.770175 (Thread-1): finished collecting timing info
2022-01-08 14:51:53.770551 (Thread-1): Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
    ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 65, in exception_handler
    yield
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 164, in execute
    response, columns = client.execute(sql, with_column_types=True)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 286, in execute
    rv = self.process_ordinary_query(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 479, in process_ordinary_query
    return self.receive_result(with_column_types=with_column_types,
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 136, in receive_result
    return result.get_result()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/result.py", line 50, in get_result
    for packet in self.packet_generator:
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 152, in packet_generator
    packet = self.receive_packet()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 169, in receive_packet
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 62.
DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
  ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 178, in execute
    return status, table
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 77, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
    ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:51:53.771995 (Thread-1): 17:51:53 | 1 of 1 ERROR creating table model db.customer........................ [ERROR in 0.80s]
2022-01-08 14:51:53.772181 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 14:51:53.773296 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:51:53.773605 (MainThread): 17:51:53 | 
2022-01-08 14:51:53.773770 (MainThread): 17:51:53 | Finished running 1 table model in 1.84s.
2022-01-08 14:51:53.773913 (MainThread): Connection 'master' was properly closed.
2022-01-08 14:51:53.774039 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 14:51:53.780755 (MainThread): 
2022-01-08 14:51:53.780959 (MainThread): Completed with 1 error and 0 warnings:
2022-01-08 14:51:53.781115 (MainThread): 
2022-01-08 14:51:53.781265 (MainThread): Database Error in model customer (models/staging/customer.sql)
2022-01-08 14:51:53.781406 (MainThread):   Code: 62.
2022-01-08 14:51:53.781549 (MainThread):   DB::Exception: Syntax error: failed at position 298 ('dbt') (line 16, col 6): dbt.src_customer
2022-01-08 14:51:53.781685 (MainThread):     ). Expected one of: UNION, LIMIT, WHERE, WINDOW, DoubleColon, LIKE, GLOBAL NOT IN, HAVING, AS, DIV, IS, UUID, GROUP BY, OR, EXCEPT, QuestionMark, OFFSET, BETWEEN, NOT LIKE, MOD, PREWHERE, AND, Comma, alias, ORDER BY, SETTINGS, IN, ILIKE, INTERSECT, FROM, Dot, NOT ILIKE, WITH, NOT, Arrow, token, NOT IN, GLOBAL IN. Stack trace:
2022-01-08 14:51:53.781817 (MainThread):   
2022-01-08 14:51:53.781945 (MainThread):   0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.782075 (MainThread):   1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.782204 (MainThread):   2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.782334 (MainThread):   3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.782463 (MainThread):   4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.782591 (MainThread):   5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.782719 (MainThread):   6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.782851 (MainThread):   7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.782977 (MainThread):   8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.783104 (MainThread):   9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:51:53.783237 (MainThread):   10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2022-01-08 14:51:53.783364 (MainThread):   11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
2022-01-08 14:51:53.783490 (MainThread):   compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:51:53.783627 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-08 14:51:53.783830 (MainThread): Flushing usage events
2022-01-08 14:52:51.230851 (MainThread): Running with dbt=0.21.1
2022-01-08 14:52:51.460653 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 14:52:51.461516 (MainThread): Tracking: do not track
2022-01-08 14:52:51.520574 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-01-08 14:52:51.520969 (MainThread): Partial parsing: updated file: clickhouse_starschema://models/staging/customer.sql
2022-01-08 14:52:51.531595 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:52:51.600542 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:52:51.602255 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:52:51.614391 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:52:51.614700 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:52:51.620094 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:52:51.620412 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:52:51.638816 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 14:52:51.639374 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 370 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 14:52:51.640555 (MainThread): 
2022-01-08 14:52:51.640884 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:52:51.641607 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 14:52:51.649131 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 14:52:51.649354 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 14:52:51.649598 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:52:51.649764 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:52:52.115002 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:52:52.115414 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 14:52:52.115656 (ThreadPoolExecutor-0_0): Block "" send time: 0.000027
2022-01-08 14:52:52.222487 (ThreadPoolExecutor-0_0): SQL status: OK in 0.57 seconds
2022-01-08 14:52:52.223563 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 14:52:52.224683 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 14:52:52.224900 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35518), raddr=('51.250.28.188', 9440)>
2022-01-08 14:52:52.229700 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 14:52:52.229910 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 14:52:52.230110 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:52:52.230273 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:52:52.631558 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:52:52.631852 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 14:52:52.632076 (ThreadPoolExecutor-1_0): Block "" send time: 0.000022
2022-01-08 14:52:52.732447 (ThreadPoolExecutor-1_0): SQL status: OK in 0.50 seconds
2022-01-08 14:52:52.734251 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 14:52:52.735179 (MainThread): 17:52:52 | Concurrency: 4 threads (target='dev')
2022-01-08 14:52:52.735378 (MainThread): 17:52:52 | 
2022-01-08 14:52:52.737692 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 14:52:52.738032 (Thread-1): 17:52:52 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 14:52:52.738365 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:52:52.738584 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35520), raddr=('51.250.28.188', 9440)>
2022-01-08 14:52:52.738775 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 14:52:52.746623 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 14:52:52.746853 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  ...
2022-01-08 14:52:52.747055 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:52:52.747213 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:52:53.175587 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:52:53.175898 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  
2022-01-08 14:52:53.176142 (Thread-1): Block "" send time: 0.000024
2022-01-08 14:52:53.284347 (Thread-1): SQL status: OK in 0.54 seconds
2022-01-08 14:52:53.285499 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:52:53.285802 (Thread-1): finished collecting timing info
2022-01-08 14:52:53.314845 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:52:53.315413 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---
FROM dbt.src_customer
  )...
2022-01-08 14:52:53.421088 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---
FROM dbt.src_customer
  )
2022-01-08 14:52:53.421412 (Thread-1): Block "" send time: 0.000027
2022-01-08 14:52:53.567225 (Thread-1): Clickhouse error: Code: 81.
DB::Exception: Database dbt doesn't exist. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so

2022-01-08 14:52:53.567470 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 14:52:53.567681 (Thread-1): finished collecting timing info
2022-01-08 14:52:53.568032 (Thread-1): Database Error in model customer (models/staging/customer.sql)
  Code: 81.
  DB::Exception: Database dbt doesn't exist. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 65, in exception_handler
    yield
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 164, in execute
    response, columns = client.execute(sql, with_column_types=True)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 286, in execute
    rv = self.process_ordinary_query(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 479, in process_ordinary_query
    return self.receive_result(with_column_types=with_column_types,
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 136, in receive_result
    return result.get_result()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/result.py", line 50, in get_result
    for packet in self.packet_generator:
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 152, in packet_generator
    packet = self.receive_packet()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 169, in receive_packet
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 81.
DB::Exception: Database dbt doesn't exist. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 178, in execute
    return status, table
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 77, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/staging/customer.sql)
  Code: 81.
  DB::Exception: Database dbt doesn't exist. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:52:53.569516 (Thread-1): 17:52:53 | 1 of 1 ERROR creating table model db.customer........................ [ERROR in 0.83s]
2022-01-08 14:52:53.569696 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 14:52:53.570754 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:52:53.571058 (MainThread): 17:52:53 | 
2022-01-08 14:52:53.571230 (MainThread): 17:52:53 | Finished running 1 table model in 1.93s.
2022-01-08 14:52:53.571386 (MainThread): Connection 'master' was properly closed.
2022-01-08 14:52:53.571546 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 14:52:53.579149 (MainThread): 
2022-01-08 14:52:53.579357 (MainThread): Completed with 1 error and 0 warnings:
2022-01-08 14:52:53.579517 (MainThread): 
2022-01-08 14:52:53.579676 (MainThread): Database Error in model customer (models/staging/customer.sql)
2022-01-08 14:52:53.579822 (MainThread):   Code: 81.
2022-01-08 14:52:53.579978 (MainThread):   DB::Exception: Database dbt doesn't exist. Stack trace:
2022-01-08 14:52:53.580136 (MainThread):   
2022-01-08 14:52:53.580275 (MainThread):   0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.580416 (MainThread):   1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.580550 (MainThread):   2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.580680 (MainThread):   3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.580808 (MainThread):   4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.580935 (MainThread):   5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.581067 (MainThread):   6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.581199 (MainThread):   7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.581347 (MainThread):   8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.581500 (MainThread):   9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.581690 (MainThread):   10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.581862 (MainThread):   11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.582036 (MainThread):   12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.582209 (MainThread):   13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.582379 (MainThread):   14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.582552 (MainThread):   15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.582724 (MainThread):   16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.582894 (MainThread):   17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.583064 (MainThread):   18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.583234 (MainThread):   19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.583400 (MainThread):   20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:52:53.583570 (MainThread):   21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2022-01-08 14:52:53.583740 (MainThread):   22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
2022-01-08 14:52:53.583910 (MainThread):   compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:52:53.584123 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-08 14:52:53.584380 (MainThread): Flushing usage events
2022-01-08 14:54:15.016793 (MainThread): Running with dbt=0.21.1
2022-01-08 14:54:15.193459 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 14:54:15.194397 (MainThread): Tracking: do not track
2022-01-08 14:54:15.250143 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 14:54:15.250433 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 14:54:15.291212 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 14:54:15.291752 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 370 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 14:54:15.293026 (MainThread): 
2022-01-08 14:54:15.293406 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:54:15.294245 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 14:54:15.302836 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 14:54:15.303092 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 14:54:15.303333 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:54:15.303493 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:54:15.730641 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:54:15.731059 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 14:54:15.731327 (ThreadPoolExecutor-0_0): Block "" send time: 0.000037
2022-01-08 14:54:15.838084 (ThreadPoolExecutor-0_0): SQL status: OK in 0.53 seconds
2022-01-08 14:54:15.839237 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 14:54:15.840460 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 14:54:15.840756 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35562), raddr=('51.250.28.188', 9440)>
2022-01-08 14:54:15.845219 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 14:54:15.845402 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 14:54:15.845594 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:54:15.845753 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:54:16.306088 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:54:16.306388 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 14:54:16.306615 (ThreadPoolExecutor-1_0): Block "" send time: 0.000024
2022-01-08 14:54:16.415824 (ThreadPoolExecutor-1_0): SQL status: OK in 0.57 seconds
2022-01-08 14:54:16.417067 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 14:54:16.417853 (MainThread): 17:54:16 | Concurrency: 4 threads (target='dev')
2022-01-08 14:54:16.418044 (MainThread): 17:54:16 | 
2022-01-08 14:54:16.419857 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 14:54:16.420189 (Thread-1): 17:54:16 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 14:54:16.420507 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:54:16.420700 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35564), raddr=('51.250.28.188', 9440)>
2022-01-08 14:54:16.420950 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 14:54:16.448790 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 14:54:16.449137 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  ...
2022-01-08 14:54:16.449450 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:54:16.449706 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:54:16.883619 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:54:16.883923 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  
2022-01-08 14:54:16.884161 (Thread-1): Block "" send time: 0.000030
2022-01-08 14:54:16.991408 (Thread-1): SQL status: OK in 0.54 seconds
2022-01-08 14:54:16.992600 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:54:16.992916 (Thread-1): finished collecting timing info
2022-01-08 14:54:17.022406 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:54:17.022781 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---
FROM dbt.src_customer
  )...
2022-01-08 14:54:17.135301 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---
FROM dbt.src_customer
  )
2022-01-08 14:54:17.135591 (Thread-1): Block "" send time: 0.000025
2022-01-08 14:54:17.246355 (Thread-1): Clickhouse error: Code: 81.
DB::Exception: Database dbt doesn't exist. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so

2022-01-08 14:54:17.246602 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 14:54:17.246812 (Thread-1): finished collecting timing info
2022-01-08 14:54:17.247164 (Thread-1): Database Error in model customer (models/staging/customer.sql)
  Code: 81.
  DB::Exception: Database dbt doesn't exist. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 65, in exception_handler
    yield
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 164, in execute
    response, columns = client.execute(sql, with_column_types=True)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 286, in execute
    rv = self.process_ordinary_query(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 479, in process_ordinary_query
    return self.receive_result(with_column_types=with_column_types,
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 136, in receive_result
    return result.get_result()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/result.py", line 50, in get_result
    for packet in self.packet_generator:
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 152, in packet_generator
    packet = self.receive_packet()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 169, in receive_packet
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 81.
DB::Exception: Database dbt doesn't exist. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 178, in execute
    return status, table
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 77, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/staging/customer.sql)
  Code: 81.
  DB::Exception: Database dbt doesn't exist. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:54:17.248577 (Thread-1): 17:54:17 | 1 of 1 ERROR creating table model db.customer........................ [ERROR in 0.83s]
2022-01-08 14:54:17.248760 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 14:54:17.250089 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:54:17.250396 (MainThread): 17:54:17 | 
2022-01-08 14:54:17.250566 (MainThread): 17:54:17 | Finished running 1 table model in 1.96s.
2022-01-08 14:54:17.250750 (MainThread): Connection 'master' was properly closed.
2022-01-08 14:54:17.250917 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 14:54:17.258325 (MainThread): 
2022-01-08 14:54:17.258574 (MainThread): Completed with 1 error and 0 warnings:
2022-01-08 14:54:17.258777 (MainThread): 
2022-01-08 14:54:17.259191 (MainThread): Database Error in model customer (models/staging/customer.sql)
2022-01-08 14:54:17.259453 (MainThread):   Code: 81.
2022-01-08 14:54:17.259732 (MainThread):   DB::Exception: Database dbt doesn't exist. Stack trace:
2022-01-08 14:54:17.259960 (MainThread):   
2022-01-08 14:54:17.260219 (MainThread):   0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.260478 (MainThread):   1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.260727 (MainThread):   2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.260979 (MainThread):   3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.261215 (MainThread):   4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.261550 (MainThread):   5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.261821 (MainThread):   6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.262059 (MainThread):   7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.262293 (MainThread):   8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.262574 (MainThread):   9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.262965 (MainThread):   10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.263198 (MainThread):   11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.263450 (MainThread):   12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.263699 (MainThread):   13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.263943 (MainThread):   14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.264201 (MainThread):   15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.264440 (MainThread):   16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.264674 (MainThread):   17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.264903 (MainThread):   18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.265127 (MainThread):   19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.265360 (MainThread):   20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:54:17.265610 (MainThread):   21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2022-01-08 14:54:17.265849 (MainThread):   22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
2022-01-08 14:54:17.266078 (MainThread):   compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:54:17.266323 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-08 14:54:17.266649 (MainThread): Flushing usage events
2022-01-08 14:55:39.693120 (MainThread): Running with dbt=0.21.1
2022-01-08 14:55:39.891362 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 14:55:39.892304 (MainThread): Tracking: do not track
2022-01-08 14:55:39.930500 (MainThread): Unable to do partial parsing because a project config has changed
2022-01-08 14:55:39.952880 (MainThread): Parsing macros/init_s3_sources.sql
2022-01-08 14:55:39.956344 (MainThread): Parsing macros/clickhouse__test_relationships.sql
2022-01-08 14:55:39.957584 (MainThread): Parsing macros/adapters.sql
2022-01-08 14:55:39.985237 (MainThread): Parsing macros/catalog.sql
2022-01-08 14:55:39.986592 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-08 14:55:39.987446 (MainThread): Parsing macros/materializations/test.sql
2022-01-08 14:55:39.988514 (MainThread): Parsing macros/materializations/snapshot.sql
2022-01-08 14:55:40.011602 (MainThread): Parsing macros/materializations/seed.sql
2022-01-08 14:55:40.015908 (MainThread): Parsing macros/materializations/incremental.sql
2022-01-08 14:55:40.038757 (MainThread): Parsing macros/core.sql
2022-01-08 14:55:40.042087 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-01-08 14:55:40.043223 (MainThread): Parsing macros/schema_tests/unique.sql
2022-01-08 14:55:40.044492 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-01-08 14:55:40.046495 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-01-08 14:55:40.047990 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-01-08 14:55:40.050201 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-01-08 14:55:40.051648 (MainThread): Parsing macros/etc/datetime.sql
2022-01-08 14:55:40.059188 (MainThread): Parsing macros/etc/query.sql
2022-01-08 14:55:40.060180 (MainThread): Parsing macros/etc/is_incremental.sql
2022-01-08 14:55:40.061539 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-01-08 14:55:40.062872 (MainThread): Parsing macros/etc/where_subquery.sql
2022-01-08 14:55:40.064552 (MainThread): Parsing macros/materializations/helpers.sql
2022-01-08 14:55:40.073105 (MainThread): Parsing macros/materializations/test.sql
2022-01-08 14:55:40.081595 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-01-08 14:55:40.123467 (MainThread): Parsing macros/materializations/common/merge.sql
2022-01-08 14:55:40.135631 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-01-08 14:55:40.137256 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-01-08 14:55:40.154113 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-01-08 14:55:40.162880 (MainThread): Parsing macros/materializations/table/table.sql
2022-01-08 14:55:40.169254 (MainThread): Parsing macros/materializations/view/view.sql
2022-01-08 14:55:40.175279 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-01-08 14:55:40.178707 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-01-08 14:55:40.193384 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-01-08 14:55:40.194974 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-01-08 14:55:40.220575 (MainThread): Parsing macros/adapters/common.sql
2022-01-08 14:55:40.266541 (MainThread): Parsing macros/sql/nullcheck.sql
2022-01-08 14:55:40.268287 (MainThread): Parsing macros/sql/star.sql
2022-01-08 14:55:40.271882 (MainThread): Parsing macros/sql/safe_add.sql
2022-01-08 14:55:40.274048 (MainThread): Parsing macros/sql/union.sql
2022-01-08 14:55:40.281896 (MainThread): Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-01-08 14:55:40.287726 (MainThread): Parsing macros/sql/get_relations_by_pattern.sql
2022-01-08 14:55:40.290854 (MainThread): Parsing macros/sql/nullcheck_table.sql
2022-01-08 14:55:40.292405 (MainThread): Parsing macros/sql/groupby.sql
2022-01-08 14:55:40.293670 (MainThread): Parsing macros/sql/get_query_results_as_dict.sql
2022-01-08 14:55:40.295928 (MainThread): Parsing macros/sql/pivot.sql
2022-01-08 14:55:40.299577 (MainThread): Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-01-08 14:55:40.301141 (MainThread): Parsing macros/sql/generate_series.sql
2022-01-08 14:55:40.305389 (MainThread): Parsing macros/sql/date_spine.sql
2022-01-08 14:55:40.309585 (MainThread): Parsing macros/sql/haversine_distance.sql
2022-01-08 14:55:40.315008 (MainThread): Parsing macros/sql/unpivot.sql
2022-01-08 14:55:40.322225 (MainThread): Parsing macros/sql/get_relations_by_prefix.sql
2022-01-08 14:55:40.325269 (MainThread): Parsing macros/sql/surrogate_key.sql
2022-01-08 14:55:40.328509 (MainThread): Parsing macros/sql/get_column_values.sql
2022-01-08 14:55:40.333944 (MainThread): Parsing macros/schema_tests/fewer_rows_than.sql
2022-01-08 14:55:40.335538 (MainThread): Parsing macros/schema_tests/equality.sql
2022-01-08 14:55:40.339002 (MainThread): Parsing macros/schema_tests/test_not_null_where.sql
2022-01-08 14:55:40.340355 (MainThread): Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-01-08 14:55:40.342941 (MainThread): Parsing macros/schema_tests/equal_rowcount.sql
2022-01-08 14:55:40.344522 (MainThread): Parsing macros/schema_tests/sequential_values.sql
2022-01-08 14:55:40.347308 (MainThread): Parsing macros/schema_tests/at_least_one.sql
2022-01-08 14:55:40.348896 (MainThread): Parsing macros/schema_tests/relationships_where.sql
2022-01-08 14:55:40.351036 (MainThread): Parsing macros/schema_tests/expression_is_true.sql
2022-01-08 14:55:40.352672 (MainThread): Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-01-08 14:55:40.360062 (MainThread): Parsing macros/schema_tests/not_accepted_values.sql
2022-01-08 14:55:40.361966 (MainThread): Parsing macros/schema_tests/test_unique_where.sql
2022-01-08 14:55:40.363407 (MainThread): Parsing macros/schema_tests/not_constant.sql
2022-01-08 14:55:40.364566 (MainThread): Parsing macros/schema_tests/accepted_range.sql
2022-01-08 14:55:40.366821 (MainThread): Parsing macros/schema_tests/recency.sql
2022-01-08 14:55:40.368446 (MainThread): Parsing macros/schema_tests/cardinality_equality.sql
2022-01-08 14:55:40.370279 (MainThread): Parsing macros/jinja_helpers/pretty_time.sql
2022-01-08 14:55:40.371650 (MainThread): Parsing macros/jinja_helpers/log_info.sql
2022-01-08 14:55:40.372772 (MainThread): Parsing macros/jinja_helpers/slugify.sql
2022-01-08 14:55:40.373895 (MainThread): Parsing macros/jinja_helpers/pretty_log_format.sql
2022-01-08 14:55:40.375122 (MainThread): Parsing macros/cross_db_utils/right.sql
2022-01-08 14:55:40.377181 (MainThread): Parsing macros/cross_db_utils/replace.sql
2022-01-08 14:55:40.378341 (MainThread): Parsing macros/cross_db_utils/_is_relation.sql
2022-01-08 14:55:40.379506 (MainThread): Parsing macros/cross_db_utils/literal.sql
2022-01-08 14:55:40.380436 (MainThread): Parsing macros/cross_db_utils/length.sql
2022-01-08 14:55:40.381669 (MainThread): Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-01-08 14:55:40.383412 (MainThread): Parsing macros/cross_db_utils/concat.sql
2022-01-08 14:55:40.384395 (MainThread): Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-01-08 14:55:40.385768 (MainThread): Parsing macros/cross_db_utils/hash.sql
2022-01-08 14:55:40.387120 (MainThread): Parsing macros/cross_db_utils/date_trunc.sql
2022-01-08 14:55:40.389056 (MainThread): Parsing macros/cross_db_utils/dateadd.sql
2022-01-08 14:55:40.391683 (MainThread): Parsing macros/cross_db_utils/split_part.sql
2022-01-08 14:55:40.393386 (MainThread): Parsing macros/cross_db_utils/except.sql
2022-01-08 14:55:40.394407 (MainThread): Parsing macros/cross_db_utils/intersect.sql
2022-01-08 14:55:40.395429 (MainThread): Parsing macros/cross_db_utils/last_day.sql
2022-01-08 14:55:40.398816 (MainThread): Parsing macros/cross_db_utils/current_timestamp.sql
2022-01-08 14:55:40.402135 (MainThread): Parsing macros/cross_db_utils/datediff.sql
2022-01-08 14:55:40.410578 (MainThread): Parsing macros/cross_db_utils/identifier.sql
2022-01-08 14:55:40.412143 (MainThread): Parsing macros/cross_db_utils/position.sql
2022-01-08 14:55:40.413722 (MainThread): Parsing macros/cross_db_utils/width_bucket.sql
2022-01-08 14:55:40.418118 (MainThread): Parsing macros/cross_db_utils/safe_cast.sql
2022-01-08 14:55:40.419963 (MainThread): Parsing macros/cross_db_utils/datatypes.sql
2022-01-08 14:55:40.425399 (MainThread): Parsing macros/web/get_url_path.sql
2022-01-08 14:55:40.427786 (MainThread): Parsing macros/web/get_url_host.sql
2022-01-08 14:55:40.429395 (MainThread): Parsing macros/web/get_url_parameter.sql
2022-01-08 14:55:40.430956 (MainThread): Parsing macros/materializations/insert_by_period_materialization.sql
2022-01-08 14:55:40.452135 (MainThread): Parsing macros/generate_base_model.sql
2022-01-08 14:55:40.454736 (MainThread): Parsing macros/generate_source.sql
2022-01-08 14:55:40.460457 (MainThread): Parsing macros/generate_model_yaml.sql
2022-01-08 14:55:40.782881 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder_flat".
2022-01-08 14:55:40.809006 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder".
2022-01-08 14:55:40.814637 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.supplier".
2022-01-08 14:55:40.819135 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:55:40.823620 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.part".
2022-01-08 14:55:40.827991 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q4_2".
2022-01-08 14:55:40.831521 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q2_1".
2022-01-08 14:55:40.834849 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q3_3".
2022-01-08 14:55:40.880440 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.899364 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.901051 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.909814 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.910115 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.915406 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.915686 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.923508 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.927932 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.932040 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.933886 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.935450 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.937042 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.938608 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.944178 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.944533 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.956422 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.959894 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:40.963505 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 14:55:41.003606 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 14:55:41.004138 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 14:55:41.005356 (MainThread): 
2022-01-08 14:55:41.005685 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:55:41.006350 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 14:55:41.014192 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 14:55:41.014447 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 14:55:41.014695 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:55:41.014864 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:55:41.429025 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:55:41.429348 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 14:55:41.429583 (ThreadPoolExecutor-0_0): Block "" send time: 0.000028
2022-01-08 14:55:41.534672 (ThreadPoolExecutor-0_0): SQL status: OK in 0.52 seconds
2022-01-08 14:55:41.535790 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 14:55:41.536992 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 14:55:41.537205 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35614), raddr=('51.250.28.188', 9440)>
2022-01-08 14:55:41.541877 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 14:55:41.542067 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 14:55:41.542260 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:55:41.542419 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:55:41.940661 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:55:41.940960 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 14:55:41.941191 (ThreadPoolExecutor-1_0): Block "" send time: 0.000023
2022-01-08 14:55:42.042715 (ThreadPoolExecutor-1_0): SQL status: OK in 0.50 seconds
2022-01-08 14:55:42.043856 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 14:55:42.044641 (MainThread): 17:55:42 | Concurrency: 4 threads (target='dev')
2022-01-08 14:55:42.044821 (MainThread): 17:55:42 | 
2022-01-08 14:55:42.046606 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 14:55:42.046902 (Thread-1): 17:55:42 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 14:55:42.047200 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:55:42.047385 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35616), raddr=('51.250.28.188', 9440)>
2022-01-08 14:55:42.047582 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 14:55:42.055655 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 14:55:42.055964 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  ...
2022-01-08 14:55:42.056187 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:55:42.056350 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:55:42.515792 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:55:42.516168 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  
2022-01-08 14:55:42.516425 (Thread-1): Block "" send time: 0.000025
2022-01-08 14:55:42.626929 (Thread-1): SQL status: OK in 0.57 seconds
2022-01-08 14:55:42.628815 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:55:42.629300 (Thread-1): finished collecting timing info
2022-01-08 14:55:42.669488 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:55:42.669874 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---
FROM dbt.src_customer
  )...
2022-01-08 14:55:42.799475 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---
FROM dbt.src_customer
  )
2022-01-08 14:55:42.799785 (Thread-1): Block "" send time: 0.000026
2022-01-08 14:55:42.908178 (Thread-1): Clickhouse error: Code: 81.
DB::Exception: Database dbt doesn't exist. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so

2022-01-08 14:55:42.908436 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 14:55:42.908645 (Thread-1): finished collecting timing info
2022-01-08 14:55:42.909002 (Thread-1): Database Error in model customer (models/staging/customer.sql)
  Code: 81.
  DB::Exception: Database dbt doesn't exist. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 65, in exception_handler
    yield
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 164, in execute
    response, columns = client.execute(sql, with_column_types=True)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 286, in execute
    rv = self.process_ordinary_query(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 479, in process_ordinary_query
    return self.receive_result(with_column_types=with_column_types,
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 136, in receive_result
    return result.get_result()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/result.py", line 50, in get_result
    for packet in self.packet_generator:
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 152, in packet_generator
    packet = self.receive_packet()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 169, in receive_packet
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 81.
DB::Exception: Database dbt doesn't exist. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 178, in execute
    return status, table
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 77, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/staging/customer.sql)
  Code: 81.
  DB::Exception: Database dbt doesn't exist. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:55:42.910452 (Thread-1): 17:55:42 | 1 of 1 ERROR creating table model db.customer........................ [ERROR in 0.86s]
2022-01-08 14:55:42.910638 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 14:55:42.911715 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:55:42.912033 (MainThread): 17:55:42 | 
2022-01-08 14:55:42.912218 (MainThread): 17:55:42 | Finished running 1 table model in 1.91s.
2022-01-08 14:55:42.912378 (MainThread): Connection 'master' was properly closed.
2022-01-08 14:55:42.912515 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 14:55:42.919595 (MainThread): 
2022-01-08 14:55:42.919803 (MainThread): Completed with 1 error and 0 warnings:
2022-01-08 14:55:42.919974 (MainThread): 
2022-01-08 14:55:42.920147 (MainThread): Database Error in model customer (models/staging/customer.sql)
2022-01-08 14:55:42.920309 (MainThread):   Code: 81.
2022-01-08 14:55:42.920492 (MainThread):   DB::Exception: Database dbt doesn't exist. Stack trace:
2022-01-08 14:55:42.920662 (MainThread):   
2022-01-08 14:55:42.920832 (MainThread):   0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.920999 (MainThread):   1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.921185 (MainThread):   2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.921352 (MainThread):   3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.921529 (MainThread):   4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.921675 (MainThread):   5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.921824 (MainThread):   6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.921968 (MainThread):   7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.922110 (MainThread):   8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.922254 (MainThread):   9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.922395 (MainThread):   10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.922535 (MainThread):   11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.922673 (MainThread):   12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.922816 (MainThread):   13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.922992 (MainThread):   14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.923136 (MainThread):   15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.923278 (MainThread):   16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.923418 (MainThread):   17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.923563 (MainThread):   18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.923732 (MainThread):   19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.923878 (MainThread):   20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:55:42.924049 (MainThread):   21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2022-01-08 14:55:42.924225 (MainThread):   22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
2022-01-08 14:55:42.924380 (MainThread):   compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:55:42.924560 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-08 14:55:42.924796 (MainThread): Flushing usage events
2022-01-08 14:56:29.910348 (MainThread): Running with dbt=0.21.1
2022-01-08 14:56:30.116450 (MainThread): running dbt with arguments Namespace(args='{}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='init_s3_sources', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='run-operation', write_json=True)
2022-01-08 14:56:30.117234 (MainThread): Tracking: do not track
2022-01-08 14:56:30.171055 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 14:56:30.171348 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 14:56:30.184307 (MainThread): Acquiring new clickhouse connection "macro_init_s3_sources".
2022-01-08 14:56:30.219235 (MainThread): Opening a new connection, currently in state init
2022-01-08 14:56:30.219591 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  ...
2022-01-08 14:56:30.219938 (MainThread): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:56:30.220195 (MainThread): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:56:30.761788 (MainThread): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:56:30.762227 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  
2022-01-08 14:56:30.762495 (MainThread): Block "" send time: 0.000027
2022-01-08 14:56:30.864168 (MainThread): SQL status: OK in 0.64 seconds
2022-01-08 14:56:30.865428 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
2022-01-08 14:56:31.007018 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  
2022-01-08 14:56:31.007440 (MainThread): Block "" send time: 0.000031
2022-01-08 14:56:31.123475 (MainThread): SQL status: OK in 0.26 seconds
2022-01-08 14:56:31.124671 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  ...
2022-01-08 14:56:31.261056 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  
2022-01-08 14:56:31.261360 (MainThread): Block "" send time: 0.000026
2022-01-08 14:56:31.364070 (MainThread): SQL status: OK in 0.24 seconds
2022-01-08 14:56:31.365172 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
2022-01-08 14:56:31.466260 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  
2022-01-08 14:56:31.466565 (MainThread): Block "" send time: 0.000024
2022-01-08 14:56:31.585104 (MainThread): SQL status: OK in 0.22 seconds
2022-01-08 14:56:31.586210 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  ...
2022-01-08 14:56:31.704227 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  
2022-01-08 14:56:31.704514 (MainThread): Block "" send time: 0.000024
2022-01-08 14:56:31.806412 (MainThread): SQL status: OK in 0.22 seconds
2022-01-08 14:56:31.807493 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
2022-01-08 14:56:31.907698 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  
2022-01-08 14:56:31.908009 (MainThread): Block "" send time: 0.000026
2022-01-08 14:56:32.013878 (MainThread): SQL status: OK in 0.21 seconds
2022-01-08 14:56:32.014982 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  ...
2022-01-08 14:56:32.115752 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  
2022-01-08 14:56:32.116209 (MainThread): Block "" send time: 0.000044
2022-01-08 14:56:32.221051 (MainThread): SQL status: OK in 0.21 seconds
2022-01-08 14:56:32.222769 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
2022-01-08 14:56:32.330496 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  
2022-01-08 14:56:32.330939 (MainThread): Block "" send time: 0.000035
2022-01-08 14:56:32.444618 (MainThread): SQL status: OK in 0.22 seconds
2022-01-08 14:56:32.446133 (MainThread): On macro_init_s3_sources: No close available on handle
2022-01-08 14:56:32.446802 (MainThread): Flushing usage events
2022-01-08 14:56:32.447073 (MainThread): Connection 'macro_init_s3_sources' was properly closed.
2022-01-08 14:56:32.447377 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35666), raddr=('51.250.28.188', 9440)>
2022-01-08 14:56:36.778822 (MainThread): Running with dbt=0.21.1
2022-01-08 14:56:36.964872 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 14:56:36.973984 (MainThread): Tracking: do not track
2022-01-08 14:56:37.028461 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 14:56:37.028767 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 14:56:37.074114 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 14:56:37.074654 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 14:56:37.075898 (MainThread): 
2022-01-08 14:56:37.076291 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:56:37.077098 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 14:56:37.086999 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 14:56:37.087260 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 14:56:37.087508 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:56:37.087680 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:56:37.520729 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:56:37.521200 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 14:56:37.521466 (ThreadPoolExecutor-0_0): Block "" send time: 0.000029
2022-01-08 14:56:37.624455 (ThreadPoolExecutor-0_0): SQL status: OK in 0.54 seconds
2022-01-08 14:56:37.625544 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 14:56:37.626762 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 14:56:37.626971 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35670), raddr=('51.250.28.188', 9440)>
2022-01-08 14:56:37.631519 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 14:56:37.631708 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 14:56:37.631902 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:56:37.632060 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:56:38.098816 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:56:38.099128 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 14:56:38.099368 (ThreadPoolExecutor-1_0): Block "" send time: 0.000024
2022-01-08 14:56:38.210293 (ThreadPoolExecutor-1_0): SQL status: OK in 0.58 seconds
2022-01-08 14:56:38.212358 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 14:56:38.213366 (MainThread): 17:56:38 | Concurrency: 4 threads (target='dev')
2022-01-08 14:56:38.213574 (MainThread): 17:56:38 | 
2022-01-08 14:56:38.215244 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 14:56:38.215608 (Thread-1): 17:56:38 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 14:56:38.216045 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 14:56:38.216298 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 35672), raddr=('51.250.28.188', 9440)>
2022-01-08 14:56:38.216625 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 14:56:38.241316 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 14:56:38.241558 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  ...
2022-01-08 14:56:38.241774 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 14:56:38.241939 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 14:56:38.659106 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 14:56:38.659437 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'dbt'
    
    order by position
  
2022-01-08 14:56:38.659703 (Thread-1): Block "" send time: 0.000033
2022-01-08 14:56:38.763990 (Thread-1): SQL status: OK in 0.52 seconds
2022-01-08 14:56:38.765173 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:56:38.765483 (Thread-1): finished collecting timing info
2022-01-08 14:56:38.796397 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 14:56:38.796797 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---
FROM dbt.src_customer
  )...
2022-01-08 14:56:38.899419 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---
FROM dbt.src_customer
  )
2022-01-08 14:56:38.899737 (Thread-1): Block "" send time: 0.000032
2022-01-08 14:56:39.003804 (Thread-1): Clickhouse error: Code: 81.
DB::Exception: Database dbt doesn't exist. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so

2022-01-08 14:56:39.004097 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 14:56:39.004320 (Thread-1): finished collecting timing info
2022-01-08 14:56:39.004674 (Thread-1): Database Error in model customer (models/staging/customer.sql)
  Code: 81.
  DB::Exception: Database dbt doesn't exist. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 65, in exception_handler
    yield
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 164, in execute
    response, columns = client.execute(sql, with_column_types=True)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 286, in execute
    rv = self.process_ordinary_query(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 479, in process_ordinary_query
    return self.receive_result(with_column_types=with_column_types,
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 136, in receive_result
    return result.get_result()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/result.py", line 50, in get_result
    for packet in self.packet_generator:
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 152, in packet_generator
    packet = self.receive_packet()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 169, in receive_packet
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 81.
DB::Exception: Database dbt doesn't exist. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 178, in execute
    return status, table
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 77, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/staging/customer.sql)
  Code: 81.
  DB::Exception: Database dbt doesn't exist. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:56:39.006106 (Thread-1): 17:56:39 | 1 of 1 ERROR creating table model db.customer........................ [ERROR in 0.79s]
2022-01-08 14:56:39.006293 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 14:56:39.007349 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 14:56:39.007655 (MainThread): 17:56:39 | 
2022-01-08 14:56:39.007836 (MainThread): 17:56:39 | Finished running 1 table model in 1.93s.
2022-01-08 14:56:39.008005 (MainThread): Connection 'master' was properly closed.
2022-01-08 14:56:39.008173 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 14:56:39.015138 (MainThread): 
2022-01-08 14:56:39.015360 (MainThread): Completed with 1 error and 0 warnings:
2022-01-08 14:56:39.015522 (MainThread): 
2022-01-08 14:56:39.015692 (MainThread): Database Error in model customer (models/staging/customer.sql)
2022-01-08 14:56:39.015855 (MainThread):   Code: 81.
2022-01-08 14:56:39.016010 (MainThread):   DB::Exception: Database dbt doesn't exist. Stack trace:
2022-01-08 14:56:39.016179 (MainThread):   
2022-01-08 14:56:39.016360 (MainThread):   0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.016496 (MainThread):   1. DB::DatabaseCatalog::assertDatabaseExistsUnlocked(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f3695a in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.016628 (MainThread):   2. DB::DatabaseCatalog::getDatabase(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&) const @ 0x11f37e78 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.016758 (MainThread):   3. DB::Context::resolveStorageID(DB::StorageID, DB::Context::StorageNamespace) const @ 0x11ed535e in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.016887 (MainThread):   4. DB::JoinedTables::getLeftTableStorage() @ 0x12585913 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.017015 (MainThread):   5. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, std::__1::optional<DB::Pipe>, std::__1::shared_ptr<DB::IStorage> const&, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, std::__1::shared_ptr<DB::StorageInMemoryMetadata const> const&, std::__1::unordered_map<DB::PreparedSetKey, std::__1::shared_ptr<DB::Set>, DB::PreparedSetKey::Hash, std::__1::equal_to<DB::PreparedSetKey>, std::__1::allocator<std::__1::pair<DB::PreparedSetKey const, std::__1::shared_ptr<DB::Set> > > >) @ 0x12322823 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.017149 (MainThread):   6. DB::InterpreterSelectQuery::InterpreterSelectQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12321c54 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.017284 (MainThread):   7. DB::InterpreterSelectWithUnionQuery::buildCurrentChildInterpreter(std::__1::shared_ptr<DB::IAST> const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12547fa2 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.017423 (MainThread):   8. DB::InterpreterSelectWithUnionQuery::InterpreterSelectWithUnionQuery(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, DB::SelectQueryOptions const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) @ 0x12546680 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.017568 (MainThread):   9. DB::InterpreterSelectWithUnionQuery::getSampleBlock(std::__1::shared_ptr<DB::IAST> const&, std::__1::shared_ptr<DB::Context const>, bool) @ 0x12548e42 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.017753 (MainThread):   10. DB::InterpreterCreateQuery::getTablePropertiesAndNormalizeCreateQuery(DB::ASTCreateQuery&) const @ 0x12023b01 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.017921 (MainThread):   11. DB::InterpreterCreateQuery::createTable(DB::ASTCreateQuery&) @ 0x120291ca in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.018090 (MainThread):   12. DB::InterpreterCreateQuery::execute() @ 0x1202fa4b in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.018260 (MainThread):   13. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277df89 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.018425 (MainThread):   14. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.018596 (MainThread):   15. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.018734 (MainThread):   16. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.018871 (MainThread):   17. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.019021 (MainThread):   18. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.019165 (MainThread):   19. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.019310 (MainThread):   20. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 14:56:39.019461 (MainThread):   21. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2022-01-08 14:56:39.019611 (MainThread):   22. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
2022-01-08 14:56:39.019762 (MainThread):   compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 14:56:39.019928 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-08 14:56:39.020199 (MainThread): Flushing usage events
2022-01-08 15:12:59.775578 (MainThread): Running with dbt=0.21.1
2022-01-08 15:12:59.941998 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 15:12:59.942637 (MainThread): Tracking: do not track
2022-01-08 15:12:59.995091 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-01-08 15:12:59.995513 (MainThread): Partial parsing: deleted source source.clickhouse_starschema.dbgen.customer
2022-01-08 15:12:59.995686 (MainThread): Partial parsing: deleted source source.clickhouse_starschema.dbgen.lineorder
2022-01-08 15:12:59.995860 (MainThread): Partial parsing: deleted source source.clickhouse_starschema.dbgen.part
2022-01-08 15:12:59.996018 (MainThread): Partial parsing: deleted source source.clickhouse_starschema.dbgen.supplier
2022-01-08 15:12:59.996157 (MainThread): Partial parsing: update schema file: clickhouse_starschema://macros/source/sources.yml
2022-01-08 15:13:00.010293 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q2_1".
2022-01-08 15:13:00.052708 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q3_3".
2022-01-08 15:13:00.056771 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.q4_2".
2022-01-08 15:13:00.060356 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder_flat".
2022-01-08 15:13:00.077908 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:13:00.082175 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder".
2022-01-08 15:13:00.086669 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.part".
2022-01-08 15:13:00.090871 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.supplier".
2022-01-08 15:13:00.123774 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.125359 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.136571 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.136837 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.141837 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.142096 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.149657 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.154526 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.159802 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.161458 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.163060 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.164632 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.166351 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.171632 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.171930 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.184418 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.195035 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.198275 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.201702 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:00.229965 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 15:13:00.230434 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 15:13:00.231579 (MainThread): 
2022-01-08 15:13:00.231880 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:13:00.232506 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 15:13:00.240998 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 15:13:00.241249 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 15:13:00.241486 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:13:00.241646 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:13:00.648375 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:13:00.649398 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 15:13:00.650252 (ThreadPoolExecutor-0_0): Block "" send time: 0.000096
2022-01-08 15:13:00.751134 (ThreadPoolExecutor-0_0): SQL status: OK in 0.51 seconds
2022-01-08 15:13:00.754923 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 15:13:00.757003 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 15:13:00.757272 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 58816), raddr=('51.250.28.188', 9440)>
2022-01-08 15:13:00.764143 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 15:13:00.764414 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 15:13:00.764723 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:13:00.764999 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:13:01.379572 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:13:01.380625 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 15:13:01.381536 (ThreadPoolExecutor-1_0): Block "" send time: 0.000087
2022-01-08 15:13:01.582899 (ThreadPoolExecutor-1_0): SQL status: OK in 0.82 seconds
2022-01-08 15:13:01.587067 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 15:13:01.589564 (MainThread): 18:13:01 | Concurrency: 4 threads (target='dev')
2022-01-08 15:13:01.590286 (MainThread): 18:13:01 | 
2022-01-08 15:13:01.602166 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 15:13:01.602634 (Thread-1): 18:13:01 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 15:13:01.603139 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:13:01.603423 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 58818), raddr=('51.250.28.188', 9440)>
2022-01-08 15:13:01.603733 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 15:13:01.614350 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 15:13:01.614637 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:13:01.614897 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:13:01.615094 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:13:02.197281 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:13:02.198372 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:13:02.199314 (Thread-1): Block "" send time: 0.000087
2022-01-08 15:13:02.464587 (Thread-1): SQL status: OK in 0.85 seconds
2022-01-08 15:13:02.468789 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:02.469022 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:02.469237 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:02.469447 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:02.469652 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:02.469858 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:02.470099 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:02.470301 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:13:02.470723 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:13:02.471122 (Thread-1): finished collecting timing info
2022-01-08 15:13:02.504660 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:13:02.504971 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  )...
2022-01-08 15:13:02.606607 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  )
2022-01-08 15:13:02.606909 (Thread-1): Block "" send time: 0.000026
2022-01-08 15:13:02.810699 (Thread-1): Clickhouse error: Code: 62.
DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  ). Expected alias cannot be here. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so

2022-01-08 15:13:02.811600 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 15:13:02.812455 (Thread-1): finished collecting timing info
2022-01-08 15:13:02.813750 (Thread-1): Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
    "C_ADDRESS",
    "C_CITY",
    "C_NATION",
    "C_REGION",
    "C_PHONE",
    "C_MKTSEGMENT"
  FROM db.src_customer
    ). Expected alias cannot be here. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 65, in exception_handler
    yield
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 164, in execute
    response, columns = client.execute(sql, with_column_types=True)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 286, in execute
    rv = self.process_ordinary_query(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 479, in process_ordinary_query
    return self.receive_result(with_column_types=with_column_types,
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 136, in receive_result
    return result.get_result()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/result.py", line 50, in get_result
    for packet in self.packet_generator:
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 152, in packet_generator
    packet = self.receive_packet()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 169, in receive_packet
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 62.
DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  ). Expected alias cannot be here. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 178, in execute
    return status, table
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 77, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
    "C_ADDRESS",
    "C_CITY",
    "C_NATION",
    "C_REGION",
    "C_PHONE",
    "C_MKTSEGMENT"
  FROM db.src_customer
    ). Expected alias cannot be here. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 15:13:02.822974 (Thread-1): 18:13:02 | 1 of 1 ERROR creating table model db.customer........................ [ERROR in 1.22s]
2022-01-08 15:13:02.823708 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 15:13:02.827320 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:13:02.828485 (MainThread): 18:13:02 | 
2022-01-08 15:13:02.829136 (MainThread): 18:13:02 | Finished running 1 table model in 2.60s.
2022-01-08 15:13:02.829739 (MainThread): Connection 'master' was properly closed.
2022-01-08 15:13:02.830236 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 15:13:02.850532 (MainThread): 
2022-01-08 15:13:02.850774 (MainThread): Completed with 1 error and 0 warnings:
2022-01-08 15:13:02.850957 (MainThread): 
2022-01-08 15:13:02.851137 (MainThread): Database Error in model customer (models/staging/customer.sql)
2022-01-08 15:13:02.851306 (MainThread):   Code: 62.
2022-01-08 15:13:02.851469 (MainThread):   DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
2022-01-08 15:13:02.851639 (MainThread):     "C_ADDRESS",
2022-01-08 15:13:02.851820 (MainThread):     "C_CITY",
2022-01-08 15:13:02.851979 (MainThread):     "C_NATION",
2022-01-08 15:13:02.852153 (MainThread):     "C_REGION",
2022-01-08 15:13:02.852330 (MainThread):     "C_PHONE",
2022-01-08 15:13:02.852595 (MainThread):     "C_MKTSEGMENT"
2022-01-08 15:13:02.852864 (MainThread):   FROM db.src_customer
2022-01-08 15:13:02.853139 (MainThread):     ). Expected alias cannot be here. Stack trace:
2022-01-08 15:13:02.853411 (MainThread):   
2022-01-08 15:13:02.853682 (MainThread):   0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.853869 (MainThread):   1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.854030 (MainThread):   2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.854193 (MainThread):   3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.854347 (MainThread):   4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.854500 (MainThread):   5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.854649 (MainThread):   6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.854796 (MainThread):   7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.854944 (MainThread):   8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.855091 (MainThread):   9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:13:02.855239 (MainThread):   10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2022-01-08 15:13:02.855387 (MainThread):   11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
2022-01-08 15:13:02.855535 (MainThread):   compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 15:13:02.855703 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-08 15:13:02.855966 (MainThread): Flushing usage events
2022-01-08 15:14:32.022557 (MainThread): Running with dbt=0.21.1
2022-01-08 15:14:32.187385 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 15:14:32.196358 (MainThread): Tracking: do not track
2022-01-08 15:14:32.247184 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-01-08 15:14:32.247500 (MainThread): Partial parsing: updated file: clickhouse_starschema://models/staging/customer.sql
2022-01-08 15:14:32.258829 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:14:32.324831 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:32.326708 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:32.338465 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:32.338744 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:32.343943 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:32.344214 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:32.361717 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 15:14:32.362229 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 15:14:32.363380 (MainThread): 
2022-01-08 15:14:32.363685 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:14:32.364325 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 15:14:32.374239 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 15:14:32.374492 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 15:14:32.374729 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:14:32.374889 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:14:32.921513 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:14:32.922796 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 15:14:32.923660 (ThreadPoolExecutor-0_0): Block "" send time: 0.000102
2022-01-08 15:14:33.226348 (ThreadPoolExecutor-0_0): SQL status: OK in 0.85 seconds
2022-01-08 15:14:33.230074 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 15:14:33.231908 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 15:14:33.232181 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 58828), raddr=('51.250.28.188', 9440)>
2022-01-08 15:14:33.238671 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 15:14:33.238904 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 15:14:33.239143 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:14:33.239344 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:14:33.635616 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:14:33.636594 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 15:14:33.637409 (ThreadPoolExecutor-1_0): Block "" send time: 0.000080
2022-01-08 15:14:33.738940 (ThreadPoolExecutor-1_0): SQL status: OK in 0.50 seconds
2022-01-08 15:14:33.742799 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 15:14:33.745365 (MainThread): 18:14:33 | Concurrency: 4 threads (target='dev')
2022-01-08 15:14:33.746070 (MainThread): 18:14:33 | 
2022-01-08 15:14:33.750939 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 15:14:33.751381 (Thread-1): 18:14:33 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 15:14:33.751863 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:14:33.752162 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 58830), raddr=('51.250.28.188', 9440)>
2022-01-08 15:14:33.752438 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 15:14:33.764887 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 15:14:33.765169 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:14:33.765402 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:14:33.765585 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:14:34.455164 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:14:34.456150 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:14:34.456990 (Thread-1): Block "" send time: 0.000084
2022-01-08 15:14:34.660888 (Thread-1): SQL status: OK in 0.90 seconds
2022-01-08 15:14:34.665185 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:34.665601 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:34.665805 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:34.666003 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:34.666222 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:34.666435 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:34.666622 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:34.666809 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:14:34.667218 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:14:34.667589 (Thread-1): finished collecting timing info
2022-01-08 15:14:34.701984 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:14:34.702276 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer;
  )...
2022-01-08 15:14:34.864147 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  * ---"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer;
  )
2022-01-08 15:14:34.864492 (Thread-1): Block "" send time: 0.000032
2022-01-08 15:14:35.069868 (Thread-1): Clickhouse error: Code: 62.
DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer;
  ). Expected alias cannot be here. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so

2022-01-08 15:14:35.070721 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 15:14:35.071481 (Thread-1): finished collecting timing info
2022-01-08 15:14:35.072791 (Thread-1): Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
    "C_ADDRESS",
    "C_CITY",
    "C_NATION",
    "C_REGION",
    "C_PHONE",
    "C_MKTSEGMENT"
  FROM db.src_customer;
    ). Expected alias cannot be here. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 65, in exception_handler
    yield
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 164, in execute
    response, columns = client.execute(sql, with_column_types=True)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 286, in execute
    rv = self.process_ordinary_query(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 479, in process_ordinary_query
    return self.receive_result(with_column_types=with_column_types,
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 136, in receive_result
    return result.get_result()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/result.py", line 50, in get_result
    for packet in self.packet_generator:
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 152, in packet_generator
    packet = self.receive_packet()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 169, in receive_packet
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 62.
DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer;
  ). Expected alias cannot be here. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 178, in execute
    return status, table
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 77, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
    "C_ADDRESS",
    "C_CITY",
    "C_NATION",
    "C_REGION",
    "C_PHONE",
    "C_MKTSEGMENT"
  FROM db.src_customer;
    ). Expected alias cannot be here. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 15:14:35.078522 (Thread-1): 18:14:35 | 1 of 1 ERROR creating table model db.customer........................ [ERROR in 1.33s]
2022-01-08 15:14:35.079200 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 15:14:35.082711 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:14:35.084003 (MainThread): 18:14:35 | 
2022-01-08 15:14:35.084658 (MainThread): 18:14:35 | Finished running 1 table model in 2.72s.
2022-01-08 15:14:35.085236 (MainThread): Connection 'master' was properly closed.
2022-01-08 15:14:35.085784 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 15:14:35.100896 (MainThread): 
2022-01-08 15:14:35.101167 (MainThread): Completed with 1 error and 0 warnings:
2022-01-08 15:14:35.101498 (MainThread): 
2022-01-08 15:14:35.101743 (MainThread): Database Error in model customer (models/staging/customer.sql)
2022-01-08 15:14:35.102010 (MainThread):   Code: 62.
2022-01-08 15:14:35.102251 (MainThread):   DB::Exception: Syntax error: failed at position 321 (',') (line 16, col 11): ,
2022-01-08 15:14:35.102445 (MainThread):     "C_ADDRESS",
2022-01-08 15:14:35.102673 (MainThread):     "C_CITY",
2022-01-08 15:14:35.102873 (MainThread):     "C_NATION",
2022-01-08 15:14:35.103078 (MainThread):     "C_REGION",
2022-01-08 15:14:35.103316 (MainThread):     "C_PHONE",
2022-01-08 15:14:35.103503 (MainThread):     "C_MKTSEGMENT"
2022-01-08 15:14:35.103752 (MainThread):   FROM db.src_customer;
2022-01-08 15:14:35.104008 (MainThread):     ). Expected alias cannot be here. Stack trace:
2022-01-08 15:14:35.104258 (MainThread):   
2022-01-08 15:14:35.104523 (MainThread):   0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.104764 (MainThread):   1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.105011 (MainThread):   2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.105253 (MainThread):   3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.105510 (MainThread):   4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.105739 (MainThread):   5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.105984 (MainThread):   6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.106228 (MainThread):   7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.106460 (MainThread):   8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.106621 (MainThread):   9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:14:35.106776 (MainThread):   10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2022-01-08 15:14:35.106928 (MainThread):   11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
2022-01-08 15:14:35.107115 (MainThread):   compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 15:14:35.107377 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-08 15:14:35.107711 (MainThread): Flushing usage events
2022-01-08 15:15:10.426734 (MainThread): Running with dbt=0.21.1
2022-01-08 15:15:10.593226 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 15:15:10.593907 (MainThread): Tracking: do not track
2022-01-08 15:15:10.645310 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-01-08 15:15:10.645631 (MainThread): Partial parsing: updated file: clickhouse_starschema://models/staging/customer.sql
2022-01-08 15:15:10.658770 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:15:10.734395 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:10.736249 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:10.747998 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:10.748279 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:10.753354 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:10.753625 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:10.771257 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 15:15:10.771796 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 15:15:10.772947 (MainThread): 
2022-01-08 15:15:10.773255 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:15:10.773890 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 15:15:10.782070 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 15:15:10.782331 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 15:15:10.782571 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:15:10.782734 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:15:11.424229 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:15:11.425518 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 15:15:11.426385 (ThreadPoolExecutor-0_0): Block "" send time: 0.000100
2022-01-08 15:15:11.630031 (ThreadPoolExecutor-0_0): SQL status: OK in 0.85 seconds
2022-01-08 15:15:11.633766 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 15:15:11.635961 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 15:15:11.636222 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 58838), raddr=('51.250.28.188', 9440)>
2022-01-08 15:15:11.642158 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 15:15:11.642375 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 15:15:11.642602 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:15:11.642791 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:15:12.036774 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:15:12.037728 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 15:15:12.038559 (ThreadPoolExecutor-1_0): Block "" send time: 0.000083
2022-01-08 15:15:12.136337 (ThreadPoolExecutor-1_0): SQL status: OK in 0.49 seconds
2022-01-08 15:15:12.140266 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 15:15:12.141263 (MainThread): 18:15:12 | Concurrency: 4 threads (target='dev')
2022-01-08 15:15:12.141523 (MainThread): 18:15:12 | 
2022-01-08 15:15:12.144181 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 15:15:12.144595 (Thread-1): 18:15:12 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 15:15:12.145024 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:15:12.145304 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 58840), raddr=('51.250.28.188', 9440)>
2022-01-08 15:15:12.145572 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 15:15:12.158293 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 15:15:12.158594 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:15:12.158863 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:15:12.159069 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:15:12.861005 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:15:12.862050 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:15:12.862964 (Thread-1): Block "" send time: 0.000089
2022-01-08 15:15:13.075758 (Thread-1): SQL status: OK in 0.92 seconds
2022-01-08 15:15:13.080109 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:13.080365 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:13.080573 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:13.080772 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:13.080967 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:13.081156 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:13.081348 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:13.081537 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:15:13.081954 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:15:13.082349 (Thread-1): finished collecting timing info
2022-01-08 15:15:13.116344 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:15:13.116643 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer;
  )...
2022-01-08 15:15:13.268754 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer;
  )
2022-01-08 15:15:13.269102 (Thread-1): Block "" send time: 0.000033
2022-01-08 15:15:13.474575 (Thread-1): Clickhouse error: Code: 62.
DB::Exception: Syntax error: failed at position 423 (end of query) (line 23, col 21): ;
  ). Expected one of: UNION, LIMIT, SAMPLE, WHERE, WINDOW, INNER, HAVING, AS, UUID, GROUP BY, EXCEPT, identifier, OFFSET, LEFT ARRAY JOIN, PREWHERE, JOIN, alias, ORDER BY, array join, SETTINGS, ARRAY JOIN, INTERSECT, Dot, WITH, table, table function, subquery or list of joined tables, FINAL, token. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so

2022-01-08 15:15:13.475421 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 15:15:13.476211 (Thread-1): finished collecting timing info
2022-01-08 15:15:13.477480 (Thread-1): Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 423 (end of query) (line 23, col 21): ;
    ). Expected one of: UNION, LIMIT, SAMPLE, WHERE, WINDOW, INNER, HAVING, AS, UUID, GROUP BY, EXCEPT, identifier, OFFSET, LEFT ARRAY JOIN, PREWHERE, JOIN, alias, ORDER BY, array join, SETTINGS, ARRAY JOIN, INTERSECT, Dot, WITH, table, table function, subquery or list of joined tables, FINAL, token. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 65, in exception_handler
    yield
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 164, in execute
    response, columns = client.execute(sql, with_column_types=True)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 286, in execute
    rv = self.process_ordinary_query(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 479, in process_ordinary_query
    return self.receive_result(with_column_types=with_column_types,
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 136, in receive_result
    return result.get_result()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/result.py", line 50, in get_result
    for packet in self.packet_generator:
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 152, in packet_generator
    packet = self.receive_packet()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/clickhouse_driver/client.py", line 169, in receive_packet
    raise packet.exception
clickhouse_driver.errors.ServerException: Code: 62.
DB::Exception: Syntax error: failed at position 423 (end of query) (line 23, col 21): ;
  ). Expected one of: UNION, LIMIT, SAMPLE, WHERE, WINDOW, INNER, HAVING, AS, UUID, GROUP BY, EXCEPT, identifier, OFFSET, LEFT ARRAY JOIN, PREWHERE, JOIN, alias, ORDER BY, array join, SETTINGS, ARRAY JOIN, INTERSECT, Dot, WITH, table, table function, subquery or list of joined tables, FINAL, token. Stack trace:

0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 70, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 178, in execute
    return status, table
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/adapters/clickhouse/connections.py", line 77, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer (models/staging/customer.sql)
  Code: 62.
  DB::Exception: Syntax error: failed at position 423 (end of query) (line 23, col 21): ;
    ). Expected one of: UNION, LIMIT, SAMPLE, WHERE, WINDOW, INNER, HAVING, AS, UUID, GROUP BY, EXCEPT, identifier, OFFSET, LEFT ARRAY JOIN, PREWHERE, JOIN, alias, ORDER BY, array join, SETTINGS, ARRAY JOIN, INTERSECT, Dot, WITH, table, table function, subquery or list of joined tables, FINAL, token. Stack trace:
  
  0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
  10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
  11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
  compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 15:15:13.483039 (Thread-1): 18:15:13 | 1 of 1 ERROR creating table model db.customer........................ [ERROR in 1.34s]
2022-01-08 15:15:13.483778 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 15:15:13.487371 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:15:13.488699 (MainThread): 18:15:13 | 
2022-01-08 15:15:13.489454 (MainThread): 18:15:13 | Finished running 1 table model in 2.72s.
2022-01-08 15:15:13.490089 (MainThread): Connection 'master' was properly closed.
2022-01-08 15:15:13.490730 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 15:15:13.501823 (MainThread): 
2022-01-08 15:15:13.502094 (MainThread): Completed with 1 error and 0 warnings:
2022-01-08 15:15:13.502313 (MainThread): 
2022-01-08 15:15:13.502622 (MainThread): Database Error in model customer (models/staging/customer.sql)
2022-01-08 15:15:13.502894 (MainThread):   Code: 62.
2022-01-08 15:15:13.503171 (MainThread):   DB::Exception: Syntax error: failed at position 423 (end of query) (line 23, col 21): ;
2022-01-08 15:15:13.503451 (MainThread):     ). Expected one of: UNION, LIMIT, SAMPLE, WHERE, WINDOW, INNER, HAVING, AS, UUID, GROUP BY, EXCEPT, identifier, OFFSET, LEFT ARRAY JOIN, PREWHERE, JOIN, alias, ORDER BY, array join, SETTINGS, ARRAY JOIN, INTERSECT, Dot, WITH, table, table function, subquery or list of joined tables, FINAL, token. Stack trace:
2022-01-08 15:15:13.503725 (MainThread):   
2022-01-08 15:15:13.503974 (MainThread):   0. DB::Exception::Exception(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, int, bool) @ 0x9b682d4 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.504161 (MainThread):   1. DB::parseQueryAndMovePosition(DB::IParser&, char const*&, char const*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, bool, unsigned long, unsigned long) @ 0x1364c49f in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.504341 (MainThread):   2. DB::executeQueryImpl(char const*, char const*, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum, DB::ReadBuffer*) @ 0x1277c2ad in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.504517 (MainThread):   3. DB::executeQuery(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::shared_ptr<DB::Context>, bool, DB::QueryProcessingStage::Enum) @ 0x1277bf13 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.504700 (MainThread):   4. DB::TCPHandler::runImpl() @ 0x1310e1d0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.504875 (MainThread):   5. DB::TCPHandler::run() @ 0x13121c79 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.505047 (MainThread):   6. Poco::Net::TCPServerConnection::start() @ 0x15d682cf in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.505289 (MainThread):   7. Poco::Net::TCPServerDispatcher::run() @ 0x15d6a6c1 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.505505 (MainThread):   8. Poco::PooledThread::run() @ 0x15e7f069 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.505681 (MainThread):   9. Poco::ThreadImpl::runnableEntry(void*) @ 0x15e7c7a0 in /usr/lib/debug/.build-id/18/534c81f0bfcb36205647d2f76da8482502a7fb.debug
2022-01-08 15:15:13.505852 (MainThread):   10. start_thread @ 0x76db in /lib/x86_64-linux-gnu/libpthread-2.27.so
2022-01-08 15:15:13.506018 (MainThread):   11. clone @ 0x12171f in /lib/x86_64-linux-gnu/libc-2.27.so
2022-01-08 15:15:13.506192 (MainThread):   compiled SQL at target/run/clickhouse_starschema/models/staging/customer.sql
2022-01-08 15:15:13.506384 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2022-01-08 15:15:13.506665 (MainThread): Flushing usage events
2022-01-08 15:18:04.105704 (MainThread): Running with dbt=0.21.1
2022-01-08 15:18:04.269843 (MainThread): running dbt with arguments Namespace(args='{}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='init_s3_sources', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='run-operation', write_json=True)
2022-01-08 15:18:04.278803 (MainThread): Tracking: do not track
2022-01-08 15:18:04.328908 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 15:18:04.329167 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 15:18:04.342596 (MainThread): Acquiring new clickhouse connection "macro_init_s3_sources".
2022-01-08 15:18:04.373933 (MainThread): Opening a new connection, currently in state init
2022-01-08 15:18:04.374166 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  ...
2022-01-08 15:18:04.374389 (MainThread): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:18:04.374551 (MainThread): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:18:04.793439 (MainThread): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:18:04.794706 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        DROP TABLE IF EXISTS db.src_customer
  
2022-01-08 15:18:04.795569 (MainThread): Block "" send time: 0.000093
2022-01-08 15:18:04.896083 (MainThread): SQL status: OK in 0.52 seconds
2022-01-08 15:18:04.900090 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
2022-01-08 15:18:05.324735 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_customer 
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  
2022-01-08 15:18:05.325691 (MainThread): Block "" send time: 0.000082
2022-01-08 15:18:05.434730 (MainThread): SQL status: OK in 0.53 seconds
2022-01-08 15:18:05.438407 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  ...
2022-01-08 15:18:05.540321 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_lineorder
  
2022-01-08 15:18:05.541279 (MainThread): Block "" send time: 0.000081
2022-01-08 15:18:05.668033 (MainThread): SQL status: OK in 0.23 seconds
2022-01-08 15:18:05.671660 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
2022-01-08 15:18:05.772642 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  
2022-01-08 15:18:05.773788 (MainThread): Block "" send time: 0.000092
2022-01-08 15:18:05.987967 (MainThread): SQL status: OK in 0.32 seconds
2022-01-08 15:18:05.992048 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  ...
2022-01-08 15:18:06.093927 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_part
  
2022-01-08 15:18:06.094984 (MainThread): Block "" send time: 0.000091
2022-01-08 15:18:06.195959 (MainThread): SQL status: OK in 0.20 seconds
2022-01-08 15:18:06.199747 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
2022-01-08 15:18:06.301015 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_part 
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  
2022-01-08 15:18:06.302070 (MainThread): Block "" send time: 0.000088
2022-01-08 15:18:06.406277 (MainThread): SQL status: OK in 0.21 seconds
2022-01-08 15:18:06.410333 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  ...
2022-01-08 15:18:06.511509 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        DROP TABLE IF EXISTS db.src_supplier
  
2022-01-08 15:18:06.512594 (MainThread): Block "" send time: 0.000086
2022-01-08 15:18:06.616120 (MainThread): SQL status: OK in 0.21 seconds
2022-01-08 15:18:06.620154 (MainThread): On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
2022-01-08 15:18:06.721236 (MainThread): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    
        CREATE TABLE db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  
2022-01-08 15:18:06.722318 (MainThread): Block "" send time: 0.000092
2022-01-08 15:18:06.896923 (MainThread): SQL status: OK in 0.28 seconds
2022-01-08 15:18:06.900465 (MainThread): On macro_init_s3_sources: No close available on handle
2022-01-08 15:18:06.901846 (MainThread): Flushing usage events
2022-01-08 15:18:06.902070 (MainThread): Connection 'macro_init_s3_sources' was properly closed.
2022-01-08 15:18:06.902319 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 58972), raddr=('51.250.28.188', 9440)>
2022-01-08 15:19:34.868089 (MainThread): Running with dbt=0.21.1
2022-01-08 15:19:35.031515 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['customer'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 15:19:35.040493 (MainThread): Tracking: do not track
2022-01-08 15:19:35.090736 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-01-08 15:19:35.091056 (MainThread): Partial parsing: updated file: clickhouse_starschema://models/staging/customer.sql
2022-01-08 15:19:35.102079 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:19:35.168817 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:35.170603 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:35.182242 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:35.182525 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:35.187639 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:35.187918 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:35.205171 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 15:19:35.205684 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 15:19:35.206806 (MainThread): 
2022-01-08 15:19:35.207101 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:19:35.207700 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 15:19:35.216992 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 15:19:35.217258 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 15:19:35.217512 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:19:35.217680 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:19:35.618980 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:19:35.620306 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 15:19:35.621241 (ThreadPoolExecutor-0_0): Block "" send time: 0.000121
2022-01-08 15:19:35.718279 (ThreadPoolExecutor-0_0): SQL status: OK in 0.50 seconds
2022-01-08 15:19:35.722061 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 15:19:35.724157 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 15:19:35.724429 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 58998), raddr=('51.250.28.188', 9440)>
2022-01-08 15:19:35.730860 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 15:19:35.731102 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 15:19:35.731331 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:19:35.731529 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:19:36.405538 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:19:36.406559 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 15:19:36.407460 (ThreadPoolExecutor-1_0): Block "" send time: 0.000087
2022-01-08 15:19:36.611739 (ThreadPoolExecutor-1_0): SQL status: OK in 0.88 seconds
2022-01-08 15:19:36.615718 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 15:19:36.617044 (MainThread): 18:19:36 | Concurrency: 4 threads (target='dev')
2022-01-08 15:19:36.617321 (MainThread): 18:19:36 | 
2022-01-08 15:19:36.619988 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 15:19:36.620436 (Thread-1): 18:19:36 | 1 of 1 START table model db.customer................................. [RUN]
2022-01-08 15:19:36.620885 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:19:36.621173 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 59000), raddr=('51.250.28.188', 9440)>
2022-01-08 15:19:36.621453 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 15:19:36.634915 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 15:19:36.635214 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:19:36.635482 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:19:36.635686 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:19:37.037660 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:19:37.038671 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:19:37.039552 (Thread-1): Block "" send time: 0.000087
2022-01-08 15:19:37.140938 (Thread-1): SQL status: OK in 0.51 seconds
2022-01-08 15:19:37.144929 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:37.145440 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:37.145646 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:37.145846 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:37.146048 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:37.146249 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:37.146446 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:37.146641 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:19:37.147058 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:19:37.147453 (Thread-1): finished collecting timing info
2022-01-08 15:19:37.181796 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:19:37.182104 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  )...
2022-01-08 15:19:37.281448 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  )
2022-01-08 15:19:37.281760 (Thread-1): Block "" send time: 0.000026
2022-01-08 15:19:39.198332 (Thread-1): SQL status: OK in 2.02 seconds
2022-01-08 15:19:39.208815 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer 
  
  ...
2022-01-08 15:19:39.310126 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer 
  
  
2022-01-08 15:19:39.311231 (Thread-1): Block "" send time: 0.000100
2022-01-08 15:19:39.409935 (Thread-1): SQL status: OK in 0.20 seconds
2022-01-08 15:19:39.413578 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer__dbt_tmp to db.customer 
  
  ...
2022-01-08 15:19:39.513549 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer__dbt_tmp to db.customer 
  
  
2022-01-08 15:19:39.514630 (Thread-1): Block "" send time: 0.000090
2022-01-08 15:19:39.613716 (Thread-1): SQL status: OK in 0.20 seconds
2022-01-08 15:19:39.656783 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */
drop table if exists db.customer__dbt_backup 
  ...
2022-01-08 15:19:39.755958 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */
drop table if exists db.customer__dbt_backup 
  
2022-01-08 15:19:39.757050 (Thread-1): Block "" send time: 0.000091
2022-01-08 15:19:39.857283 (Thread-1): SQL status: OK in 0.20 seconds
2022-01-08 15:19:39.861011 (Thread-1): finished collecting timing info
2022-01-08 15:19:39.861772 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 15:19:39.863332 (Thread-1): 18:19:39 | 1 of 1 OK created table model db.customer............................ [OK in 3.24s]
2022-01-08 15:19:39.864104 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 15:19:39.867961 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:19:39.869827 (MainThread): 18:19:39 | 
2022-01-08 15:19:39.870956 (MainThread): 18:19:39 | Finished running 1 table model in 4.66s.
2022-01-08 15:19:39.872030 (MainThread): Connection 'master' was properly closed.
2022-01-08 15:19:39.872356 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 15:19:39.872747 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 59002), raddr=('51.250.28.188', 9440)>
2022-01-08 15:19:39.886442 (MainThread): 
2022-01-08 15:19:39.886777 (MainThread): Completed successfully
2022-01-08 15:19:39.887063 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-01-08 15:19:39.887400 (MainThread): Flushing usage events
2022-01-08 15:20:14.198305 (MainThread): Running with dbt=0.21.1
2022-01-08 15:20:14.363630 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['part'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 15:20:14.372580 (MainThread): Tracking: do not track
2022-01-08 15:20:14.423412 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 15:20:14.423687 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 15:20:14.462425 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 15:20:14.463001 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 15:20:14.464294 (MainThread): 
2022-01-08 15:20:14.464657 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:20:14.465458 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 15:20:14.474297 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 15:20:14.474571 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 15:20:14.474836 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:20:14.475020 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:20:15.127366 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:20:15.128707 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 15:20:15.129603 (ThreadPoolExecutor-0_0): Block "" send time: 0.000103
2022-01-08 15:20:15.235177 (ThreadPoolExecutor-0_0): SQL status: OK in 0.76 seconds
2022-01-08 15:20:15.238904 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 15:20:15.240870 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 15:20:15.241139 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 59006), raddr=('51.250.28.188', 9440)>
2022-01-08 15:20:15.247236 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 15:20:15.247464 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 15:20:15.247703 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:20:15.247913 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:20:16.269809 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:20:16.270762 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 15:20:16.271606 (ThreadPoolExecutor-1_0): Block "" send time: 0.000082
2022-01-08 15:20:16.476735 (ThreadPoolExecutor-1_0): SQL status: OK in 1.23 seconds
2022-01-08 15:20:16.481142 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 15:20:16.482641 (MainThread): 18:20:16 | Concurrency: 4 threads (target='dev')
2022-01-08 15:20:16.482891 (MainThread): 18:20:16 | 
2022-01-08 15:20:16.485387 (Thread-1): Began running node model.clickhouse_starschema.part
2022-01-08 15:20:16.485837 (Thread-1): 18:20:16 | 1 of 1 START table model db.part..................................... [RUN]
2022-01-08 15:20:16.486284 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.part".
2022-01-08 15:20:16.486576 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 59008), raddr=('51.250.28.188', 9440)>
2022-01-08 15:20:16.486851 (Thread-1): Compiling model.clickhouse_starschema.part
2022-01-08 15:20:16.520488 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 15:20:16.520850 (Thread-1): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:20:16.521195 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:20:16.521444 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:20:16.948676 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:20:16.949721 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:20:16.950714 (Thread-1): Block "" send time: 0.000090
2022-01-08 15:20:17.069312 (Thread-1): SQL status: OK in 0.55 seconds
2022-01-08 15:20:17.076441 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:20:17.077121 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:20:17.077741 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:20:17.078334 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:20:17.078916 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:20:17.079500 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:20:17.080121 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:20:17.080664 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:20:17.081193 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:20:17.082265 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.part"
2022-01-08 15:20:17.083207 (Thread-1): finished collecting timing info
2022-01-08 15:20:17.134812 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.part"
2022-01-08 15:20:17.135123 (Thread-1): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */


  
    create table db.part__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (P_PARTKEY)
    
  as (
    

SELECT "P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"  
FROM db.src_part
  )...
2022-01-08 15:20:17.235830 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */


  
    create table db.part__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (P_PARTKEY)
    
  as (
    

SELECT "P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"  
FROM db.src_part
  )
2022-01-08 15:20:17.236227 (Thread-1): Block "" send time: 0.000035
2022-01-08 15:20:21.213663 (Thread-1): SQL status: OK in 4.08 seconds
2022-01-08 15:20:21.233253 (Thread-1): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part 
  
  ...
2022-01-08 15:20:21.334277 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part 
  
  
2022-01-08 15:20:21.335375 (Thread-1): Block "" send time: 0.000092
2022-01-08 15:20:21.436192 (Thread-1): SQL status: OK in 0.20 seconds
2022-01-08 15:20:21.439651 (Thread-1): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part__dbt_tmp to db.part 
  
  ...
2022-01-08 15:20:21.539883 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part__dbt_tmp to db.part 
  
  
2022-01-08 15:20:21.540201 (Thread-1): Block "" send time: 0.000028
2022-01-08 15:20:21.640837 (Thread-1): SQL status: OK in 0.20 seconds
2022-01-08 15:20:21.681625 (Thread-1): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */
drop table if exists db.part__dbt_backup 
  ...
2022-01-08 15:20:21.782583 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */
drop table if exists db.part__dbt_backup 
  
2022-01-08 15:20:21.783660 (Thread-1): Block "" send time: 0.000090
2022-01-08 15:20:21.884219 (Thread-1): SQL status: OK in 0.20 seconds
2022-01-08 15:20:21.888026 (Thread-1): finished collecting timing info
2022-01-08 15:20:21.888799 (Thread-1): On model.clickhouse_starschema.part: No close available on handle
2022-01-08 15:20:21.890364 (Thread-1): 18:20:21 | 1 of 1 OK created table model db.part................................ [OK in 5.40s]
2022-01-08 15:20:21.891094 (Thread-1): Finished running node model.clickhouse_starschema.part
2022-01-08 15:20:21.894644 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:20:21.895989 (MainThread): 18:20:21 | 
2022-01-08 15:20:21.896760 (MainThread): 18:20:21 | Finished running 1 table model in 7.43s.
2022-01-08 15:20:21.897486 (MainThread): Connection 'master' was properly closed.
2022-01-08 15:20:21.898116 (MainThread): Connection 'model.clickhouse_starschema.part' was properly closed.
2022-01-08 15:20:21.898919 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 59010), raddr=('51.250.28.188', 9440)>
2022-01-08 15:20:21.924394 (MainThread): 
2022-01-08 15:20:21.924661 (MainThread): Completed successfully
2022-01-08 15:20:21.924871 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-01-08 15:20:21.925132 (MainThread): Flushing usage events
2022-01-08 15:40:19.143370 (MainThread): Running with dbt=0.21.1
2022-01-08 15:40:19.310026 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tags:staging'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 15:40:19.319047 (MainThread): Tracking: do not track
2022-01-08 15:40:19.371402 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 15:40:19.371696 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 15:40:19.413012 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 15:40:19.413630 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 15:40:19.414021 (MainThread): Flushing usage events
2022-01-08 15:40:19.414263 (MainThread): Encountered an error:
2022-01-08 15:40:19.414432 (MainThread): Runtime Error
  'tags' is not a valid method name
2022-01-08 15:40:19.416197 (MainThread): Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/graph/selector_spec.py", line 96, in parse_method
    method_name = MethodName(method_parts[0])
  File "/usr/lib/python3.8/enum.py", line 339, in __call__
    return cls.__new__(cls, value)
  File "/usr/lib/python3.8/enum.py", line 663, in __new__
    raise ve_exc
ValueError: 'tags' is not a valid MethodName

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/runnable.py", line 160, in _runtime_initialize
    self.job_queue = self.get_graph_queue()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/runnable.py", line 150, in get_graph_queue
    spec = self.get_selection_spec()
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/task/runnable.py", line 139, in get_selection_spec
    spec = parse_difference(self.selection_arg, self.exclusion_arg)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/graph/cli.py", line 70, in parse_difference
    included = parse_union_from_default(include, DEFAULT_INCLUDES, greedy=bool(flags.GREEDY))
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/graph/cli.py", line 64, in parse_union_from_default
    return parse_union(components=raw, expect_exists=True, greedy=greedy)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/graph/cli.py", line 40, in parse_union
    intersection_components: List[SelectionSpec] = [
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/graph/cli.py", line 41, in <listcomp>
    SelectionCriteria.from_single_spec(part, greedy=greedy)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/graph/selector_spec.py", line 160, in from_single_spec
    return cls.selection_criteria_from_dict(raw, result.groupdict(), greedy=greedy)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/graph/selector_spec.py", line 114, in selection_criteria_from_dict
    method_name, method_arguments = cls.parse_method(dct)
  File "/home/iagaraev/Packages/dbtproject/lib/python3.8/site-packages/dbt/graph/selector_spec.py", line 98, in parse_method
    raise InvalidSelectorException(
dbt.exceptions.InvalidSelectorException: Runtime Error
  'tags' is not a valid method name

2022-01-08 15:41:57.913931 (MainThread): Running with dbt=0.21.1
2022-01-08 15:41:58.084028 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=['tag:staging'], selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 15:41:58.093013 (MainThread): Tracking: do not track
2022-01-08 15:41:58.145095 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 15:41:58.145376 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 15:41:58.185599 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 15:41:58.186197 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 15:41:58.187600 (MainThread): 
2022-01-08 15:41:58.187977 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:41:58.188955 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 15:41:58.197548 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 15:41:58.197807 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 15:41:58.198058 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:41:58.198235 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:41:58.949090 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:41:58.950392 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 15:41:58.951373 (ThreadPoolExecutor-0_0): Block "" send time: 0.000101
2022-01-08 15:41:59.052982 (ThreadPoolExecutor-0_0): SQL status: OK in 0.85 seconds
2022-01-08 15:41:59.056713 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 15:41:59.060661 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 15:41:59.061659 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60150), raddr=('51.250.28.188', 9440)>
2022-01-08 15:41:59.078752 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 15:41:59.079449 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 15:41:59.080169 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:41:59.080790 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:42:00.719517 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:42:00.720769 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 15:42:00.721704 (ThreadPoolExecutor-1_0): Block "" send time: 0.000090
2022-01-08 15:42:00.826729 (ThreadPoolExecutor-1_0): SQL status: OK in 1.75 seconds
2022-01-08 15:42:00.831619 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 15:42:00.835012 (MainThread): 18:42:00 | Concurrency: 4 threads (target='dev')
2022-01-08 15:42:00.836125 (MainThread): 18:42:00 | 
2022-01-08 15:42:00.843105 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 15:42:00.843976 (Thread-2): Began running node model.clickhouse_starschema.lineorder
2022-01-08 15:42:00.845136 (Thread-1): 18:42:00 | 1 of 4 START table model db.customer................................. [RUN]
2022-01-08 15:42:00.845857 (Thread-3): Began running node model.clickhouse_starschema.part
2022-01-08 15:42:00.847043 (Thread-4): Began running node model.clickhouse_starschema.supplier
2022-01-08 15:42:00.848254 (Thread-2): 18:42:00 | 2 of 4 START table model db.lineorder................................ [RUN]
2022-01-08 15:42:00.849551 (Thread-3): 18:42:00 | 3 of 4 START table model db.part..................................... [RUN]
2022-01-08 15:42:00.850837 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:42:00.852166 (Thread-4): 18:42:00 | 4 of 4 START table model db.supplier................................. [RUN]
2022-01-08 15:42:00.853791 (Thread-2): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder".
2022-01-08 15:42:00.854796 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60152), raddr=('51.250.28.188', 9440)>
2022-01-08 15:42:00.856348 (Thread-3): Acquiring new clickhouse connection "model.clickhouse_starschema.part".
2022-01-08 15:42:00.858064 (Thread-4): Acquiring new clickhouse connection "model.clickhouse_starschema.supplier".
2022-01-08 15:42:00.858832 (Thread-2): Compiling model.clickhouse_starschema.lineorder
2022-01-08 15:42:00.859688 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 15:42:00.860457 (Thread-3): Compiling model.clickhouse_starschema.part
2022-01-08 15:42:00.861291 (Thread-4): Compiling model.clickhouse_starschema.supplier
2022-01-08 15:42:00.921793 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 15:42:00.922369 (Thread-2): Opening a new connection, currently in state init
2022-01-08 15:42:00.926660 (Thread-3): Opening a new connection, currently in state init
2022-01-08 15:42:00.930696 (Thread-4): Opening a new connection, currently in state init
2022-01-08 15:42:00.930929 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:42:00.931213 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:42:00.931411 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:42:00.931605 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:42:00.931848 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:42:00.932339 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:42:00.932614 (Thread-3): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:42:00.932922 (Thread-3): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:42:00.933094 (Thread-2): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:42:00.933405 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:42:00.933742 (Thread-2): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:42:00.933903 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:42:01.336277 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:42:01.337368 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:42:01.339001 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:42:01.339789 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:42:01.340999 (Thread-1): Block "" send time: 0.000244
2022-01-08 15:42:01.342169 (Thread-2): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:42:01.343702 (Thread-4): Block "" send time: 0.001243
2022-01-08 15:42:01.344534 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:42:01.345552 (Thread-2): Block "" send time: 0.000092
2022-01-08 15:42:01.362633 (Thread-3): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:42:01.363682 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:42:01.364591 (Thread-3): Block "" send time: 0.000080
2022-01-08 15:42:01.483364 (Thread-1): SQL status: OK in 0.55 seconds
2022-01-08 15:42:01.488021 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.489634 (Thread-4): SQL status: OK in 0.56 seconds
2022-01-08 15:42:01.490413 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.495908 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.496980 (Thread-3): SQL status: OK in 0.56 seconds
2022-01-08 15:42:01.497762 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.498435 (Thread-2): SQL status: OK in 0.57 seconds
2022-01-08 15:42:01.499292 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.503522 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.504287 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.508371 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.509159 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.510131 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.510902 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.511663 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.512500 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.513262 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.514016 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.514748 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.515550 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.516376 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.517219 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.517998 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.518771 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.519544 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.520348 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.521104 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.521860 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.522626 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.524005 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:42:01.524781 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.525985 (Thread-4): Writing injected SQL for node "model.clickhouse_starschema.supplier"
2022-01-08 15:42:01.526771 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.527782 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.529285 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.529886 (Thread-1): finished collecting timing info
2022-01-08 15:42:01.530578 (Thread-4): finished collecting timing info
2022-01-08 15:42:01.531406 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.532185 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.589938 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.600391 (Thread-3): Writing injected SQL for node "model.clickhouse_starschema.part"
2022-01-08 15:42:01.600633 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.604578 (Thread-4): Writing runtime SQL for node "model.clickhouse_starschema.supplier"
2022-01-08 15:42:01.605039 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.605736 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:42:01.606065 (Thread-3): finished collecting timing info
2022-01-08 15:42:01.606309 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.608727 (Thread-3): Writing runtime SQL for node "model.clickhouse_starschema.part"
2022-01-08 15:42:01.608943 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */


  
    create table db.supplier__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (S_SUPPKEY)
    
  as (
    

SELECT "S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE" 
FROM db.src_supplier
  )...
2022-01-08 15:42:01.609138 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.609492 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */


  
    create table db.part__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (P_PARTKEY)
    
  as (
    

SELECT "P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"  
FROM db.src_part
  )...
2022-01-08 15:42:01.609681 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  )...
2022-01-08 15:42:01.609869 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.610184 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.610350 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.610496 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:42:01.610779 (Thread-2): Writing injected SQL for node "model.clickhouse_starschema.lineorder"
2022-01-08 15:42:01.611003 (Thread-2): finished collecting timing info
2022-01-08 15:42:01.613274 (Thread-2): Writing runtime SQL for node "model.clickhouse_starschema.lineorder"
2022-01-08 15:42:01.613529 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */


  
    create table db.lineorder__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT "LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
FROM db.src_lineorder
  )...
2022-01-08 15:42:01.714326 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */


  
    create table db.lineorder__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT "LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
FROM db.src_lineorder
  )
2022-01-08 15:42:01.714938 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */


  
    create table db.supplier__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (S_SUPPKEY)
    
  as (
    

SELECT "S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE" 
FROM db.src_supplier
  )
2022-01-08 15:42:01.715418 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  )
2022-01-08 15:42:01.715790 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */


  
    create table db.part__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (P_PARTKEY)
    
  as (
    

SELECT "P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"  
FROM db.src_part
  )
2022-01-08 15:42:01.716102 (Thread-4): Block "" send time: 0.000128
2022-01-08 15:42:01.716411 (Thread-1): Block "" send time: 0.000065
2022-01-08 15:42:01.716663 (Thread-2): Block "" send time: 0.000988
2022-01-08 15:42:01.716871 (Thread-3): Block "" send time: 0.000239
2022-01-08 15:42:02.654787 (Thread-4): SQL status: OK in 1.05 seconds
2022-01-08 15:42:02.679147 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    drop table if exists db.supplier 
  
  ...
2022-01-08 15:42:02.784251 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    drop table if exists db.supplier 
  
  
2022-01-08 15:42:02.785677 (Thread-4): Block "" send time: 0.000091
2022-01-08 15:42:02.887905 (Thread-4): SQL status: OK in 0.21 seconds
2022-01-08 15:42:02.891070 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    rename table db.supplier__dbt_tmp to db.supplier 
  
  ...
2022-01-08 15:42:03.009021 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    rename table db.supplier__dbt_tmp to db.supplier 
  
  
2022-01-08 15:42:03.009785 (Thread-4): Block "" send time: 0.000066
2022-01-08 15:42:03.124951 (Thread-4): SQL status: OK in 0.23 seconds
2022-01-08 15:42:03.164256 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */
drop table if exists db.supplier__dbt_backup 
  ...
2022-01-08 15:42:03.268144 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */
drop table if exists db.supplier__dbt_backup 
  
2022-01-08 15:42:03.269140 (Thread-4): Block "" send time: 0.000087
2022-01-08 15:42:03.369652 (Thread-4): SQL status: OK in 0.21 seconds
2022-01-08 15:42:03.371544 (Thread-4): finished collecting timing info
2022-01-08 15:42:03.371926 (Thread-4): On model.clickhouse_starschema.supplier: No close available on handle
2022-01-08 15:42:03.372655 (Thread-4): 18:42:03 | 4 of 4 OK created table model db.supplier............................ [OK in 2.51s]
2022-01-08 15:42:03.372968 (Thread-4): Finished running node model.clickhouse_starschema.supplier
2022-01-08 15:42:06.889097 (Thread-1): SQL status: OK in 5.28 seconds
2022-01-08 15:42:06.897762 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer__dbt_backup 
  
  ...
2022-01-08 15:42:07.025853 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer__dbt_backup 
  
  
2022-01-08 15:42:07.026957 (Thread-1): Block "" send time: 0.000098
2022-01-08 15:42:07.129468 (Thread-1): SQL status: OK in 0.23 seconds
2022-01-08 15:42:07.132967 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer to db.customer__dbt_backup 
  
  ...
2022-01-08 15:42:07.254684 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer to db.customer__dbt_backup 
  
  
2022-01-08 15:42:07.255784 (Thread-1): Block "" send time: 0.000095
2022-01-08 15:42:07.370034 (Thread-1): SQL status: OK in 0.24 seconds
2022-01-08 15:42:07.381974 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer 
  
  ...
2022-01-08 15:42:07.509106 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer 
  
  
2022-01-08 15:42:07.509571 (Thread-1): Block "" send time: 0.000042
2022-01-08 15:42:07.625036 (Thread-1): SQL status: OK in 0.24 seconds
2022-01-08 15:42:07.628236 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer__dbt_tmp to db.customer 
  
  ...
2022-01-08 15:42:07.745343 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer__dbt_tmp to db.customer 
  
  
2022-01-08 15:42:07.746442 (Thread-1): Block "" send time: 0.000095
2022-01-08 15:42:07.877672 (Thread-1): SQL status: OK in 0.25 seconds
2022-01-08 15:42:07.888276 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */
drop table if exists db.customer__dbt_backup 
  ...
2022-01-08 15:42:08.001821 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */
drop table if exists db.customer__dbt_backup 
  
2022-01-08 15:42:08.002156 (Thread-1): Block "" send time: 0.000029
2022-01-08 15:42:08.106444 (Thread-1): SQL status: OK in 0.22 seconds
2022-01-08 15:42:08.109821 (Thread-1): finished collecting timing info
2022-01-08 15:42:08.110454 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 15:42:08.112160 (Thread-1): 18:42:08 | 1 of 4 OK created table model db.customer............................ [OK in 7.26s]
2022-01-08 15:42:08.113007 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 15:42:08.926781 (Thread-3): SQL status: OK in 7.32 seconds
2022-01-08 15:42:08.935524 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part__dbt_backup 
  
  ...
2022-01-08 15:42:09.042251 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part__dbt_backup 
  
  
2022-01-08 15:42:09.043350 (Thread-3): Block "" send time: 0.000098
2022-01-08 15:42:09.159109 (Thread-3): SQL status: OK in 0.22 seconds
2022-01-08 15:42:09.162627 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part to db.part__dbt_backup 
  
  ...
2022-01-08 15:42:09.267559 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part to db.part__dbt_backup 
  
  
2022-01-08 15:42:09.269213 (Thread-3): Block "" send time: 0.000093
2022-01-08 15:42:09.374878 (Thread-3): SQL status: OK in 0.21 seconds
2022-01-08 15:42:09.383759 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part 
  
  ...
2022-01-08 15:42:09.490883 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part 
  
  
2022-01-08 15:42:09.491998 (Thread-3): Block "" send time: 0.000118
2022-01-08 15:42:09.599656 (Thread-3): SQL status: OK in 0.22 seconds
2022-01-08 15:42:09.602165 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part__dbt_tmp to db.part 
  
  ...
2022-01-08 15:42:09.733892 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part__dbt_tmp to db.part 
  
  
2022-01-08 15:42:09.735005 (Thread-3): Block "" send time: 0.000096
2022-01-08 15:42:09.840602 (Thread-3): SQL status: OK in 0.24 seconds
2022-01-08 15:42:09.847467 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */
drop table if exists db.part__dbt_backup 
  ...
2022-01-08 15:42:09.952846 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */
drop table if exists db.part__dbt_backup 
  
2022-01-08 15:42:09.953948 (Thread-3): Block "" send time: 0.000097
2022-01-08 15:42:10.079282 (Thread-3): SQL status: OK in 0.23 seconds
2022-01-08 15:42:10.083174 (Thread-3): finished collecting timing info
2022-01-08 15:42:10.084111 (Thread-3): On model.clickhouse_starschema.part: No close available on handle
2022-01-08 15:42:10.085741 (Thread-3): 18:42:10 | 3 of 4 OK created table model db.part................................ [OK in 9.23s]
2022-01-08 15:42:10.086870 (Thread-3): Finished running node model.clickhouse_starschema.part
2022-01-08 15:49:38.410254 (Thread-2): SQL status: OK in 456.80 seconds
2022-01-08 15:49:38.422485 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    drop table if exists db.lineorder 
  
  ...
2022-01-08 15:49:38.524813 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    drop table if exists db.lineorder 
  
  
2022-01-08 15:49:38.525909 (Thread-2): Block "" send time: 0.000088
2022-01-08 15:49:38.735745 (Thread-2): SQL status: OK in 0.31 seconds
2022-01-08 15:49:38.739323 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    rename table db.lineorder__dbt_tmp to db.lineorder 
  
  ...
2022-01-08 15:49:38.838563 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    rename table db.lineorder__dbt_tmp to db.lineorder 
  
  
2022-01-08 15:49:38.839612 (Thread-2): Block "" send time: 0.000092
2022-01-08 15:49:38.951594 (Thread-2): SQL status: OK in 0.21 seconds
2022-01-08 15:49:38.954332 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */
drop table if exists db.lineorder__dbt_backup 
  ...
2022-01-08 15:49:39.071906 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */
drop table if exists db.lineorder__dbt_backup 
  
2022-01-08 15:49:39.073014 (Thread-2): Block "" send time: 0.000099
2022-01-08 15:49:39.532093 (Thread-2): SQL status: OK in 0.58 seconds
2022-01-08 15:49:39.536077 (Thread-2): finished collecting timing info
2022-01-08 15:49:39.536863 (Thread-2): On model.clickhouse_starschema.lineorder: No close available on handle
2022-01-08 15:49:39.538455 (Thread-2): 18:49:39 | 2 of 4 OK created table model db.lineorder........................... [OK in 458.68s]
2022-01-08 15:49:39.539223 (Thread-2): Finished running node model.clickhouse_starschema.lineorder
2022-01-08 15:49:39.543143 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:49:39.544561 (MainThread): 18:49:39 | 
2022-01-08 15:49:39.545340 (MainThread): 18:49:39 | Finished running 4 table models in 461.36s.
2022-01-08 15:49:39.546379 (MainThread): Connection 'master' was properly closed.
2022-01-08 15:49:39.546976 (MainThread): Connection 'model.clickhouse_starschema.customer' was properly closed.
2022-01-08 15:49:39.547665 (MainThread): Connection 'model.clickhouse_starschema.lineorder' was properly closed.
2022-01-08 15:49:39.548229 (MainThread): Connection 'model.clickhouse_starschema.part' was properly closed.
2022-01-08 15:49:39.548499 (MainThread): Connection 'model.clickhouse_starschema.supplier' was properly closed.
2022-01-08 15:49:39.548875 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60154), raddr=('51.250.28.188', 9440)>
2022-01-08 15:49:39.549278 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60160), raddr=('51.250.28.188', 9440)>
2022-01-08 15:49:39.549614 (MainThread): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60156), raddr=('51.250.28.188', 9440)>
2022-01-08 15:49:39.552002 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60158), raddr=('51.250.28.188', 9440)>
2022-01-08 15:49:39.563648 (MainThread): 
2022-01-08 15:49:39.563908 (MainThread): Completed successfully
2022-01-08 15:49:39.564104 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-01-08 15:49:39.564347 (MainThread): Flushing usage events
2022-01-08 15:56:03.581174 (MainThread): Running with dbt=0.21.1
2022-01-08 15:56:03.747326 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-01-08 15:56:03.756338 (MainThread): Tracking: do not track
2022-01-08 15:56:03.807828 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 15:56:03.808103 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 15:56:03.846830 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 15:56:03.847482 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 15:56:03.848987 (MainThread): 
2022-01-08 15:56:03.849348 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 15:56:03.850515 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_schemas".
2022-01-08 15:56:03.858944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 15:56:03.859213 (ThreadPoolExecutor-0_0): On list_schemas: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
2022-01-08 15:56:03.859462 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:56:03.859636 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:56:04.340541 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:56:04.341863 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  
2022-01-08 15:56:04.342757 (ThreadPoolExecutor-0_0): Block "" send time: 0.000106
2022-01-08 15:56:04.443559 (ThreadPoolExecutor-0_0): SQL status: OK in 0.58 seconds
2022-01-08 15:56:04.447323 (ThreadPoolExecutor-0_0): On list_schemas: No close available on handle
2022-01-08 15:56:04.451437 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 15:56:04.452410 (ThreadPoolExecutor-1_0): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60644), raddr=('51.250.28.188', 9440)>
2022-01-08 15:56:04.461161 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-01-08 15:56:04.461404 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 15:56:04.461634 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:56:04.461827 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:56:05.101529 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:56:05.102473 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 15:56:05.103292 (ThreadPoolExecutor-1_0): Block "" send time: 0.000081
2022-01-08 15:56:05.212082 (ThreadPoolExecutor-1_0): SQL status: OK in 0.75 seconds
2022-01-08 15:56:05.216507 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 15:56:05.219278 (MainThread): 18:56:05 | Concurrency: 4 threads (target='dev')
2022-01-08 15:56:05.219995 (MainThread): 18:56:05 | 
2022-01-08 15:56:05.226529 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 15:56:05.227338 (Thread-2): Began running node model.clickhouse_starschema.lineorder
2022-01-08 15:56:05.228370 (Thread-1): 18:56:05 | 1 of 8 START table model db.customer................................. [RUN]
2022-01-08 15:56:05.229031 (Thread-3): Began running node model.clickhouse_starschema.part
2022-01-08 15:56:05.230343 (Thread-4): Began running node model.clickhouse_starschema.supplier
2022-01-08 15:56:05.231348 (Thread-2): 18:56:05 | 2 of 8 START table model db.lineorder................................ [RUN]
2022-01-08 15:56:05.232994 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 15:56:05.234795 (Thread-3): 18:56:05 | 3 of 8 START table model db.part..................................... [RUN]
2022-01-08 15:56:05.236218 (Thread-4): 18:56:05 | 4 of 8 START table model db.supplier................................. [RUN]
2022-01-08 15:56:05.237850 (Thread-2): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder".
2022-01-08 15:56:05.238906 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60646), raddr=('51.250.28.188', 9440)>
2022-01-08 15:56:05.240873 (Thread-3): Acquiring new clickhouse connection "model.clickhouse_starschema.part".
2022-01-08 15:56:05.242418 (Thread-4): Acquiring new clickhouse connection "model.clickhouse_starschema.supplier".
2022-01-08 15:56:05.243489 (Thread-2): Compiling model.clickhouse_starschema.lineorder
2022-01-08 15:56:05.244538 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 15:56:05.245281 (Thread-3): Compiling model.clickhouse_starschema.part
2022-01-08 15:56:05.246244 (Thread-4): Compiling model.clickhouse_starschema.supplier
2022-01-08 15:56:05.316887 (Thread-2): Opening a new connection, currently in state init
2022-01-08 15:56:05.318039 (Thread-3): Opening a new connection, currently in state init
2022-01-08 15:56:05.319148 (Thread-4): Opening a new connection, currently in state init
2022-01-08 15:56:05.320396 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 15:56:05.320626 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:56:05.320867 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:56:05.321092 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:56:05.321322 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 15:56:05.321580 (Thread-2): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:56:05.322056 (Thread-2): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:56:05.322272 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:56:05.322448 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:56:05.322674 (Thread-3): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:56:05.322871 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 15:56:05.323292 (Thread-3): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:56:05.323591 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 15:56:05.737054 (Thread-2): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:56:05.738227 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:56:05.739187 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:56:05.740311 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:56:05.741243 (Thread-2): Block "" send time: 0.001302
2022-01-08 15:56:05.742477 (Thread-3): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:56:05.743574 (Thread-4): Block "" send time: 0.001229
2022-01-08 15:56:05.744300 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:56:05.745203 (Thread-3): Block "" send time: 0.000080
2022-01-08 15:56:05.755029 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 15:56:05.756053 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 15:56:05.756894 (Thread-1): Block "" send time: 0.000084
2022-01-08 15:56:05.844667 (Thread-2): SQL status: OK in 0.52 seconds
2022-01-08 15:56:05.849526 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.850669 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.852467 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.853168 (Thread-3): SQL status: OK in 0.53 seconds
2022-01-08 15:56:05.853829 (Thread-4): SQL status: OK in 0.53 seconds
2022-01-08 15:56:05.854448 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.858284 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.861932 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.862679 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.863628 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.864400 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.865509 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.866283 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.867265 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.868213 (Thread-1): SQL status: OK in 0.55 seconds
2022-01-08 15:56:05.869036 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.869816 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.870556 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.874218 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.874971 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.875769 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.876524 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.877294 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.878058 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.879015 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.879748 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.880538 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.881223 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.881939 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.882683 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.883497 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.884326 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.885713 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.886974 (Thread-4): Writing injected SQL for node "model.clickhouse_starschema.supplier"
2022-01-08 15:56:05.887753 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.888559 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.889251 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.890380 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.891152 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.891851 (Thread-4): finished collecting timing info
2022-01-08 15:56:05.893117 (Thread-3): Writing injected SQL for node "model.clickhouse_starschema.part"
2022-01-08 15:56:05.893865 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.894616 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.917056 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.933245 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.938763 (Thread-3): finished collecting timing info
2022-01-08 15:56:05.944489 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:56:05.956954 (Thread-4): Writing runtime SQL for node "model.clickhouse_starschema.supplier"
2022-01-08 15:56:05.957191 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.959549 (Thread-3): Writing runtime SQL for node "model.clickhouse_starschema.part"
2022-01-08 15:56:05.959905 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 15:56:05.960402 (Thread-2): Writing injected SQL for node "model.clickhouse_starschema.lineorder"
2022-01-08 15:56:05.960584 (Thread-1): finished collecting timing info
2022-01-08 15:56:05.960888 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */


  
    create table db.supplier__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (S_SUPPKEY)
    
  as (
    

SELECT "S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE" 
FROM db.src_supplier
  )...
2022-01-08 15:56:05.964747 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.customer"
2022-01-08 15:56:05.965318 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */


  
    create table db.part__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (P_PARTKEY)
    
  as (
    

SELECT "P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"  
FROM db.src_part
  )...
2022-01-08 15:56:05.965577 (Thread-2): finished collecting timing info
2022-01-08 15:56:05.967892 (Thread-2): Writing runtime SQL for node "model.clickhouse_starschema.lineorder"
2022-01-08 15:56:05.968091 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  )...
2022-01-08 15:56:05.968482 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */


  
    create table db.lineorder__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT "LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
FROM db.src_lineorder
  )...
2022-01-08 15:56:06.067204 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */


  
    create table db.supplier__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (S_SUPPKEY)
    
  as (
    

SELECT "S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE" 
FROM db.src_supplier
  )
2022-01-08 15:56:06.067832 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */


  
    create table db.part__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (P_PARTKEY)
    
  as (
    

SELECT "P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"  
FROM db.src_part
  )
2022-01-08 15:56:06.068398 (Thread-4): Block "" send time: 0.000069
2022-01-08 15:56:06.068951 (Thread-3): Block "" send time: 0.000048
2022-01-08 15:56:06.071636 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */


  
    create table db.lineorder__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT "LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
FROM db.src_lineorder
  )
2022-01-08 15:56:06.072105 (Thread-2): Block "" send time: 0.000041
2022-01-08 15:56:06.074151 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */


  
    create table db.customer__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (C_CUSTKEY)
    
  as (
    

SELECT  "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
FROM db.src_customer
  )
2022-01-08 15:56:06.074847 (Thread-1): Block "" send time: 0.000062
2022-01-08 15:56:06.668303 (Thread-4): SQL status: OK in 0.70 seconds
2022-01-08 15:56:06.690217 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    drop table if exists db.supplier__dbt_backup 
  
  ...
2022-01-08 15:56:06.798574 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    drop table if exists db.supplier__dbt_backup 
  
  
2022-01-08 15:56:06.799720 (Thread-4): Block "" send time: 0.000131
2022-01-08 15:56:06.921291 (Thread-4): SQL status: OK in 0.23 seconds
2022-01-08 15:56:06.922836 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    rename table db.supplier to db.supplier__dbt_backup 
  
  ...
2022-01-08 15:56:07.040700 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    rename table db.supplier to db.supplier__dbt_backup 
  
  
2022-01-08 15:56:07.041771 (Thread-4): Block "" send time: 0.000089
2022-01-08 15:56:07.204760 (Thread-4): SQL status: OK in 0.28 seconds
2022-01-08 15:56:07.213231 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    drop table if exists db.supplier 
  
  ...
2022-01-08 15:56:07.318557 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    drop table if exists db.supplier 
  
  
2022-01-08 15:56:07.319515 (Thread-4): Block "" send time: 0.000085
2022-01-08 15:56:07.434373 (Thread-4): SQL status: OK in 0.22 seconds
2022-01-08 15:56:07.438041 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    rename table db.supplier__dbt_tmp to db.supplier 
  
  ...
2022-01-08 15:56:07.540931 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    rename table db.supplier__dbt_tmp to db.supplier 
  
  
2022-01-08 15:56:07.541988 (Thread-4): Block "" send time: 0.000093
2022-01-08 15:56:07.646080 (Thread-4): SQL status: OK in 0.21 seconds
2022-01-08 15:56:07.687856 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */
drop table if exists db.supplier__dbt_backup 
  ...
2022-01-08 15:56:07.824010 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */
drop table if exists db.supplier__dbt_backup 
  
2022-01-08 15:56:07.825086 (Thread-4): Block "" send time: 0.000091
2022-01-08 15:56:07.939346 (Thread-4): SQL status: OK in 0.25 seconds
2022-01-08 15:56:07.940466 (Thread-4): finished collecting timing info
2022-01-08 15:56:07.940674 (Thread-4): On model.clickhouse_starschema.supplier: No close available on handle
2022-01-08 15:56:07.941108 (Thread-4): 18:56:07 | 4 of 8 OK created table model db.supplier............................ [OK in 2.70s]
2022-01-08 15:56:07.941298 (Thread-4): Finished running node model.clickhouse_starschema.supplier
2022-01-08 15:56:11.905336 (Thread-1): SQL status: OK in 5.94 seconds
2022-01-08 15:56:11.921388 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer__dbt_backup 
  
  ...
2022-01-08 15:56:12.039276 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer__dbt_backup 
  
  
2022-01-08 15:56:12.040363 (Thread-1): Block "" send time: 0.000093
2022-01-08 15:56:12.149199 (Thread-1): SQL status: OK in 0.23 seconds
2022-01-08 15:56:12.156714 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer to db.customer__dbt_backup 
  
  ...
2022-01-08 15:56:12.274468 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer to db.customer__dbt_backup 
  
  
2022-01-08 15:56:12.275578 (Thread-1): Block "" send time: 0.000094
2022-01-08 15:56:12.424539 (Thread-1): SQL status: OK in 0.27 seconds
2022-01-08 15:56:12.432653 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer 
  
  ...
2022-01-08 15:56:12.554413 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    drop table if exists db.customer 
  
  
2022-01-08 15:56:12.555488 (Thread-1): Block "" send time: 0.000091
2022-01-08 15:56:12.702679 (Thread-1): SQL status: OK in 0.27 seconds
2022-01-08 15:56:12.706286 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer__dbt_tmp to db.customer 
  
  ...
2022-01-08 15:56:12.812094 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    rename table db.customer__dbt_tmp to db.customer 
  
  
2022-01-08 15:56:12.813170 (Thread-1): Block "" send time: 0.000089
2022-01-08 15:56:12.964470 (Thread-1): SQL status: OK in 0.26 seconds
2022-01-08 15:56:12.974626 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */
drop table if exists db.customer__dbt_backup 
  ...
2022-01-08 15:56:13.105920 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */
drop table if exists db.customer__dbt_backup 
  
2022-01-08 15:56:13.106868 (Thread-3): SQL status: OK in 7.14 seconds
2022-01-08 15:56:13.115696 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part__dbt_backup 
  
  ...
2022-01-08 15:56:13.116588 (Thread-1): Block "" send time: 0.003457
2022-01-08 15:56:13.299519 (Thread-1): SQL status: OK in 0.32 seconds
2022-01-08 15:56:13.300867 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part__dbt_backup 
  
  
2022-01-08 15:56:13.305097 (Thread-1): finished collecting timing info
2022-01-08 15:56:13.306274 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 15:56:13.307904 (Thread-1): 18:56:13 | 1 of 8 OK created table model db.customer............................ [OK in 8.08s]
2022-01-08 15:56:13.308959 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 15:56:13.309788 (Thread-3): Block "" send time: 0.001052
2022-01-08 15:56:13.415632 (Thread-3): SQL status: OK in 0.30 seconds
2022-01-08 15:56:13.416644 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part to db.part__dbt_backup 
  
  ...
2022-01-08 15:56:13.517870 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part to db.part__dbt_backup 
  
  
2022-01-08 15:56:13.518503 (Thread-3): Block "" send time: 0.000055
2022-01-08 15:56:13.622307 (Thread-3): SQL status: OK in 0.21 seconds
2022-01-08 15:56:13.630418 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part 
  
  ...
2022-01-08 15:56:13.735630 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    drop table if exists db.part 
  
  
2022-01-08 15:56:13.737224 (Thread-3): Block "" send time: 0.000128
2022-01-08 15:56:13.838662 (Thread-3): SQL status: OK in 0.21 seconds
2022-01-08 15:56:13.842187 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part__dbt_tmp to db.part 
  
  ...
2022-01-08 15:56:13.956043 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    rename table db.part__dbt_tmp to db.part 
  
  
2022-01-08 15:56:13.956360 (Thread-3): Block "" send time: 0.000026
2022-01-08 15:56:14.066027 (Thread-3): SQL status: OK in 0.22 seconds
2022-01-08 15:56:14.075886 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */
drop table if exists db.part__dbt_backup 
  ...
2022-01-08 15:56:14.197990 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */
drop table if exists db.part__dbt_backup 
  
2022-01-08 15:56:14.199166 (Thread-3): Block "" send time: 0.000089
2022-01-08 15:56:14.313423 (Thread-3): SQL status: OK in 0.24 seconds
2022-01-08 15:56:14.317480 (Thread-3): finished collecting timing info
2022-01-08 15:56:14.318240 (Thread-3): On model.clickhouse_starschema.part: No close available on handle
2022-01-08 15:56:14.319729 (Thread-3): 18:56:14 | 3 of 8 OK created table model db.part................................ [OK in 9.08s]
2022-01-08 15:56:14.320476 (Thread-3): Finished running node model.clickhouse_starschema.part
2022-01-08 16:03:33.708397 (Thread-2): SQL status: OK in 447.74 seconds
2022-01-08 16:03:33.712148 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    drop table if exists db.lineorder__dbt_backup 
  
  ...
2022-01-08 16:03:33.813691 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    drop table if exists db.lineorder__dbt_backup 
  
  
2022-01-08 16:03:33.814000 (Thread-2): Block "" send time: 0.000028
2022-01-08 16:03:33.917551 (Thread-2): SQL status: OK in 0.21 seconds
2022-01-08 16:03:33.921578 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    rename table db.lineorder to db.lineorder__dbt_backup 
  
  ...
2022-01-08 16:03:34.023649 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    rename table db.lineorder to db.lineorder__dbt_backup 
  
  
2022-01-08 16:03:34.024802 (Thread-2): Block "" send time: 0.000096
2022-01-08 16:03:34.127291 (Thread-2): SQL status: OK in 0.21 seconds
2022-01-08 16:03:34.130159 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    drop table if exists db.lineorder 
  
  ...
2022-01-08 16:03:34.231827 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    drop table if exists db.lineorder 
  
  
2022-01-08 16:03:34.233005 (Thread-2): Block "" send time: 0.000124
2022-01-08 16:03:34.335938 (Thread-2): SQL status: OK in 0.21 seconds
2022-01-08 16:03:34.339292 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    rename table db.lineorder__dbt_tmp to db.lineorder 
  
  ...
2022-01-08 16:03:34.494427 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    rename table db.lineorder__dbt_tmp to db.lineorder 
  
  
2022-01-08 16:03:34.495421 (Thread-2): Block "" send time: 0.000092
2022-01-08 16:03:34.596792 (Thread-2): SQL status: OK in 0.26 seconds
2022-01-08 16:03:34.603480 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */
drop table if exists db.lineorder__dbt_backup 
  ...
2022-01-08 16:03:34.705914 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */
drop table if exists db.lineorder__dbt_backup 
  
2022-01-08 16:03:34.706999 (Thread-2): Block "" send time: 0.000098
2022-01-08 16:03:34.808394 (Thread-2): SQL status: OK in 0.20 seconds
2022-01-08 16:03:34.812211 (Thread-2): finished collecting timing info
2022-01-08 16:03:34.813028 (Thread-2): On model.clickhouse_starschema.lineorder: No close available on handle
2022-01-08 16:03:34.814694 (Thread-2): 19:03:34 | 2 of 8 OK created table model db.lineorder........................... [OK in 449.58s]
2022-01-08 16:03:34.815544 (Thread-2): Finished running node model.clickhouse_starschema.lineorder
2022-01-08 16:03:34.817715 (Thread-4): Began running node model.clickhouse_starschema.lineorder_flat
2022-01-08 16:03:34.819263 (Thread-4): 19:03:34 | 5 of 8 START table model db.lineorder_flat........................... [RUN]
2022-01-08 16:03:34.820722 (Thread-4): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder_flat".
2022-01-08 16:03:34.821687 (Thread-4): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60650), raddr=('51.250.28.188', 9440)>
2022-01-08 16:03:34.822464 (Thread-4): Compiling model.clickhouse_starschema.lineorder_flat
2022-01-08 16:03:34.847755 (Thread-4): Opening a new connection, currently in state closed
2022-01-08 16:03:34.848259 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'lineorder'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:03:34.848649 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:03:34.848957 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:03:35.247404 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:03:35.248549 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'lineorder'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:03:35.249650 (Thread-4): Block "" send time: 0.000130
2022-01-08 16:03:35.350384 (Thread-4): SQL status: OK in 0.50 seconds
2022-01-08 16:03:35.355463 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.356276 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.357028 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.357646 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.358403 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.359002 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.359592 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.360233 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.360820 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.361398 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.361974 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.362489 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.363006 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.363519 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.364177 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.364708 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.365235 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.370785 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:03:35.469565 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:03:35.469889 (Thread-4): Block "" send time: 0.000029
2022-01-08 16:03:35.572111 (Thread-4): SQL status: OK in 0.20 seconds
2022-01-08 16:03:35.577450 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.578122 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.578685 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.579231 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.579770 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.580382 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.580922 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.581463 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.588690 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'supplier'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:03:35.687652 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'supplier'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:03:35.688825 (Thread-4): Block "" send time: 0.000099
2022-01-08 16:03:35.794714 (Thread-4): SQL status: OK in 0.21 seconds
2022-01-08 16:03:35.799777 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.800694 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.801358 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.802032 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.802643 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.803246 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.804029 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:35.813444 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'part'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:03:35.912054 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'part'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:03:35.912475 (Thread-4): Block "" send time: 0.000035
2022-01-08 16:03:36.014126 (Thread-4): SQL status: OK in 0.20 seconds
2022-01-08 16:03:36.019794 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:36.020955 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:36.021631 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:36.022257 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:36.022877 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:36.023418 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:36.023983 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:36.024560 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:36.025109 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:03:36.026534 (Thread-4): Writing injected SQL for node "model.clickhouse_starschema.lineorder_flat"
2022-01-08 16:03:36.027665 (Thread-4): finished collecting timing info
2022-01-08 16:03:36.037232 (Thread-4): Writing runtime SQL for node "model.clickhouse_starschema.lineorder_flat"
2022-01-08 16:03:36.038421 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */


  
    create table db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT
    "LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE",
    "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT",
    "S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE",
    "P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
FROM db.lineorder AS l
INNER JOIN db.customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN db.supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN db.part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
2022-01-08 16:03:36.140830 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */


  
    create table db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT
    "LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE",
    "C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT",
    "S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE",
    "P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
FROM db.lineorder AS l
INNER JOIN db.customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN db.supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN db.part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )
2022-01-08 16:03:36.141266 (Thread-4): Block "" send time: 0.000040
2022-01-08 16:19:31.404932 (Thread-4): SQL status: OK in 955.37 seconds
2022-01-08 16:19:31.422232 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    drop table if exists db.lineorder_flat__dbt_backup 
  
  ...
2022-01-08 16:19:31.521029 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    drop table if exists db.lineorder_flat__dbt_backup 
  
  
2022-01-08 16:19:31.522085 (Thread-4): Block "" send time: 0.000093
2022-01-08 16:19:31.620216 (Thread-4): SQL status: OK in 0.20 seconds
2022-01-08 16:19:31.623656 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    rename table db.lineorder_flat to db.lineorder_flat__dbt_backup 
  
  ...
2022-01-08 16:19:31.722986 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    rename table db.lineorder_flat to db.lineorder_flat__dbt_backup 
  
  
2022-01-08 16:19:31.724098 (Thread-4): Block "" send time: 0.000124
2022-01-08 16:19:31.826490 (Thread-4): SQL status: OK in 0.20 seconds
2022-01-08 16:19:31.834514 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    drop table if exists db.lineorder_flat 
  
  ...
2022-01-08 16:19:31.933397 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    drop table if exists db.lineorder_flat 
  
  
2022-01-08 16:19:31.934473 (Thread-4): Block "" send time: 0.000096
2022-01-08 16:19:32.033705 (Thread-4): SQL status: OK in 0.20 seconds
2022-01-08 16:19:32.037270 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    rename table db.lineorder_flat__dbt_tmp to db.lineorder_flat 
  
  ...
2022-01-08 16:19:32.135790 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    rename table db.lineorder_flat__dbt_tmp to db.lineorder_flat 
  
  
2022-01-08 16:19:32.136906 (Thread-4): Block "" send time: 0.000092
2022-01-08 16:19:32.236475 (Thread-4): SQL status: OK in 0.20 seconds
2022-01-08 16:19:32.246725 (Thread-4): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */
drop table if exists db.lineorder_flat__dbt_backup 
  ...
2022-01-08 16:19:32.346041 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */
drop table if exists db.lineorder_flat__dbt_backup 
  
2022-01-08 16:19:32.347084 (Thread-4): Block "" send time: 0.000093
2022-01-08 16:19:32.455464 (Thread-4): SQL status: OK in 0.21 seconds
2022-01-08 16:19:32.459381 (Thread-4): finished collecting timing info
2022-01-08 16:19:32.460175 (Thread-4): On model.clickhouse_starschema.lineorder_flat: No close available on handle
2022-01-08 16:19:32.461804 (Thread-4): 19:19:32 | 5 of 8 OK created table model db.lineorder_flat...................... [OK in 957.64s]
2022-01-08 16:19:32.462538 (Thread-4): Finished running node model.clickhouse_starschema.lineorder_flat
2022-01-08 16:19:32.464947 (Thread-3): Began running node model.clickhouse_starschema.q2_1
2022-01-08 16:19:32.465803 (Thread-2): Began running node model.clickhouse_starschema.q3_3
2022-01-08 16:19:32.466989 (Thread-3): 19:19:32 | 6 of 8 START table model db.q2_1..................................... [RUN]
2022-01-08 16:19:32.467708 (Thread-1): Began running node model.clickhouse_starschema.q4_2
2022-01-08 16:19:32.468886 (Thread-2): 19:19:32 | 7 of 8 START table model db.q3_3..................................... [RUN]
2022-01-08 16:19:32.470315 (Thread-3): Acquiring new clickhouse connection "model.clickhouse_starschema.q2_1".
2022-01-08 16:19:32.471325 (Thread-1): 19:19:32 | 8 of 8 START table model db.q4_2..................................... [RUN]
2022-01-08 16:19:32.472474 (Thread-3): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60652), raddr=('51.250.28.188', 9440)>
2022-01-08 16:19:32.478971 (Thread-2): Acquiring new clickhouse connection "model.clickhouse_starschema.q3_3".
2022-01-08 16:19:32.480875 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.q4_2".
2022-01-08 16:19:32.482239 (Thread-3): Compiling model.clickhouse_starschema.q2_1
2022-01-08 16:19:32.483466 (Thread-2): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60648), raddr=('51.250.28.188', 9440)>
2022-01-08 16:19:32.484713 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60654), raddr=('51.250.28.188', 9440)>
2022-01-08 16:19:32.494207 (Thread-3): Writing injected SQL for node "model.clickhouse_starschema.q2_1"
2022-01-08 16:19:32.495220 (Thread-2): Compiling model.clickhouse_starschema.q3_3
2022-01-08 16:19:32.496252 (Thread-1): Compiling model.clickhouse_starschema.q4_2
2022-01-08 16:19:32.502797 (Thread-2): Writing injected SQL for node "model.clickhouse_starschema.q3_3"
2022-01-08 16:19:32.508089 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.q4_2"
2022-01-08 16:19:32.508649 (Thread-3): finished collecting timing info
2022-01-08 16:19:32.513362 (Thread-3): Writing runtime SQL for node "model.clickhouse_starschema.q2_1"
2022-01-08 16:19:32.513713 (Thread-2): finished collecting timing info
2022-01-08 16:19:32.517028 (Thread-2): Writing runtime SQL for node "model.clickhouse_starschema.q3_3"
2022-01-08 16:19:32.517468 (Thread-3): Opening a new connection, currently in state closed
2022-01-08 16:19:32.517662 (Thread-1): finished collecting timing info
2022-01-08 16:19:32.517861 (Thread-2): Opening a new connection, currently in state closed
2022-01-08 16:19:32.518048 (Thread-3): On model.clickhouse_starschema.q2_1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */


  
    create table db.q2_1__dbt_tmp
    
  
    
    engine = MergeTree()
    
    order by (tuple())
    
  as (
    SELECT
    sum(LO_REVENUE) AS sum_LO_REVENUE,
    toYear(LO_ORDERDATE) AS year,
    P_BRAND
FROM db.lineorder_flat
WHERE P_CATEGORY = 'MFGR#12' AND S_REGION = 'AMERICA'
GROUP BY
    year,
    P_BRAND
ORDER BY
    year,
    P_BRAND
  )...
2022-01-08 16:19:32.520512 (Thread-1): Writing runtime SQL for node "model.clickhouse_starschema.q4_2"
2022-01-08 16:19:32.520769 (Thread-2): On model.clickhouse_starschema.q3_3: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */


  
    create table db.q3_3__dbt_tmp
    
  
    
    engine = MergeTree()
    
    order by (tuple())
    
  as (
    SELECT
    C_CITY,
    S_CITY,
    toYear(LO_ORDERDATE) AS year,
    sum(LO_REVENUE) AS revenue
FROM db.lineorder_flat
WHERE (C_CITY = 'UNITED KI1' OR C_CITY = 'UNITED KI5') AND (S_CITY = 'UNITED KI1' OR S_CITY = 'UNITED KI5') AND year >= 1992 AND year <= 1997
GROUP BY
    C_CITY,
    S_CITY,
    year
ORDER BY
    year ASC,
    revenue DESC
  )...
2022-01-08 16:19:32.521006 (Thread-3): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:19:32.521387 (Thread-2): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:19:32.521574 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 16:19:32.521770 (Thread-3): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:19:32.521936 (Thread-1): On model.clickhouse_starschema.q4_2: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */


  
    create table db.q4_2__dbt_tmp
    
  
    
    engine = MergeTree()
    
    order by (tuple())
    
  as (
    SELECT
    toYear(LO_ORDERDATE) AS year,
    S_NATION,
    P_CATEGORY,
    sum(LO_REVENUE - LO_SUPPLYCOST) AS profit
FROM db.lineorder_flat
WHERE C_REGION = 'AMERICA' AND S_REGION = 'AMERICA' AND (year = 1997 OR year = 1998) AND (P_MFGR = 'MFGR#1' OR P_MFGR = 'MFGR#2')
GROUP BY
    year,
    S_NATION,
    P_CATEGORY
ORDER BY
    year ASC,
    S_NATION ASC,
    P_CATEGORY ASC
  )...
2022-01-08 16:19:32.522134 (Thread-2): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:19:32.522456 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:19:32.522646 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:19:33.179268 (Thread-2): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:19:33.180325 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */


  
    create table db.q3_3__dbt_tmp
    
  
    
    engine = MergeTree()
    
    order by (tuple())
    
  as (
    SELECT
    C_CITY,
    S_CITY,
    toYear(LO_ORDERDATE) AS year,
    sum(LO_REVENUE) AS revenue
FROM db.lineorder_flat
WHERE (C_CITY = 'UNITED KI1' OR C_CITY = 'UNITED KI5') AND (S_CITY = 'UNITED KI1' OR S_CITY = 'UNITED KI5') AND year >= 1992 AND year <= 1997
GROUP BY
    C_CITY,
    S_CITY,
    year
ORDER BY
    year ASC,
    revenue DESC
  )
2022-01-08 16:19:33.181242 (Thread-2): Block "" send time: 0.000089
2022-01-08 16:19:33.372870 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:19:33.373876 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */


  
    create table db.q4_2__dbt_tmp
    
  
    
    engine = MergeTree()
    
    order by (tuple())
    
  as (
    SELECT
    toYear(LO_ORDERDATE) AS year,
    S_NATION,
    P_CATEGORY,
    sum(LO_REVENUE - LO_SUPPLYCOST) AS profit
FROM db.lineorder_flat
WHERE C_REGION = 'AMERICA' AND S_REGION = 'AMERICA' AND (year = 1997 OR year = 1998) AND (P_MFGR = 'MFGR#1' OR P_MFGR = 'MFGR#2')
GROUP BY
    year,
    S_NATION,
    P_CATEGORY
ORDER BY
    year ASC,
    S_NATION ASC,
    P_CATEGORY ASC
  )
2022-01-08 16:19:33.374789 (Thread-1): Block "" send time: 0.000086
2022-01-08 16:19:33.376994 (Thread-3): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:19:33.377907 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */


  
    create table db.q2_1__dbt_tmp
    
  
    
    engine = MergeTree()
    
    order by (tuple())
    
  as (
    SELECT
    sum(LO_REVENUE) AS sum_LO_REVENUE,
    toYear(LO_ORDERDATE) AS year,
    P_BRAND
FROM db.lineorder_flat
WHERE P_CATEGORY = 'MFGR#12' AND S_REGION = 'AMERICA'
GROUP BY
    year,
    P_BRAND
ORDER BY
    year,
    P_BRAND
  )
2022-01-08 16:19:33.378800 (Thread-3): Block "" send time: 0.000084
2022-01-08 16:19:34.294873 (Thread-1): SQL status: OK in 1.77 seconds
2022-01-08 16:19:34.303498 (Thread-1): On model.clickhouse_starschema.q4_2: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */

    drop table if exists db.q4_2__dbt_backup 
  
  ...
2022-01-08 16:19:34.415232 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */

    drop table if exists db.q4_2__dbt_backup 
  
  
2022-01-08 16:19:34.416430 (Thread-1): Block "" send time: 0.000123
2022-01-08 16:19:34.522137 (Thread-1): SQL status: OK in 0.22 seconds
2022-01-08 16:19:34.525606 (Thread-1): On model.clickhouse_starschema.q4_2: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */

    rename table db.q4_2 to db.q4_2__dbt_backup 
  
  ...
2022-01-08 16:19:34.645003 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */

    rename table db.q4_2 to db.q4_2__dbt_backup 
  
  
2022-01-08 16:19:34.646081 (Thread-1): Block "" send time: 0.000091
2022-01-08 16:19:34.752510 (Thread-1): SQL status: OK in 0.23 seconds
2022-01-08 16:19:34.760529 (Thread-1): On model.clickhouse_starschema.q4_2: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */

    drop table if exists db.q4_2 
  
  ...
2022-01-08 16:19:34.871139 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */

    drop table if exists db.q4_2 
  
  
2022-01-08 16:19:34.872258 (Thread-1): Block "" send time: 0.000095
2022-01-08 16:19:35.000697 (Thread-1): SQL status: OK in 0.24 seconds
2022-01-08 16:19:35.004310 (Thread-1): On model.clickhouse_starschema.q4_2: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */

    rename table db.q4_2__dbt_tmp to db.q4_2 
  
  ...
2022-01-08 16:19:35.110641 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */

    rename table db.q4_2__dbt_tmp to db.q4_2 
  
  
2022-01-08 16:19:35.111819 (Thread-1): Block "" send time: 0.000126
2022-01-08 16:19:35.218286 (Thread-1): SQL status: OK in 0.21 seconds
2022-01-08 16:19:35.226260 (Thread-1): On model.clickhouse_starschema.q4_2: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */
drop table if exists db.q4_2__dbt_backup 
  ...
2022-01-08 16:19:35.336280 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q4_2"} */
drop table if exists db.q4_2__dbt_backup 
  
2022-01-08 16:19:35.337334 (Thread-1): Block "" send time: 0.000087
2022-01-08 16:19:35.463388 (Thread-1): SQL status: OK in 0.24 seconds
2022-01-08 16:19:35.467509 (Thread-1): finished collecting timing info
2022-01-08 16:19:35.468512 (Thread-1): On model.clickhouse_starschema.q4_2: No close available on handle
2022-01-08 16:19:35.470161 (Thread-1): 19:19:35 | 8 of 8 OK created table model db.q4_2................................ [OK in 2.99s]
2022-01-08 16:19:35.471154 (Thread-1): Finished running node model.clickhouse_starschema.q4_2
2022-01-08 16:19:52.751514 (Thread-2): SQL status: OK in 20.23 seconds
2022-01-08 16:19:52.766315 (Thread-2): On model.clickhouse_starschema.q3_3: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */

    drop table if exists db.q3_3__dbt_backup 
  
  ...
2022-01-08 16:19:52.838144 (Thread-3): SQL status: OK in 20.32 seconds
2022-01-08 16:19:52.846678 (Thread-3): On model.clickhouse_starschema.q2_1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */

    drop table if exists db.q2_1__dbt_backup 
  
  ...
2022-01-08 16:19:52.868341 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */

    drop table if exists db.q3_3__dbt_backup 
  
  
2022-01-08 16:19:52.869385 (Thread-2): Block "" send time: 0.000095
2022-01-08 16:19:52.953522 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */

    drop table if exists db.q2_1__dbt_backup 
  
  
2022-01-08 16:19:52.954596 (Thread-3): Block "" send time: 0.000087
2022-01-08 16:19:52.973191 (Thread-2): SQL status: OK in 0.21 seconds
2022-01-08 16:19:52.976718 (Thread-2): On model.clickhouse_starschema.q3_3: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */

    rename table db.q3_3 to db.q3_3__dbt_backup 
  
  ...
2022-01-08 16:19:53.060216 (Thread-3): SQL status: OK in 0.21 seconds
2022-01-08 16:19:53.062336 (Thread-3): On model.clickhouse_starschema.q2_1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */

    rename table db.q2_1 to db.q2_1__dbt_backup 
  
  ...
2022-01-08 16:19:53.078530 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */

    rename table db.q3_3 to db.q3_3__dbt_backup 
  
  
2022-01-08 16:19:53.079584 (Thread-2): Block "" send time: 0.000090
2022-01-08 16:19:53.169318 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */

    rename table db.q2_1 to db.q2_1__dbt_backup 
  
  
2022-01-08 16:19:53.169929 (Thread-3): Block "" send time: 0.000049
2022-01-08 16:19:53.180959 (Thread-2): SQL status: OK in 0.20 seconds
2022-01-08 16:19:53.185297 (Thread-2): On model.clickhouse_starschema.q3_3: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */

    drop table if exists db.q3_3 
  
  ...
2022-01-08 16:19:53.275347 (Thread-3): SQL status: OK in 0.21 seconds
2022-01-08 16:19:53.283152 (Thread-3): On model.clickhouse_starschema.q2_1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */

    drop table if exists db.q2_1 
  
  ...
2022-01-08 16:19:53.286788 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */

    drop table if exists db.q3_3 
  
  
2022-01-08 16:19:53.287912 (Thread-2): Block "" send time: 0.000095
2022-01-08 16:19:53.390994 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */

    drop table if exists db.q2_1 
  
  
2022-01-08 16:19:53.391795 (Thread-2): SQL status: OK in 0.21 seconds
2022-01-08 16:19:53.392902 (Thread-3): Block "" send time: 0.000102
2022-01-08 16:19:53.396569 (Thread-2): On model.clickhouse_starschema.q3_3: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */

    rename table db.q3_3__dbt_tmp to db.q3_3 
  
  ...
2022-01-08 16:19:53.498142 (Thread-3): SQL status: OK in 0.21 seconds
2022-01-08 16:19:53.501801 (Thread-3): On model.clickhouse_starschema.q2_1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */

    rename table db.q2_1__dbt_tmp to db.q2_1 
  
  ...
2022-01-08 16:19:53.503007 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */

    rename table db.q3_3__dbt_tmp to db.q3_3 
  
  
2022-01-08 16:19:53.504111 (Thread-2): Block "" send time: 0.000150
2022-01-08 16:19:53.637758 (Thread-2): SQL status: OK in 0.24 seconds
2022-01-08 16:19:53.644507 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */

    rename table db.q2_1__dbt_tmp to db.q2_1 
  
  
2022-01-08 16:19:53.648975 (Thread-2): On model.clickhouse_starschema.q3_3: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */
drop table if exists db.q3_3__dbt_backup 
  ...
2022-01-08 16:19:53.650053 (Thread-3): Block "" send time: 0.000106
2022-01-08 16:19:53.751985 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q3_3"} */
drop table if exists db.q3_3__dbt_backup 
  
2022-01-08 16:19:53.753032 (Thread-2): Block "" send time: 0.000090
2022-01-08 16:19:53.755721 (Thread-3): SQL status: OK in 0.25 seconds
2022-01-08 16:19:53.766664 (Thread-3): On model.clickhouse_starschema.q2_1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */
drop table if exists db.q2_1__dbt_backup 
  ...
2022-01-08 16:19:53.854069 (Thread-2): SQL status: OK in 0.20 seconds
2022-01-08 16:19:53.857830 (Thread-2): finished collecting timing info
2022-01-08 16:19:53.858772 (Thread-2): On model.clickhouse_starschema.q3_3: No close available on handle
2022-01-08 16:19:53.860328 (Thread-2): 19:19:53 | 7 of 8 OK created table model db.q3_3................................ [OK in 21.39s]
2022-01-08 16:19:53.861052 (Thread-2): Finished running node model.clickhouse_starschema.q3_3
2022-01-08 16:19:53.872577 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.q2_1"} */
drop table if exists db.q2_1__dbt_backup 
  
2022-01-08 16:19:53.873656 (Thread-3): Block "" send time: 0.000096
2022-01-08 16:19:54.007565 (Thread-3): SQL status: OK in 0.24 seconds
2022-01-08 16:19:54.011505 (Thread-3): finished collecting timing info
2022-01-08 16:19:54.012312 (Thread-3): On model.clickhouse_starschema.q2_1: No close available on handle
2022-01-08 16:19:54.013892 (Thread-3): 19:19:54 | 6 of 8 OK created table model db.q2_1................................ [OK in 21.54s]
2022-01-08 16:19:54.014648 (Thread-3): Finished running node model.clickhouse_starschema.q2_1
2022-01-08 16:19:54.018369 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 16:19:54.019711 (MainThread): 19:19:54 | 
2022-01-08 16:19:54.020535 (MainThread): 19:19:54 | Finished running 8 table models in 1430.17s.
2022-01-08 16:19:54.021484 (MainThread): Connection 'master' was properly closed.
2022-01-08 16:19:54.022221 (MainThread): Connection 'model.clickhouse_starschema.q4_2' was properly closed.
2022-01-08 16:19:54.022768 (MainThread): Connection 'model.clickhouse_starschema.q3_3' was properly closed.
2022-01-08 16:19:54.023539 (MainThread): Connection 'model.clickhouse_starschema.q2_1' was properly closed.
2022-01-08 16:19:54.024139 (MainThread): Connection 'model.clickhouse_starschema.lineorder_flat' was properly closed.
2022-01-08 16:19:54.024876 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60950), raddr=('51.250.28.188', 9440)>
2022-01-08 16:19:54.025646 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60948), raddr=('51.250.28.188', 9440)>
2022-01-08 16:19:54.030964 (MainThread): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 60704), raddr=('51.250.28.188', 9440)>
2022-01-08 16:19:54.053020 (MainThread): 
2022-01-08 16:19:54.053364 (MainThread): Completed successfully
2022-01-08 16:19:54.053803 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2022-01-08 16:19:54.054261 (MainThread): Flushing usage events
2022-01-08 16:27:46.660373 (MainThread): Running with dbt=0.21.1
2022-01-08 16:27:46.827983 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, greedy=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, select=None, selector_name=None, single_threaded=False, state=None, store_failures=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2022-01-08 16:27:46.836910 (MainThread): Tracking: do not track
2022-01-08 16:27:46.888143 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 16:27:46.888415 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 16:27:46.927707 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 16:27:46.928415 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 16:27:46.930736 (MainThread): 
2022-01-08 16:27:46.931139 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 16:27:46.932379 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 16:27:46.941848 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-01-08 16:27:46.942140 (ThreadPoolExecutor-1_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 16:27:46.942412 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:46.942599 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:47.711349 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:47.712809 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 16:27:47.713774 (ThreadPoolExecutor-1_0): Block "" send time: 0.000108
2022-01-08 16:27:47.826079 (ThreadPoolExecutor-1_0): SQL status: OK in 0.88 seconds
2022-01-08 16:27:47.830845 (ThreadPoolExecutor-1_0): On list_None_db: No close available on handle
2022-01-08 16:27:47.833528 (MainThread): 19:27:47 | Concurrency: 4 threads (target='dev')
2022-01-08 16:27:47.834324 (MainThread): 19:27:47 | 
2022-01-08 16:27:47.843206 (Thread-1): Began running node test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122
2022-01-08 16:27:47.844040 (Thread-2): Began running node test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023
2022-01-08 16:27:47.844822 (Thread-3): Began running node test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf
2022-01-08 16:27:47.845624 (Thread-1): 19:27:47 | 1 of 16 START test accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY [RUN]
2022-01-08 16:27:47.846564 (Thread-4): Began running node test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0
2022-01-08 16:27:47.847421 (Thread-2): 19:27:47 | 2 of 16 START test accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE [RUN]
2022-01-08 16:27:47.848240 (Thread-3): 19:27:47 | 3 of 16 START test accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE [RUN]
2022-01-08 16:27:47.849176 (Thread-4): 19:27:47 | 4 of 16 START test dbt_utils_at_least_one_q2_1_...................... [RUN]
2022-01-08 16:27:47.850418 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122".
2022-01-08 16:27:47.851717 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023".
2022-01-08 16:27:47.853159 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf".
2022-01-08 16:27:47.854501 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0".
2022-01-08 16:27:47.855372 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32920), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:47.856486 (Thread-2): Compiling test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023
2022-01-08 16:27:47.857342 (Thread-3): Compiling test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf
2022-01-08 16:27:47.858115 (Thread-4): Compiling test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0
2022-01-08 16:27:47.859179 (Thread-1): Compiling test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122
2022-01-08 16:27:47.910930 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf"
2022-01-08 16:27:47.912585 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023"
2022-01-08 16:27:47.916955 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0"
2022-01-08 16:27:47.918097 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122"
2022-01-08 16:27:47.918835 (Thread-2): finished collecting timing info
2022-01-08 16:27:47.919030 (Thread-1): finished collecting timing info
2022-01-08 16:27:47.924264 (Thread-3): finished collecting timing info
2022-01-08 16:27:47.924446 (Thread-4): finished collecting timing info
2022-01-08 16:27:47.936746 (Thread-2): Writing runtime SQL for node "test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023"
2022-01-08 16:27:47.938387 (Thread-3): Writing runtime SQL for node "test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf"
2022-01-08 16:27:47.940149 (Thread-1): Writing runtime SQL for node "test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122"
2022-01-08 16:27:47.942005 (Thread-4): Writing runtime SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0"
2022-01-08 16:27:47.942729 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 16:27:47.942920 (Thread-2): Opening a new connection, currently in state init
2022-01-08 16:27:47.943130 (Thread-1): On test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

with all_values as (

    select
        C_MKTSEGMENT as value_field,
        count(*) as n_records

    from db.customer
    group by C_MKTSEGMENT

)

select *
from all_values
where value_field not in (
    'AUTOMOBILE','BUILDING','FURNITURE','HOUSEHOLD','MACHINERY'
)



      
    ) dbt_internal_test...
2022-01-08 16:27:47.943321 (Thread-2): On test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

with all_values as (

    select
        C_REGION as value_field,
        count(*) as n_records

    from db.customer
    group by C_REGION

)

select *
from all_values
where value_field not in (
    'AFRICA','MIDDLE EAST','AMERICA','ASIA','EUROPE'
)



      
    ) dbt_internal_test...
2022-01-08 16:27:47.943520 (Thread-3): Opening a new connection, currently in state init
2022-01-08 16:27:47.943777 (Thread-4): Opening a new connection, currently in state init
2022-01-08 16:27:47.944019 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:47.944291 (Thread-3): On test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

with all_values as (

    select
        S_REGION as value_field,
        count(*) as n_records

    from db.supplier
    group by S_REGION

)

select *
from all_values
where value_field not in (
    'AFRICA','MIDDLE EAST','AMERICA','ASIA','EUROPE'
)



      
    ) dbt_internal_test...
2022-01-08 16:27:47.944582 (Thread-4): On test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      

select *
from (
    select
        
        
      count() as filler_column

    from db.q2_1

    having count() = 0

) validation_errors


      
    ) dbt_internal_test...
2022-01-08 16:27:47.944852 (Thread-2): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:47.945157 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:47.945329 (Thread-3): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:47.945544 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:47.945919 (Thread-2): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:47.946084 (Thread-3): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:47.946264 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:48.347438 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:48.347763 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      

select *
from (
    select
        
        
      count() as filler_column

    from db.q2_1

    having count() = 0

) validation_errors


      
    ) dbt_internal_test
2022-01-08 16:27:48.348004 (Thread-4): Block "" send time: 0.000024
2022-01-08 16:27:48.349177 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:48.349393 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

with all_values as (

    select
        C_MKTSEGMENT as value_field,
        count(*) as n_records

    from db.customer
    group by C_MKTSEGMENT

)

select *
from all_values
where value_field not in (
    'AUTOMOBILE','BUILDING','FURNITURE','HOUSEHOLD','MACHINERY'
)



      
    ) dbt_internal_test
2022-01-08 16:27:48.349605 (Thread-1): Block "" send time: 0.000021
2022-01-08 16:27:48.352310 (Thread-3): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:48.352636 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

with all_values as (

    select
        S_REGION as value_field,
        count(*) as n_records

    from db.supplier
    group by S_REGION

)

select *
from all_values
where value_field not in (
    'AFRICA','MIDDLE EAST','AMERICA','ASIA','EUROPE'
)



      
    ) dbt_internal_test
2022-01-08 16:27:48.352948 (Thread-3): Block "" send time: 0.000028
2022-01-08 16:27:48.369635 (Thread-2): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:48.369949 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

with all_values as (

    select
        C_REGION as value_field,
        count(*) as n_records

    from db.customer
    group by C_REGION

)

select *
from all_values
where value_field not in (
    'AFRICA','MIDDLE EAST','AMERICA','ASIA','EUROPE'
)



      
    ) dbt_internal_test
2022-01-08 16:27:48.370222 (Thread-2): Block "" send time: 0.000029
2022-01-08 16:27:48.452716 (Thread-4): SQL status: OK in 0.51 seconds
2022-01-08 16:27:48.459557 (Thread-4): finished collecting timing info
2022-01-08 16:27:48.460578 (Thread-4): On test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0: No close available on handle
2022-01-08 16:27:48.461718 (Thread-4): 19:27:48 | 4 of 16 PASS dbt_utils_at_least_one_q2_1_............................ [PASS in 0.61s]
2022-01-08 16:27:48.462398 (Thread-4): Finished running node test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0
2022-01-08 16:27:48.463095 (Thread-4): Began running node test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1
2022-01-08 16:27:48.464260 (Thread-4): 19:27:48 | 5 of 16 START test dbt_utils_at_least_one_q3_3_...................... [RUN]
2022-01-08 16:27:48.465913 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1".
2022-01-08 16:27:48.467008 (Thread-4): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32928), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:48.468120 (Thread-1): SQL status: OK in 0.52 seconds
2022-01-08 16:27:48.469152 (Thread-4): Compiling test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1
2022-01-08 16:27:48.473024 (Thread-1): finished collecting timing info
2022-01-08 16:27:48.485537 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1"
2022-01-08 16:27:48.486313 (Thread-1): On test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122: No close available on handle
2022-01-08 16:27:48.487619 (Thread-3): SQL status: OK in 0.54 seconds
2022-01-08 16:27:48.488879 (Thread-2): SQL status: OK in 0.54 seconds
2022-01-08 16:27:48.490314 (Thread-1): 19:27:48 | 1 of 16 PASS accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY [PASS in 0.64s]
2022-01-08 16:27:48.495368 (Thread-3): finished collecting timing info
2022-01-08 16:27:48.496101 (Thread-4): finished collecting timing info
2022-01-08 16:27:48.500311 (Thread-2): finished collecting timing info
2022-01-08 16:27:48.501424 (Thread-1): Finished running node test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122
2022-01-08 16:27:48.502271 (Thread-3): On test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf: No close available on handle
2022-01-08 16:27:48.508619 (Thread-4): Writing runtime SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1"
2022-01-08 16:27:48.509447 (Thread-2): On test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023: No close available on handle
2022-01-08 16:27:48.510232 (Thread-1): Began running node test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00
2022-01-08 16:27:48.511389 (Thread-3): 19:27:48 | 3 of 16 PASS accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE [PASS in 0.66s]
2022-01-08 16:27:48.512531 (Thread-2): 19:27:48 | 2 of 16 PASS accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE [PASS in 0.66s]
2022-01-08 16:27:48.513133 (Thread-1): 19:27:48 | 6 of 16 START test dbt_utils_at_least_one_q4_2_...................... [RUN]
2022-01-08 16:27:48.513770 (Thread-3): Finished running node test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf
2022-01-08 16:27:48.514550 (Thread-2): Finished running node test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023
2022-01-08 16:27:48.515471 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00".
2022-01-08 16:27:48.516077 (Thread-3): Began running node test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e
2022-01-08 16:27:48.516763 (Thread-4): Opening a new connection, currently in state closed
2022-01-08 16:27:48.517567 (Thread-2): Began running node test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753
2022-01-08 16:27:48.518571 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32922), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:48.519314 (Thread-3): 19:27:48 | 7 of 16 START test dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_ [RUN]
2022-01-08 16:27:48.519939 (Thread-4): On test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      

select *
from (
    select
        
        
      count() as filler_column

    from db.q3_3

    having count() = 0

) validation_errors


      
    ) dbt_internal_test...
2022-01-08 16:27:48.520392 (Thread-2): 19:27:48 | 8 of 16 START test not_null_customer_C_CUSTKEY....................... [RUN]
2022-01-08 16:27:48.520973 (Thread-1): Compiling test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00
2022-01-08 16:27:48.521875 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e".
2022-01-08 16:27:48.522520 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:48.523451 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753".
2022-01-08 16:27:48.530090 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00"
2022-01-08 16:27:48.530500 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:48.530714 (Thread-3): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32926), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:48.531003 (Thread-2): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32924), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:48.531437 (Thread-3): Compiling test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e
2022-01-08 16:27:48.531713 (Thread-1): finished collecting timing info
2022-01-08 16:27:48.540025 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e"
2022-01-08 16:27:48.540263 (Thread-2): Compiling test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753
2022-01-08 16:27:48.541893 (Thread-1): Writing runtime SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00"
2022-01-08 16:27:48.546756 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753"
2022-01-08 16:27:48.547202 (Thread-3): finished collecting timing info
2022-01-08 16:27:48.547405 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 16:27:48.549206 (Thread-3): Writing runtime SQL for node "test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e"
2022-01-08 16:27:48.549450 (Thread-1): On test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      

select *
from (
    select
        
        
      count() as filler_column

    from db.q4_2

    having count() = 0

) validation_errors


      
    ) dbt_internal_test...
2022-01-08 16:27:48.549764 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:48.549936 (Thread-2): finished collecting timing info
2022-01-08 16:27:48.550153 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:48.552451 (Thread-2): Writing runtime SQL for node "test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753"
2022-01-08 16:27:48.552767 (Thread-3): Opening a new connection, currently in state closed
2022-01-08 16:27:48.553176 (Thread-3): On test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e"} */
select
      coalesce(diff_count, 0) as failures,
      case when coalesce(diff_count, 0) != 0
        then 'true' else 'false' end as should_warn,
      case when coalesce(diff_count, 0) != 0
        then 'true' else 'false' end as should_error
    from (
      

with a as (

    select count(*) as count_a from db.lineorder_flat

),
b as (

    select count(*) as count_b from db.lineorder

),
final as (

    select
        count_a,
        count_b,
        abs(count_a - count_b) as diff_count
    from a
    cross join b

)

select * from final


      
    ) dbt_internal_test...
2022-01-08 16:27:48.553413 (Thread-3): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:48.553632 (Thread-3): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:48.553991 (Thread-2): Opening a new connection, currently in state closed
2022-01-08 16:27:48.554323 (Thread-2): On test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select *
from db.customer
where C_CUSTKEY is null



      
    ) dbt_internal_test...
2022-01-08 16:27:48.554556 (Thread-2): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:48.554733 (Thread-2): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:48.975656 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:48.975990 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      

select *
from (
    select
        
        
      count() as filler_column

    from db.q3_3

    having count() = 0

) validation_errors


      
    ) dbt_internal_test
2022-01-08 16:27:48.976246 (Thread-4): Block "" send time: 0.000025
2022-01-08 16:27:49.012143 (Thread-2): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:49.012513 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select *
from db.customer
where C_CUSTKEY is null



      
    ) dbt_internal_test
2022-01-08 16:27:49.012804 (Thread-2): Block "" send time: 0.000032
2022-01-08 16:27:49.013080 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:49.013352 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      

select *
from (
    select
        
        
      count() as filler_column

    from db.q4_2

    having count() = 0

) validation_errors


      
    ) dbt_internal_test
2022-01-08 16:27:49.013625 (Thread-1): Block "" send time: 0.000024
2022-01-08 16:27:49.017626 (Thread-3): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:49.018460 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e"} */
select
      coalesce(diff_count, 0) as failures,
      case when coalesce(diff_count, 0) != 0
        then 'true' else 'false' end as should_warn,
      case when coalesce(diff_count, 0) != 0
        then 'true' else 'false' end as should_error
    from (
      

with a as (

    select count(*) as count_a from db.lineorder_flat

),
b as (

    select count(*) as count_b from db.lineorder

),
final as (

    select
        count_a,
        count_b,
        abs(count_a - count_b) as diff_count
    from a
    cross join b

)

select * from final


      
    ) dbt_internal_test
2022-01-08 16:27:49.019291 (Thread-3): Block "" send time: 0.000076
2022-01-08 16:27:49.085264 (Thread-4): SQL status: OK in 0.56 seconds
2022-01-08 16:27:49.089194 (Thread-4): finished collecting timing info
2022-01-08 16:27:49.089942 (Thread-4): On test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1: No close available on handle
2022-01-08 16:27:49.091273 (Thread-4): 19:27:49 | 5 of 16 PASS dbt_utils_at_least_one_q3_3_............................ [PASS in 0.63s]
2022-01-08 16:27:49.092076 (Thread-4): Finished running node test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1
2022-01-08 16:27:49.092864 (Thread-4): Began running node test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3
2022-01-08 16:27:49.093938 (Thread-4): 19:27:49 | 9 of 16 START test not_null_part_P_PARTKEY........................... [RUN]
2022-01-08 16:27:49.095074 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3".
2022-01-08 16:27:49.095834 (Thread-4): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32930), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:49.096565 (Thread-4): Compiling test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3
2022-01-08 16:27:49.107878 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3"
2022-01-08 16:27:49.108754 (Thread-4): finished collecting timing info
2022-01-08 16:27:49.113591 (Thread-4): Writing runtime SQL for node "test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3"
2022-01-08 16:27:49.114502 (Thread-4): Opening a new connection, currently in state closed
2022-01-08 16:27:49.115068 (Thread-4): On test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select *
from db.part
where P_PARTKEY is null



      
    ) dbt_internal_test...
2022-01-08 16:27:49.115587 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:49.115954 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:49.120074 (Thread-2): SQL status: OK in 0.57 seconds
2022-01-08 16:27:49.121482 (Thread-2): finished collecting timing info
2022-01-08 16:27:49.121736 (Thread-2): On test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753: No close available on handle
2022-01-08 16:27:49.122141 (Thread-2): 19:27:49 | 8 of 16 PASS not_null_customer_C_CUSTKEY............................. [PASS in 0.60s]
2022-01-08 16:27:49.122659 (Thread-2): Finished running node test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753
2022-01-08 16:27:49.122923 (Thread-2): Began running node test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e
2022-01-08 16:27:49.123154 (Thread-1): SQL status: OK in 0.57 seconds
2022-01-08 16:27:49.123479 (Thread-2): 19:27:49 | 10 of 16 START test not_null_supplier_S_SUPPKEY...................... [RUN]
2022-01-08 16:27:49.125020 (Thread-1): finished collecting timing info
2022-01-08 16:27:49.125520 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e".
2022-01-08 16:27:49.125734 (Thread-1): On test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00: No close available on handle
2022-01-08 16:27:49.126202 (Thread-1): 19:27:49 | 6 of 16 PASS dbt_utils_at_least_one_q4_2_............................ [PASS in 0.61s]
2022-01-08 16:27:49.126389 (Thread-2): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32936), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:49.126597 (Thread-1): Finished running node test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00
2022-01-08 16:27:49.126812 (Thread-1): Began running node test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad
2022-01-08 16:27:49.127029 (Thread-2): Compiling test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e
2022-01-08 16:27:49.127279 (Thread-1): 19:27:49 | 11 of 16 START test relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_ [RUN]
2022-01-08 16:27:49.130821 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e"
2022-01-08 16:27:49.131370 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad".
2022-01-08 16:27:49.131787 (Thread-1): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32932), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:49.132022 (Thread-3): SQL status: OK in 0.58 seconds
2022-01-08 16:27:49.132226 (Thread-1): Compiling test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad
2022-01-08 16:27:49.133363 (Thread-3): finished collecting timing info
2022-01-08 16:27:49.133549 (Thread-2): finished collecting timing info
2022-01-08 16:27:49.144078 (Thread-3): On test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e: No close available on handle
2022-01-08 16:27:49.144538 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad"
2022-01-08 16:27:49.146920 (Thread-2): Writing runtime SQL for node "test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e"
2022-01-08 16:27:49.147354 (Thread-3): 19:27:49 | 7 of 16 PASS dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.. [PASS in 0.63s]
2022-01-08 16:27:49.147765 (Thread-3): Finished running node test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e
2022-01-08 16:27:49.147990 (Thread-3): Began running node test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a
2022-01-08 16:27:49.148278 (Thread-3): 19:27:49 | 12 of 16 START test relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_ [RUN]
2022-01-08 16:27:49.148494 (Thread-1): finished collecting timing info
2022-01-08 16:27:49.148873 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a".
2022-01-08 16:27:49.149066 (Thread-2): Opening a new connection, currently in state closed
2022-01-08 16:27:49.150865 (Thread-1): Writing runtime SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad"
2022-01-08 16:27:49.151157 (Thread-2): On test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select *
from db.supplier
where S_SUPPKEY is null



      
    ) dbt_internal_test...
2022-01-08 16:27:49.151316 (Thread-3): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32934), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:49.151625 (Thread-2): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:49.151881 (Thread-2): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:49.152063 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 16:27:49.152218 (Thread-3): Compiling test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a
2022-01-08 16:27:49.152449 (Thread-1): On test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

    

with child as (
    select LO_CUSTKEY as from_field
    from db.lineorder
    where LO_CUSTKEY is not null
),

parent as (
    select C_CUSTKEY as to_field
    from db.customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


    settings join_use_nulls = 1



      
    ) dbt_internal_test...
2022-01-08 16:27:49.156596 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a"
2022-01-08 16:27:49.157181 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:49.157601 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:49.157965 (Thread-3): finished collecting timing info
2022-01-08 16:27:49.159938 (Thread-3): Writing runtime SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a"
2022-01-08 16:27:49.160546 (Thread-3): Opening a new connection, currently in state closed
2022-01-08 16:27:49.160788 (Thread-3): On test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

    

with child as (
    select LO_PARTKEY as from_field
    from db.lineorder
    where LO_PARTKEY is not null
),

parent as (
    select P_PARTKEY as to_field
    from db.part
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


    settings join_use_nulls = 1



      
    ) dbt_internal_test...
2022-01-08 16:27:49.161120 (Thread-3): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:49.161394 (Thread-3): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:49.567432 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:49.568511 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select *
from db.part
where P_PARTKEY is null



      
    ) dbt_internal_test
2022-01-08 16:27:49.569521 (Thread-4): Block "" send time: 0.000099
2022-01-08 16:27:49.570618 (Thread-2): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:49.571564 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select *
from db.supplier
where S_SUPPKEY is null



      
    ) dbt_internal_test
2022-01-08 16:27:49.572565 (Thread-2): Block "" send time: 0.000098
2022-01-08 16:27:49.574004 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:49.575222 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

    

with child as (
    select LO_CUSTKEY as from_field
    from db.lineorder
    where LO_CUSTKEY is not null
),

parent as (
    select C_CUSTKEY as to_field
    from db.customer
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


    settings join_use_nulls = 1



      
    ) dbt_internal_test
2022-01-08 16:27:49.576164 (Thread-1): Block "" send time: 0.000087
2022-01-08 16:27:49.583679 (Thread-3): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:49.584740 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

    

with child as (
    select LO_PARTKEY as from_field
    from db.lineorder
    where LO_PARTKEY is not null
),

parent as (
    select P_PARTKEY as to_field
    from db.part
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


    settings join_use_nulls = 1



      
    ) dbt_internal_test
2022-01-08 16:27:49.585658 (Thread-3): Block "" send time: 0.000089
2022-01-08 16:27:49.673965 (Thread-2): SQL status: OK in 0.52 seconds
2022-01-08 16:27:49.678262 (Thread-2): finished collecting timing info
2022-01-08 16:27:49.679090 (Thread-2): On test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e: No close available on handle
2022-01-08 16:27:49.681036 (Thread-2): 19:27:49 | 10 of 16 PASS not_null_supplier_S_SUPPKEY............................ [PASS in 0.56s]
2022-01-08 16:27:49.681996 (Thread-4): SQL status: OK in 0.57 seconds
2022-01-08 16:27:49.682941 (Thread-2): Finished running node test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e
2022-01-08 16:27:49.687088 (Thread-4): finished collecting timing info
2022-01-08 16:27:49.688369 (Thread-2): Began running node test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e
2022-01-08 16:27:49.689534 (Thread-4): On test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3: No close available on handle
2022-01-08 16:27:49.690476 (Thread-2): 19:27:49 | 13 of 16 START test relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_ [RUN]
2022-01-08 16:27:49.691867 (Thread-4): 19:27:49 | 9 of 16 PASS not_null_part_P_PARTKEY................................. [PASS in 0.60s]
2022-01-08 16:27:49.693300 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e".
2022-01-08 16:27:49.694220 (Thread-4): Finished running node test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3
2022-01-08 16:27:49.695106 (Thread-2): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32940), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:49.696394 (Thread-4): Began running node test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30
2022-01-08 16:27:49.697717 (Thread-2): Compiling test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e
2022-01-08 16:27:49.698817 (Thread-4): 19:27:49 | 14 of 16 START test unique_customer_C_CUSTKEY........................ [RUN]
2022-01-08 16:27:49.716675 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30".
2022-01-08 16:27:49.721196 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e"
2022-01-08 16:27:49.721846 (Thread-4): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32938), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:49.722518 (Thread-4): Compiling test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30
2022-01-08 16:27:49.732309 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30"
2022-01-08 16:27:49.732708 (Thread-2): finished collecting timing info
2022-01-08 16:27:49.736437 (Thread-2): Writing runtime SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e"
2022-01-08 16:27:49.737027 (Thread-4): finished collecting timing info
2022-01-08 16:27:49.740093 (Thread-4): Writing runtime SQL for node "test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30"
2022-01-08 16:27:49.740337 (Thread-2): Opening a new connection, currently in state closed
2022-01-08 16:27:49.740773 (Thread-2): On test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

    

with child as (
    select LO_SUPPKEY as from_field
    from db.lineorder
    where LO_SUPPKEY is not null
),

parent as (
    select S_SUPPKEY as to_field
    from db.supplier
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


    settings join_use_nulls = 1



      
    ) dbt_internal_test...
2022-01-08 16:27:49.741102 (Thread-2): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:49.741376 (Thread-2): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:49.741779 (Thread-4): Opening a new connection, currently in state closed
2022-01-08 16:27:49.742123 (Thread-4): On test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    C_CUSTKEY as unique_field,
    count(*) as n_records

from db.customer
where C_CUSTKEY is not null
group by C_CUSTKEY
having count(*) > 1



      
    ) dbt_internal_test...
2022-01-08 16:27:49.742354 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:49.742544 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:50.252255 (Thread-2): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:50.253341 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

    

with child as (
    select LO_SUPPKEY as from_field
    from db.lineorder
    where LO_SUPPKEY is not null
),

parent as (
    select S_SUPPKEY as to_field
    from db.supplier
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


    settings join_use_nulls = 1



      
    ) dbt_internal_test
2022-01-08 16:27:50.254292 (Thread-2): Block "" send time: 0.000092
2022-01-08 16:27:50.262380 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:50.263435 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    C_CUSTKEY as unique_field,
    count(*) as n_records

from db.customer
where C_CUSTKEY is not null
group by C_CUSTKEY
having count(*) > 1



      
    ) dbt_internal_test
2022-01-08 16:27:50.264448 (Thread-4): Block "" send time: 0.000093
2022-01-08 16:27:50.543666 (Thread-4): SQL status: OK in 0.80 seconds
2022-01-08 16:27:50.547961 (Thread-4): finished collecting timing info
2022-01-08 16:27:50.548754 (Thread-4): On test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30: No close available on handle
2022-01-08 16:27:50.549973 (Thread-4): 19:27:50 | 14 of 16 PASS unique_customer_C_CUSTKEY.............................. [PASS in 0.83s]
2022-01-08 16:27:50.550699 (Thread-4): Finished running node test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30
2022-01-08 16:27:50.551418 (Thread-4): Began running node test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86
2022-01-08 16:27:50.552631 (Thread-4): 19:27:50 | 15 of 16 START test unique_part_P_PARTKEY............................ [RUN]
2022-01-08 16:27:50.553805 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86".
2022-01-08 16:27:50.554712 (Thread-4): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32948), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:50.555433 (Thread-4): Compiling test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86
2022-01-08 16:27:50.569631 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86"
2022-01-08 16:27:50.570268 (Thread-4): finished collecting timing info
2022-01-08 16:27:50.573703 (Thread-4): Writing runtime SQL for node "test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86"
2022-01-08 16:27:50.574438 (Thread-4): Opening a new connection, currently in state closed
2022-01-08 16:27:50.574882 (Thread-4): On test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    P_PARTKEY as unique_field,
    count(*) as n_records

from db.part
where P_PARTKEY is not null
group by P_PARTKEY
having count(*) > 1



      
    ) dbt_internal_test...
2022-01-08 16:27:50.575324 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:50.575687 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:51.073300 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:51.074622 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    P_PARTKEY as unique_field,
    count(*) as n_records

from db.part
where P_PARTKEY is not null
group by P_PARTKEY
having count(*) > 1



      
    ) dbt_internal_test
2022-01-08 16:27:51.075691 (Thread-4): Block "" send time: 0.000092
2022-01-08 16:27:51.513707 (Thread-4): SQL status: OK in 0.94 seconds
2022-01-08 16:27:51.515292 (Thread-4): finished collecting timing info
2022-01-08 16:27:51.515566 (Thread-4): On test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86: No close available on handle
2022-01-08 16:27:51.515992 (Thread-4): 19:27:51 | 15 of 16 PASS unique_part_P_PARTKEY.................................. [PASS in 0.96s]
2022-01-08 16:27:51.516236 (Thread-4): Finished running node test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86
2022-01-08 16:27:51.516474 (Thread-4): Began running node test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac
2022-01-08 16:27:51.516717 (Thread-4): 19:27:51 | 16 of 16 START test unique_supplier_S_SUPPKEY........................ [RUN]
2022-01-08 16:27:51.517229 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac".
2022-01-08 16:27:51.517521 (Thread-4): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32950), raddr=('51.250.28.188', 9440)>
2022-01-08 16:27:51.517759 (Thread-4): Compiling test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac
2022-01-08 16:27:51.521916 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac"
2022-01-08 16:27:51.522533 (Thread-4): finished collecting timing info
2022-01-08 16:27:51.526233 (Thread-4): Writing runtime SQL for node "test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac"
2022-01-08 16:27:51.526791 (Thread-4): Opening a new connection, currently in state closed
2022-01-08 16:27:51.527056 (Thread-4): On test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    S_SUPPKEY as unique_field,
    count(*) as n_records

from db.supplier
where S_SUPPKEY is not null
group by S_SUPPKEY
having count(*) > 1



      
    ) dbt_internal_test...
2022-01-08 16:27:51.527330 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:27:51.527562 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:27:51.993776 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:27:51.994836 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    

select
    S_SUPPKEY as unique_field,
    count(*) as n_records

from db.supplier
where S_SUPPKEY is not null
group by S_SUPPKEY
having count(*) > 1



      
    ) dbt_internal_test
2022-01-08 16:27:51.995856 (Thread-4): Block "" send time: 0.000088
2022-01-08 16:27:52.119289 (Thread-4): SQL status: OK in 0.59 seconds
2022-01-08 16:27:52.124167 (Thread-4): finished collecting timing info
2022-01-08 16:27:52.124941 (Thread-4): On test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac: No close available on handle
2022-01-08 16:27:52.126133 (Thread-4): 19:27:52 | 16 of 16 PASS unique_supplier_S_SUPPKEY.............................. [PASS in 0.61s]
2022-01-08 16:27:52.126847 (Thread-4): Finished running node test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac
2022-01-08 16:28:08.231945 (Thread-1): SQL status: OK in 19.07 seconds
2022-01-08 16:28:08.234089 (Thread-1): finished collecting timing info
2022-01-08 16:28:08.234540 (Thread-1): On test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad: No close available on handle
2022-01-08 16:28:08.235209 (Thread-1): 19:28:08 | 11 of 16 PASS relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_ [PASS in 19.10s]
2022-01-08 16:28:08.235607 (Thread-1): Finished running node test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad
2022-01-08 16:28:12.060052 (Thread-2): SQL status: OK in 22.32 seconds
2022-01-08 16:28:12.069961 (Thread-2): finished collecting timing info
2022-01-08 16:28:12.070292 (Thread-2): On test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e: No close available on handle
2022-01-08 16:28:12.070713 (Thread-2): 19:28:12 | 13 of 16 PASS relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_ [PASS in 22.38s]
2022-01-08 16:28:12.070959 (Thread-2): Finished running node test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e
2022-01-08 16:28:17.182128 (Thread-3): SQL status: OK in 28.02 seconds
2022-01-08 16:28:17.184792 (Thread-3): finished collecting timing info
2022-01-08 16:28:17.185042 (Thread-3): On test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a: No close available on handle
2022-01-08 16:28:17.185398 (Thread-3): 19:28:17 | 12 of 16 PASS relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_ [PASS in 28.04s]
2022-01-08 16:28:17.185605 (Thread-3): Finished running node test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a
2022-01-08 16:28:17.186799 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 16:28:17.187161 (MainThread): 19:28:17 | 
2022-01-08 16:28:17.187368 (MainThread): 19:28:17 | Finished running 16 tests in 30.26s.
2022-01-08 16:28:17.187555 (MainThread): Connection 'master' was properly closed.
2022-01-08 16:28:17.187713 (MainThread): Connection 'test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad' was properly closed.
2022-01-08 16:28:17.187880 (MainThread): Connection 'test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e' was properly closed.
2022-01-08 16:28:17.188029 (MainThread): Connection 'test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a' was properly closed.
2022-01-08 16:28:17.188175 (MainThread): Connection 'test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac' was properly closed.
2022-01-08 16:28:17.188385 (MainThread): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32942), raddr=('51.250.28.188', 9440)>
2022-01-08 16:28:17.188607 (MainThread): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32946), raddr=('51.250.28.188', 9440)>
2022-01-08 16:28:17.188804 (MainThread): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32944), raddr=('51.250.28.188', 9440)>
2022-01-08 16:28:17.190376 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 32952), raddr=('51.250.28.188', 9440)>
2022-01-08 16:28:17.198042 (MainThread): 
2022-01-08 16:28:17.198284 (MainThread): Completed successfully
2022-01-08 16:28:17.198479 (MainThread): 
Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
2022-01-08 16:28:17.198716 (MainThread): Flushing usage events
2022-01-08 16:36:05.903744 (MainThread): Running with dbt=0.21.1
2022-01-08 16:36:06.071099 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2022-01-08 16:36:06.071745 (MainThread): Tracking: do not track
2022-01-08 16:36:06.122443 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-01-08 16:36:06.122730 (MainThread): Partial parsing enabled, no changes found, skipping parsing
2022-01-08 16:36:06.161881 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 16:36:06.162449 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 16:36:06.164223 (MainThread): 
2022-01-08 16:36:06.164575 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 16:36:06.165574 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 16:36:06.173743 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 16:36:06.173999 (ThreadPoolExecutor-0_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 16:36:06.174256 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:36:06.174440 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:36:06.723044 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:36:06.724418 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 16:36:06.725355 (ThreadPoolExecutor-0_0): Block "" send time: 0.000107
2022-01-08 16:36:06.925231 (ThreadPoolExecutor-0_0): SQL status: OK in 0.75 seconds
2022-01-08 16:36:06.929294 (ThreadPoolExecutor-0_0): On list_None_db: No close available on handle
2022-01-08 16:36:06.930358 (MainThread): 19:36:06 | Concurrency: 4 threads (target='dev')
2022-01-08 16:36:06.930608 (MainThread): 19:36:06 | 
2022-01-08 16:36:06.933246 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 16:36:06.933572 (Thread-2): Began running node model.clickhouse_starschema.lineorder
2022-01-08 16:36:06.934068 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 16:36:06.934356 (Thread-3): Began running node model.clickhouse_starschema.part
2022-01-08 16:36:06.934867 (Thread-2): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder".
2022-01-08 16:36:06.935155 (Thread-4): Began running node model.clickhouse_starschema.supplier
2022-01-08 16:36:06.935522 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33498), raddr=('51.250.28.188', 9440)>
2022-01-08 16:36:06.935991 (Thread-3): Acquiring new clickhouse connection "model.clickhouse_starschema.part".
2022-01-08 16:36:06.936335 (Thread-2): Compiling model.clickhouse_starschema.lineorder
2022-01-08 16:36:06.936838 (Thread-4): Acquiring new clickhouse connection "model.clickhouse_starschema.supplier".
2022-01-08 16:36:06.937449 (Thread-3): Compiling model.clickhouse_starschema.part
2022-01-08 16:36:06.937726 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 16:36:06.953958 (Thread-4): Compiling model.clickhouse_starschema.supplier
2022-01-08 16:36:06.994241 (Thread-2): Opening a new connection, currently in state init
2022-01-08 16:36:06.998692 (Thread-4): Opening a new connection, currently in state init
2022-01-08 16:36:06.999050 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 16:36:06.999311 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:36:06.999743 (Thread-3): Opening a new connection, currently in state init
2022-01-08 16:36:06.999992 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:36:07.000240 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:36:07.000513 (Thread-2): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:36:07.000745 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:36:07.001118 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:36:07.001428 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:36:07.001641 (Thread-2): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:36:07.001881 (Thread-3): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:36:07.002487 (Thread-3): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:36:07.002772 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:36:07.003071 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:36:07.546459 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:36:07.547416 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:36:07.548280 (Thread-1): Block "" send time: 0.000083
2022-01-08 16:36:07.549294 (Thread-2): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:36:07.550151 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:36:07.550954 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:36:07.551982 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:36:07.552862 (Thread-2): Block "" send time: 0.001007
2022-01-08 16:36:07.553897 (Thread-4): Block "" send time: 0.000302
2022-01-08 16:36:07.555149 (Thread-3): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:36:07.556047 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:36:07.556923 (Thread-3): Block "" send time: 0.000082
2022-01-08 16:36:07.653677 (Thread-1): SQL status: OK in 0.65 seconds
2022-01-08 16:36:07.657873 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.658628 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.659227 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.659815 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.660394 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.661564 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.662415 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.663827 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.664756 (Thread-4): SQL status: OK in 0.66 seconds
2022-01-08 16:36:07.666303 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 16:36:07.667596 (Thread-3): SQL status: OK in 0.67 seconds
2022-01-08 16:36:07.672237 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.673073 (Thread-2): SQL status: OK in 0.67 seconds
2022-01-08 16:36:07.677188 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.678098 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.682371 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.683128 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.683914 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.684700 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.685561 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.686397 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.687236 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.688133 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.688984 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.689744 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 16:36:07.690538 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.691313 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.692093 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.693340 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 16:36:07.694141 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.694936 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.695707 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.697567 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.698246 (Thread-1): Began running node test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122
2022-01-08 16:36:07.699117 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.699905 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.700664 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.701808 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122".
2022-01-08 16:36:07.703104 (Thread-4): Writing injected SQL for node "model.clickhouse_starschema.supplier"
2022-01-08 16:36:07.703929 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.704755 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.705628 (Thread-1): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33506), raddr=('51.250.28.188', 9440)>
2022-01-08 16:36:07.706656 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.707441 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.708388 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.709143 (Thread-1): Compiling test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122
2022-01-08 16:36:07.709859 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.711091 (Thread-3): Writing injected SQL for node "model.clickhouse_starschema.part"
2022-01-08 16:36:07.711877 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.723146 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.749722 (Thread-4): On model.clickhouse_starschema.supplier: No close available on handle
2022-01-08 16:36:07.750079 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122"
2022-01-08 16:36:07.750520 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.750816 (Thread-3): finished collecting timing info
2022-01-08 16:36:07.751508 (Thread-4): Finished running node model.clickhouse_starschema.supplier
2022-01-08 16:36:07.751945 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.752344 (Thread-3): finished collecting timing info
2022-01-08 16:36:07.752606 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.752939 (Thread-4): Began running node test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023
2022-01-08 16:36:07.753463 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.753768 (Thread-3): On model.clickhouse_starschema.part: No close available on handle
2022-01-08 16:36:07.754076 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.754529 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023".
2022-01-08 16:36:07.754791 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.755192 (Thread-3): Finished running node model.clickhouse_starschema.part
2022-01-08 16:36:07.755665 (Thread-1): Finished running node test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122
2022-01-08 16:36:07.756024 (Thread-4): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33500), raddr=('51.250.28.188', 9440)>
2022-01-08 16:36:07.756281 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.756577 (Thread-3): Began running node test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753
2022-01-08 16:36:07.757092 (Thread-1): Began running node test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30
2022-01-08 16:36:07.757538 (Thread-4): Compiling test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023
2022-01-08 16:36:07.757741 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.758079 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753".
2022-01-08 16:36:07.758461 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30".
2022-01-08 16:36:07.765457 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023"
2022-01-08 16:36:07.765669 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:07.765944 (Thread-3): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33504), raddr=('51.250.28.188', 9440)>
2022-01-08 16:36:07.766187 (Thread-1): Compiling test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30
2022-01-08 16:36:07.766659 (Thread-2): Writing injected SQL for node "model.clickhouse_starschema.lineorder"
2022-01-08 16:36:07.766943 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.767133 (Thread-3): Compiling test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753
2022-01-08 16:36:07.773288 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30"
2022-01-08 16:36:07.773625 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.779393 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753"
2022-01-08 16:36:07.779909 (Thread-4): Finished running node test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023
2022-01-08 16:36:07.780097 (Thread-2): finished collecting timing info
2022-01-08 16:36:07.780464 (Thread-4): Began running node test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf
2022-01-08 16:36:07.781072 (Thread-2): finished collecting timing info
2022-01-08 16:36:07.781302 (Thread-3): finished collecting timing info
2022-01-08 16:36:07.781501 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.781841 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf".
2022-01-08 16:36:07.782066 (Thread-2): On model.clickhouse_starschema.lineorder: No close available on handle
2022-01-08 16:36:07.782259 (Thread-3): finished collecting timing info
2022-01-08 16:36:07.782462 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.782650 (Thread-4): Compiling test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf
2022-01-08 16:36:07.782942 (Thread-2): Finished running node model.clickhouse_starschema.lineorder
2022-01-08 16:36:07.783248 (Thread-3): Finished running node test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753
2022-01-08 16:36:07.783538 (Thread-1): Finished running node test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30
2022-01-08 16:36:07.788263 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf"
2022-01-08 16:36:07.788466 (Thread-2): Began running node test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e
2022-01-08 16:36:07.788924 (Thread-3): Began running node test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac
2022-01-08 16:36:07.789212 (Thread-1): Began running node test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3
2022-01-08 16:36:07.789650 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e".
2022-01-08 16:36:07.789957 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac".
2022-01-08 16:36:07.790236 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3".
2022-01-08 16:36:07.790407 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.790615 (Thread-2): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33502), raddr=('51.250.28.188', 9440)>
2022-01-08 16:36:07.790766 (Thread-3): Compiling test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac
2022-01-08 16:36:07.790922 (Thread-1): Compiling test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3
2022-01-08 16:36:07.791096 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.791292 (Thread-2): Compiling test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e
2022-01-08 16:36:07.794072 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac"
2022-01-08 16:36:07.796760 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3"
2022-01-08 16:36:07.797117 (Thread-4): Finished running node test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf
2022-01-08 16:36:07.799822 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e"
2022-01-08 16:36:07.800338 (Thread-4): Began running node test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86
2022-01-08 16:36:07.800569 (Thread-3): finished collecting timing info
2022-01-08 16:36:07.800842 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.801216 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86".
2022-01-08 16:36:07.801433 (Thread-3): finished collecting timing info
2022-01-08 16:36:07.801620 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.801785 (Thread-2): finished collecting timing info
2022-01-08 16:36:07.801943 (Thread-4): Compiling test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86
2022-01-08 16:36:07.802238 (Thread-3): Finished running node test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac
2022-01-08 16:36:07.802527 (Thread-1): Finished running node test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3
2022-01-08 16:36:07.802712 (Thread-2): finished collecting timing info
2022-01-08 16:36:07.805333 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86"
2022-01-08 16:36:07.805529 (Thread-3): Began running node model.clickhouse_starschema.lineorder_flat
2022-01-08 16:36:07.805781 (Thread-1): Began running node test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad
2022-01-08 16:36:07.806109 (Thread-2): Finished running node test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e
2022-01-08 16:36:07.806435 (Thread-3): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder_flat".
2022-01-08 16:36:07.806718 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad".
2022-01-08 16:36:07.806912 (Thread-2): Began running node test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a
2022-01-08 16:36:07.807129 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.807282 (Thread-3): Compiling model.clickhouse_starschema.lineorder_flat
2022-01-08 16:36:07.807441 (Thread-1): Compiling test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad
2022-01-08 16:36:07.807697 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a".
2022-01-08 16:36:07.807891 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.814086 (Thread-3): Opening a new connection, currently in state closed
2022-01-08 16:36:07.821013 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad"
2022-01-08 16:36:07.821212 (Thread-2): Compiling test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a
2022-01-08 16:36:07.821514 (Thread-4): Finished running node test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86
2022-01-08 16:36:07.821748 (Thread-3): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'lineorder'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:36:07.825249 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a"
2022-01-08 16:36:07.825440 (Thread-4): Began running node test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e
2022-01-08 16:36:07.825791 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.826058 (Thread-3): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:36:07.826418 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e".
2022-01-08 16:36:07.826610 (Thread-1): finished collecting timing info
2022-01-08 16:36:07.826820 (Thread-3): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:36:07.826997 (Thread-4): Compiling test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e
2022-01-08 16:36:07.827151 (Thread-2): finished collecting timing info
2022-01-08 16:36:07.827419 (Thread-1): Finished running node test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad
2022-01-08 16:36:07.832390 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e"
2022-01-08 16:36:07.832591 (Thread-2): finished collecting timing info
2022-01-08 16:36:07.833128 (Thread-2): Finished running node test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a
2022-01-08 16:36:07.833473 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.833645 (Thread-4): finished collecting timing info
2022-01-08 16:36:07.833907 (Thread-4): Finished running node test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e
2022-01-08 16:36:08.229341 (Thread-3): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:36:08.230362 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'lineorder'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:36:08.231248 (Thread-3): Block "" send time: 0.000086
2022-01-08 16:36:08.333073 (Thread-3): SQL status: OK in 0.51 seconds
2022-01-08 16:36:08.337866 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.338674 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.339270 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.339866 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.340467 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.341021 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.341577 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.342122 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.342660 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.343203 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.343758 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.344346 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.344896 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.345444 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.345986 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.346521 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.347055 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.353580 (Thread-3): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:36:08.453393 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:36:08.453772 (Thread-3): Block "" send time: 0.000032
2022-01-08 16:36:08.562983 (Thread-3): SQL status: OK in 0.21 seconds
2022-01-08 16:36:08.566932 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.567591 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.568243 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.568819 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.569389 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.569948 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.570555 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.571569 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.577551 (Thread-3): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'supplier'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:36:08.735618 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'supplier'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:36:08.736738 (Thread-3): Block "" send time: 0.000088
2022-01-08 16:36:08.838784 (Thread-3): SQL status: OK in 0.26 seconds
2022-01-08 16:36:08.843079 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.843307 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.843509 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.843704 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.843906 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.844098 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.844289 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:08.846550 (Thread-3): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'part'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:36:08.945737 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'part'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:36:08.946842 (Thread-3): Block "" send time: 0.000095
2022-01-08 16:36:09.075738 (Thread-3): SQL status: OK in 0.23 seconds
2022-01-08 16:36:09.080197 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:09.080935 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:09.081581 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:09.082202 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:09.082811 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:09.083413 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:09.084047 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:09.084593 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:09.085138 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:36:09.086952 (Thread-3): Writing injected SQL for node "model.clickhouse_starschema.lineorder_flat"
2022-01-08 16:36:09.088069 (Thread-3): finished collecting timing info
2022-01-08 16:36:09.088780 (Thread-3): finished collecting timing info
2022-01-08 16:36:09.089441 (Thread-3): On model.clickhouse_starschema.lineorder_flat: No close available on handle
2022-01-08 16:36:09.090513 (Thread-3): Finished running node model.clickhouse_starschema.lineorder_flat
2022-01-08 16:36:09.092404 (Thread-1): Began running node model.clickhouse_starschema.q2_1
2022-01-08 16:36:09.093797 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.q2_1".
2022-01-08 16:36:09.094508 (Thread-2): Began running node model.clickhouse_starschema.q3_3
2022-01-08 16:36:09.095239 (Thread-1): Compiling model.clickhouse_starschema.q2_1
2022-01-08 16:36:09.095930 (Thread-4): Began running node model.clickhouse_starschema.q4_2
2022-01-08 16:36:09.096709 (Thread-3): Began running node test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e
2022-01-08 16:36:09.097854 (Thread-2): Acquiring new clickhouse connection "model.clickhouse_starschema.q3_3".
2022-01-08 16:36:09.110467 (Thread-4): Acquiring new clickhouse connection "model.clickhouse_starschema.q4_2".
2022-01-08 16:36:09.109427 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.q2_1"
2022-01-08 16:36:09.111712 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e".
2022-01-08 16:36:09.112506 (Thread-2): Compiling model.clickhouse_starschema.q3_3
2022-01-08 16:36:09.113241 (Thread-4): Compiling model.clickhouse_starschema.q4_2
2022-01-08 16:36:09.114447 (Thread-3): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33508), raddr=('51.250.28.188', 9440)>
2022-01-08 16:36:09.115234 (Thread-1): finished collecting timing info
2022-01-08 16:36:09.122993 (Thread-4): Writing injected SQL for node "model.clickhouse_starschema.q4_2"
2022-01-08 16:36:09.123627 (Thread-2): Writing injected SQL for node "model.clickhouse_starschema.q3_3"
2022-01-08 16:36:09.123896 (Thread-3): Compiling test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e
2022-01-08 16:36:09.124104 (Thread-1): finished collecting timing info
2022-01-08 16:36:09.130169 (Thread-1): Finished running node model.clickhouse_starschema.q2_1
2022-01-08 16:36:09.132178 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e"
2022-01-08 16:36:09.132631 (Thread-2): finished collecting timing info
2022-01-08 16:36:09.132958 (Thread-2): finished collecting timing info
2022-01-08 16:36:09.133326 (Thread-2): Finished running node model.clickhouse_starschema.q3_3
2022-01-08 16:36:09.133553 (Thread-2): Began running node test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0
2022-01-08 16:36:09.134152 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0".
2022-01-08 16:36:09.134357 (Thread-2): Compiling test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0
2022-01-08 16:36:09.139678 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0"
2022-01-08 16:36:09.140059 (Thread-4): finished collecting timing info
2022-01-08 16:36:09.140264 (Thread-4): finished collecting timing info
2022-01-08 16:36:09.140562 (Thread-4): Finished running node model.clickhouse_starschema.q4_2
2022-01-08 16:36:09.140802 (Thread-2): finished collecting timing info
2022-01-08 16:36:09.141084 (Thread-2): finished collecting timing info
2022-01-08 16:36:09.141288 (Thread-3): finished collecting timing info
2022-01-08 16:36:09.141676 (Thread-2): Finished running node test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0
2022-01-08 16:36:09.141872 (Thread-3): finished collecting timing info
2022-01-08 16:36:09.142058 (Thread-2): Began running node test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1
2022-01-08 16:36:09.142344 (Thread-1): Began running node test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00
2022-01-08 16:36:09.142630 (Thread-3): Finished running node test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e
2022-01-08 16:36:09.142905 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1".
2022-01-08 16:36:09.143212 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00".
2022-01-08 16:36:09.143478 (Thread-2): Compiling test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1
2022-01-08 16:36:09.143654 (Thread-1): Compiling test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00
2022-01-08 16:36:09.146322 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1"
2022-01-08 16:36:09.149011 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00"
2022-01-08 16:36:09.149424 (Thread-2): finished collecting timing info
2022-01-08 16:36:09.149616 (Thread-2): finished collecting timing info
2022-01-08 16:36:09.149906 (Thread-2): Finished running node test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1
2022-01-08 16:36:09.150131 (Thread-1): finished collecting timing info
2022-01-08 16:36:09.150315 (Thread-1): finished collecting timing info
2022-01-08 16:36:09.150588 (Thread-1): Finished running node test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00
2022-01-08 16:36:09.151353 (MainThread): Connection 'master' was properly closed.
2022-01-08 16:36:09.151510 (MainThread): Connection 'test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00' was properly closed.
2022-01-08 16:36:09.151641 (MainThread): Connection 'test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1' was properly closed.
2022-01-08 16:36:09.151764 (MainThread): Connection 'test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e' was properly closed.
2022-01-08 16:36:09.151900 (MainThread): Connection 'model.clickhouse_starschema.q4_2' was properly closed.
2022-01-08 16:36:09.159745 (MainThread): 19:36:09 | Done.
2022-01-08 16:36:09.161581 (MainThread): Acquiring new clickhouse connection "generate_catalog".
2022-01-08 16:36:09.161799 (MainThread): 19:36:09 | Building catalog
2022-01-08 16:36:09.166683 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "db".
2022-01-08 16:36:09.172345 (ThreadPoolExecutor-1_1): Acquiring new clickhouse connection "db_dbt_test__audit".
2022-01-08 16:36:09.172744 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-01-08 16:36:09.174964 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-01-08 16:36:09.175240 (ThreadPoolExecutor-1_0): On db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "db"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'db')
    order by columns.database, columns.table, columns.position;...
2022-01-08 16:36:09.175454 (ThreadPoolExecutor-1_1): On db_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "db_dbt_test__audit"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'db_dbt_test__audit')
    order by columns.database, columns.table, columns.position;...
2022-01-08 16:36:09.175704 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:36:09.176074 (ThreadPoolExecutor-1_1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:36:09.176357 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:36:09.176614 (ThreadPoolExecutor-1_1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:36:09.586174 (ThreadPoolExecutor-1_1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:36:09.587248 (ThreadPoolExecutor-1_1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "db_dbt_test__audit"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'db_dbt_test__audit')
    order by columns.database, columns.table, columns.position;
2022-01-08 16:36:09.588244 (ThreadPoolExecutor-1_1): Block "" send time: 0.000091
2022-01-08 16:36:09.591595 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:36:09.592670 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "db"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'db')
    order by columns.database, columns.table, columns.position;
2022-01-08 16:36:09.593603 (ThreadPoolExecutor-1_0): Block "" send time: 0.000092
2022-01-08 16:36:09.692726 (ThreadPoolExecutor-1_1): SQL status: OK in 0.52 seconds
2022-01-08 16:36:09.698961 (ThreadPoolExecutor-1_1): On db_dbt_test__audit: No close available on handle
2022-01-08 16:36:09.803432 (ThreadPoolExecutor-1_0): SQL status: OK in 0.63 seconds
2022-01-08 16:36:09.844989 (ThreadPoolExecutor-1_0): On db: No close available on handle
2022-01-08 16:36:09.861554 (MainThread): 19:36:09 | Catalog written to /home/iagaraev/Desktop/courses/OTUS/DHW/ht2_dbt/clickhouse_starschema/target/catalog.json
2022-01-08 16:36:09.861886 (MainThread): Flushing usage events
2022-01-08 16:36:09.862109 (MainThread): Connection 'generate_catalog' was properly closed.
2022-01-08 16:36:09.862260 (MainThread): Connection 'db' was properly closed.
2022-01-08 16:36:09.862400 (MainThread): Connection 'db_dbt_test__audit' was properly closed.
2022-01-08 16:36:09.862603 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33510), raddr=('51.250.28.188', 9440)>
2022-01-08 16:36:27.117523 (MainThread): Running with dbt=0.21.1
2022-01-08 16:36:27.287063 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2022-01-08 16:36:27.287802 (MainThread): Tracking: do not track
2022-01-08 16:36:27.296343 (MainThread): Serving docs at 0.0.0.0:8080
2022-01-08 16:36:27.296531 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2022-01-08 16:36:27.296673 (MainThread): Press Ctrl+C to exit.


2022-01-08 16:42:57.745280 (MainThread): Flushing usage events
2022-01-08 16:42:57.748110 (MainThread): ctrl-c
2022-01-08 16:43:03.954090 (MainThread): Running with dbt=0.21.1
2022-01-08 16:43:04.121936 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2022-01-08 16:43:04.123911 (MainThread): Tracking: do not track
2022-01-08 16:43:04.175962 (MainThread): Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-01-08 16:43:04.176343 (MainThread): Partial parsing: update schema file: clickhouse_starschema://models/staging/staging.yml
2022-01-08 16:43:04.188301 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder".
2022-01-08 16:43:04.237172 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 16:43:04.241726 (MainThread): Acquiring new clickhouse connection "model.clickhouse_starschema.supplier".
2022-01-08 16:43:04.281539 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.285665 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.289936 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.291531 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.293315 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.301702 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.301968 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.306993 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.307259 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.308730 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.310306 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.315419 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.315684 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:04.333164 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-01-08 16:43:04.333693 (MainThread): Found 8 models, 16 tests, 0 snapshots, 0 analyses, 369 macros, 0 operations, 0 seed files, 4 sources, 0 exposures
2022-01-08 16:43:04.335364 (MainThread): 
2022-01-08 16:43:04.335698 (MainThread): Acquiring new clickhouse connection "master".
2022-01-08 16:43:04.336692 (ThreadPoolExecutor-0_0): Acquiring new clickhouse connection "list_None_db".
2022-01-08 16:43:04.345990 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-01-08 16:43:04.346298 (ThreadPoolExecutor-0_0): On list_None_db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  ...
2022-01-08 16:43:04.346602 (ThreadPoolExecutor-0_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:43:04.346788 (ThreadPoolExecutor-0_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:43:04.834797 (ThreadPoolExecutor-0_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:43:04.836496 (ThreadPoolExecutor-0_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'db'
  
2022-01-08 16:43:04.837458 (ThreadPoolExecutor-0_0): Block "" send time: 0.000119
2022-01-08 16:43:05.033862 (ThreadPoolExecutor-0_0): SQL status: OK in 0.69 seconds
2022-01-08 16:43:05.038365 (ThreadPoolExecutor-0_0): On list_None_db: No close available on handle
2022-01-08 16:43:05.041062 (MainThread): 19:43:05 | Concurrency: 4 threads (target='dev')
2022-01-08 16:43:05.041772 (MainThread): 19:43:05 | 
2022-01-08 16:43:05.048973 (Thread-1): Began running node model.clickhouse_starschema.customer
2022-01-08 16:43:05.049780 (Thread-2): Began running node model.clickhouse_starschema.lineorder
2022-01-08 16:43:05.050982 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.customer".
2022-01-08 16:43:05.051668 (Thread-3): Began running node model.clickhouse_starschema.part
2022-01-08 16:43:05.052523 (Thread-4): Began running node model.clickhouse_starschema.supplier
2022-01-08 16:43:05.053798 (Thread-2): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder".
2022-01-08 16:43:05.054876 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33596), raddr=('51.250.28.188', 9440)>
2022-01-08 16:43:05.056315 (Thread-3): Acquiring new clickhouse connection "model.clickhouse_starschema.part".
2022-01-08 16:43:05.057795 (Thread-4): Acquiring new clickhouse connection "model.clickhouse_starschema.supplier".
2022-01-08 16:43:05.058881 (Thread-2): Compiling model.clickhouse_starschema.lineorder
2022-01-08 16:43:05.059753 (Thread-1): Compiling model.clickhouse_starschema.customer
2022-01-08 16:43:05.060650 (Thread-3): Compiling model.clickhouse_starschema.part
2022-01-08 16:43:05.061420 (Thread-4): Compiling model.clickhouse_starschema.supplier
2022-01-08 16:43:05.103961 (Thread-2): Opening a new connection, currently in state init
2022-01-08 16:43:05.104498 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 16:43:05.109447 (Thread-4): Opening a new connection, currently in state init
2022-01-08 16:43:05.109670 (Thread-2): On model.clickhouse_starschema.lineorder: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:43:05.109876 (Thread-1): On model.clickhouse_starschema.customer: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:43:05.111873 (Thread-3): Opening a new connection, currently in state init
2022-01-08 16:43:05.112110 (Thread-4): On model.clickhouse_starschema.supplier: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:43:05.112338 (Thread-2): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:43:05.112599 (Thread-3): On model.clickhouse_starschema.part: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:43:05.112903 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:43:05.113242 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:43:05.113491 (Thread-2): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:43:05.113727 (Thread-3): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:43:05.114178 (Thread-4): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:43:05.114389 (Thread-4): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:43:05.114590 (Thread-3): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:43:05.656743 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:43:05.657699 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.customer"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:43:05.658543 (Thread-1): Block "" send time: 0.000080
2022-01-08 16:43:05.662990 (Thread-3): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:43:05.663971 (Thread-3): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.part"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:43:05.664863 (Thread-3): Block "" send time: 0.000080
2022-01-08 16:43:05.665759 (Thread-4): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:43:05.666582 (Thread-4): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.supplier"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:43:05.667462 (Thread-4): Block "" send time: 0.000078
2022-01-08 16:43:05.767352 (Thread-1): SQL status: OK in 0.65 seconds
2022-01-08 16:43:05.771658 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.772128 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.772358 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.772562 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.772792 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.773013 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.773229 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.773445 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.773917 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.customer"
2022-01-08 16:43:05.774393 (Thread-3): SQL status: OK in 0.66 seconds
2022-01-08 16:43:05.775928 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.776194 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.776434 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.776667 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.776893 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.777117 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.777338 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.777564 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.777879 (Thread-3): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.778313 (Thread-1): finished collecting timing info
2022-01-08 16:43:05.778734 (Thread-3): Writing injected SQL for node "model.clickhouse_starschema.part"
2022-01-08 16:43:05.779034 (Thread-4): SQL status: OK in 0.67 seconds
2022-01-08 16:43:05.779325 (Thread-1): finished collecting timing info
2022-01-08 16:43:05.780697 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.780939 (Thread-1): On model.clickhouse_starschema.customer: No close available on handle
2022-01-08 16:43:05.781233 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.781645 (Thread-1): Finished running node model.clickhouse_starschema.customer
2022-01-08 16:43:05.781872 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.782136 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.782328 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.782514 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.782710 (Thread-4): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:05.783226 (Thread-4): Writing injected SQL for node "model.clickhouse_starschema.supplier"
2022-01-08 16:43:05.783587 (Thread-3): finished collecting timing info
2022-01-08 16:43:05.783821 (Thread-1): Began running node test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122
2022-01-08 16:43:05.784038 (Thread-3): finished collecting timing info
2022-01-08 16:43:05.784463 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122".
2022-01-08 16:43:05.784689 (Thread-3): On model.clickhouse_starschema.part: No close available on handle
2022-01-08 16:43:05.784861 (Thread-4): finished collecting timing info
2022-01-08 16:43:05.785139 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33598), raddr=('51.250.28.188', 9440)>
2022-01-08 16:43:05.785478 (Thread-3): Finished running node model.clickhouse_starschema.part
2022-01-08 16:43:05.785720 (Thread-4): finished collecting timing info
2022-01-08 16:43:05.785950 (Thread-1): Compiling test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122
2022-01-08 16:43:05.786139 (Thread-3): Began running node test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023
2022-01-08 16:43:05.786372 (Thread-4): On model.clickhouse_starschema.supplier: No close available on handle
2022-01-08 16:43:05.792061 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122"
2022-01-08 16:43:05.792413 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023".
2022-01-08 16:43:05.792771 (Thread-4): Finished running node model.clickhouse_starschema.supplier
2022-01-08 16:43:05.793223 (Thread-4): Began running node test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753
2022-01-08 16:43:05.793540 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753".
2022-01-08 16:43:05.793796 (Thread-1): finished collecting timing info
2022-01-08 16:43:05.794004 (Thread-1): finished collecting timing info
2022-01-08 16:43:05.794312 (Thread-1): Finished running node test.clickhouse_starschema.accepted_values_customer_C_MKTSEGMENT__AUTOMOBILE__BUILDING__FURNITURE__HOUSEHOLD__MACHINERY.c693f56122
2022-01-08 16:43:05.794560 (Thread-3): unclosed <ssl.SSLSocket fd=10, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33604), raddr=('51.250.28.188', 9440)>
2022-01-08 16:43:05.794722 (Thread-4): unclosed <ssl.SSLSocket fd=9, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33602), raddr=('51.250.28.188', 9440)>
2022-01-08 16:43:05.794960 (Thread-1): Began running node test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30
2022-01-08 16:43:05.795251 (Thread-3): Compiling test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023
2022-01-08 16:43:05.795426 (Thread-4): Compiling test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753
2022-01-08 16:43:05.795730 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30".
2022-01-08 16:43:05.801137 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023"
2022-01-08 16:43:05.806252 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753"
2022-01-08 16:43:05.806499 (Thread-1): Compiling test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30
2022-01-08 16:43:05.812163 (Thread-4): finished collecting timing info
2022-01-08 16:43:05.812380 (Thread-4): finished collecting timing info
2022-01-08 16:43:05.812701 (Thread-4): Finished running node test.clickhouse_starschema.not_null_customer_C_CUSTKEY.330cff9753
2022-01-08 16:43:05.812913 (Thread-4): Began running node test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3
2022-01-08 16:43:05.813203 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3".
2022-01-08 16:43:05.813377 (Thread-4): Compiling test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3
2022-01-08 16:43:05.816281 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3"
2022-01-08 16:43:05.816681 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30"
2022-01-08 16:43:05.817008 (Thread-3): finished collecting timing info
2022-01-08 16:43:05.817221 (Thread-3): finished collecting timing info
2022-01-08 16:43:05.817542 (Thread-3): Finished running node test.clickhouse_starschema.accepted_values_customer_C_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.1b8a7fc023
2022-01-08 16:43:05.817738 (Thread-3): Began running node test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86
2022-01-08 16:43:05.818130 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86".
2022-01-08 16:43:05.818367 (Thread-3): Compiling test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86
2022-01-08 16:43:05.821323 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86"
2022-01-08 16:43:05.821545 (Thread-1): finished collecting timing info
2022-01-08 16:43:05.821732 (Thread-4): finished collecting timing info
2022-01-08 16:43:05.821987 (Thread-1): finished collecting timing info
2022-01-08 16:43:05.822213 (Thread-4): finished collecting timing info
2022-01-08 16:43:05.822552 (Thread-1): Finished running node test.clickhouse_starschema.unique_customer_C_CUSTKEY.190e356a30
2022-01-08 16:43:05.822718 (Thread-3): finished collecting timing info
2022-01-08 16:43:05.823038 (Thread-4): Finished running node test.clickhouse_starschema.not_null_part_P_PARTKEY.91135114e3
2022-01-08 16:43:05.823242 (Thread-1): Began running node test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf
2022-01-08 16:43:05.823505 (Thread-3): finished collecting timing info
2022-01-08 16:43:05.823707 (Thread-4): Began running node test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e
2022-01-08 16:43:05.824088 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf".
2022-01-08 16:43:05.824372 (Thread-3): Finished running node test.clickhouse_starschema.unique_part_P_PARTKEY.6fa3792f86
2022-01-08 16:43:05.824745 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e".
2022-01-08 16:43:05.824915 (Thread-1): Compiling test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf
2022-01-08 16:43:05.825082 (Thread-3): Began running node test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac
2022-01-08 16:43:05.825254 (Thread-4): Compiling test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e
2022-01-08 16:43:05.829563 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf"
2022-01-08 16:43:05.829839 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac".
2022-01-08 16:43:05.833437 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e"
2022-01-08 16:43:05.833750 (Thread-3): Compiling test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac
2022-01-08 16:43:05.833933 (Thread-1): finished collecting timing info
2022-01-08 16:43:05.836609 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac"
2022-01-08 16:43:05.836849 (Thread-4): finished collecting timing info
2022-01-08 16:43:05.837080 (Thread-1): finished collecting timing info
2022-01-08 16:43:05.837392 (Thread-4): finished collecting timing info
2022-01-08 16:43:05.837614 (Thread-3): finished collecting timing info
2022-01-08 16:43:05.837932 (Thread-1): Finished running node test.clickhouse_starschema.accepted_values_supplier_S_REGION__AFRICA__MIDDLE_EAST__AMERICA__ASIA__EUROPE.e065e81abf
2022-01-08 16:43:05.838222 (Thread-4): Finished running node test.clickhouse_starschema.not_null_supplier_S_SUPPKEY.0bcddfe00e
2022-01-08 16:43:05.838403 (Thread-3): finished collecting timing info
2022-01-08 16:43:05.838765 (Thread-3): Finished running node test.clickhouse_starschema.unique_supplier_S_SUPPKEY.54af4c5eac
2022-01-08 16:43:06.637179 (Thread-2): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:43:06.638308 (Thread-2): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:43:06.639264 (Thread-2): Block "" send time: 0.000090
2022-01-08 16:43:06.851265 (Thread-2): SQL status: OK in 1.74 seconds
2022-01-08 16:43:06.856023 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.856743 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.857378 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.857991 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.858601 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.859208 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.859834 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.860447 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.861044 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.861655 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.862190 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.862758 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.863312 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.863870 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.864407 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.864933 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.865455 (Thread-2): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:06.866550 (Thread-2): Writing injected SQL for node "model.clickhouse_starschema.lineorder"
2022-01-08 16:43:06.867543 (Thread-2): finished collecting timing info
2022-01-08 16:43:06.868266 (Thread-2): finished collecting timing info
2022-01-08 16:43:06.868887 (Thread-2): On model.clickhouse_starschema.lineorder: No close available on handle
2022-01-08 16:43:06.869908 (Thread-2): Finished running node model.clickhouse_starschema.lineorder
2022-01-08 16:43:06.871942 (Thread-1): Began running node model.clickhouse_starschema.lineorder_flat
2022-01-08 16:43:06.872699 (Thread-4): Began running node test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad
2022-01-08 16:43:06.873814 (Thread-1): Acquiring new clickhouse connection "model.clickhouse_starschema.lineorder_flat".
2022-01-08 16:43:06.874452 (Thread-3): Began running node test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a
2022-01-08 16:43:06.875235 (Thread-2): Began running node test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e
2022-01-08 16:43:06.876393 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad".
2022-01-08 16:43:06.877166 (Thread-1): Compiling model.clickhouse_starschema.lineorder_flat
2022-01-08 16:43:06.878464 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a".
2022-01-08 16:43:06.879696 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e".
2022-01-08 16:43:06.880448 (Thread-4): Compiling test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad
2022-01-08 16:43:06.891556 (Thread-3): Compiling test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a
2022-01-08 16:43:06.893089 (Thread-1): Opening a new connection, currently in state closed
2022-01-08 16:43:06.893406 (Thread-2): unclosed <ssl.SSLSocket fd=8, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33600), raddr=('51.250.28.188', 9440)>
2022-01-08 16:43:06.897650 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad"
2022-01-08 16:43:06.903676 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a"
2022-01-08 16:43:06.904028 (Thread-1): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'lineorder'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:43:06.904313 (Thread-2): Compiling test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e
2022-01-08 16:43:06.904902 (Thread-1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:43:06.909016 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e"
2022-01-08 16:43:06.909337 (Thread-4): finished collecting timing info
2022-01-08 16:43:06.909578 (Thread-3): finished collecting timing info
2022-01-08 16:43:06.909847 (Thread-1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:43:06.910190 (Thread-4): finished collecting timing info
2022-01-08 16:43:06.910389 (Thread-2): finished collecting timing info
2022-01-08 16:43:06.910653 (Thread-3): finished collecting timing info
2022-01-08 16:43:06.911143 (Thread-4): Finished running node test.clickhouse_starschema.relationships_lineorder_LO_CUSTKEY__C_CUSTKEY__ref_customer_.52e2461fad
2022-01-08 16:43:06.911392 (Thread-2): finished collecting timing info
2022-01-08 16:43:06.911851 (Thread-3): Finished running node test.clickhouse_starschema.relationships_lineorder_LO_PARTKEY__P_PARTKEY__ref_part_.8c566c411a
2022-01-08 16:43:06.912344 (Thread-2): Finished running node test.clickhouse_starschema.relationships_lineorder_LO_SUPPKEY__S_SUPPKEY__ref_supplier_.ba3a52fa0e
2022-01-08 16:43:07.358647 (Thread-1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:43:07.359899 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'lineorder'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:43:07.360879 (Thread-1): Block "" send time: 0.000091
2022-01-08 16:43:07.490867 (Thread-1): SQL status: OK in 0.59 seconds
2022-01-08 16:43:07.495559 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.495855 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.496051 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.496241 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.496426 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.496662 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.496853 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.497042 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.497227 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.497410 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.497591 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.497773 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.497958 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.498139 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.498320 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.498499 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.498676 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.500985 (Thread-1): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'customer'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:43:07.601475 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'customer'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:43:07.602544 (Thread-1): Block "" send time: 0.000093
2022-01-08 16:43:07.802100 (Thread-1): SQL status: OK in 0.30 seconds
2022-01-08 16:43:07.806616 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.807324 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.807996 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.808608 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.809198 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.809782 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.810362 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.811024 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:07.821170 (Thread-1): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'supplier'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:43:07.923132 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'supplier'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:43:07.924216 (Thread-1): Block "" send time: 0.000089
2022-01-08 16:43:08.096236 (Thread-1): SQL status: OK in 0.27 seconds
2022-01-08 16:43:08.100406 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.105641 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.106392 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.107019 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.107628 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.108280 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.108868 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.115387 (Thread-1): On model.clickhouse_starschema.lineorder_flat: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'part'
    
      and database = 'db'
    
    order by position
  ...
2022-01-08 16:43:08.257040 (Thread-1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.clickhouse_starschema.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'part'
    
      and database = 'db'
    
    order by position
  
2022-01-08 16:43:08.258132 (Thread-1): Block "" send time: 0.000094
2022-01-08 16:43:08.364976 (Thread-1): SQL status: OK in 0.25 seconds
2022-01-08 16:43:08.369290 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.369763 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.369962 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.370155 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.370392 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.370586 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.370776 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.370967 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.371152 (Thread-1): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-01-08 16:43:08.371659 (Thread-1): Writing injected SQL for node "model.clickhouse_starschema.lineorder_flat"
2022-01-08 16:43:08.372042 (Thread-1): finished collecting timing info
2022-01-08 16:43:08.372285 (Thread-1): finished collecting timing info
2022-01-08 16:43:08.372504 (Thread-1): On model.clickhouse_starschema.lineorder_flat: No close available on handle
2022-01-08 16:43:08.372869 (Thread-1): Finished running node model.clickhouse_starschema.lineorder_flat
2022-01-08 16:43:08.373675 (Thread-4): Began running node model.clickhouse_starschema.q2_1
2022-01-08 16:43:08.374064 (Thread-4): Acquiring new clickhouse connection "model.clickhouse_starschema.q2_1".
2022-01-08 16:43:08.374281 (Thread-4): Compiling model.clickhouse_starschema.q2_1
2022-01-08 16:43:08.377050 (Thread-4): Writing injected SQL for node "model.clickhouse_starschema.q2_1"
2022-01-08 16:43:08.377389 (Thread-3): Began running node model.clickhouse_starschema.q3_3
2022-01-08 16:43:08.377933 (Thread-3): Acquiring new clickhouse connection "model.clickhouse_starschema.q3_3".
2022-01-08 16:43:08.378177 (Thread-3): Compiling model.clickhouse_starschema.q3_3
2022-01-08 16:43:08.380845 (Thread-3): Writing injected SQL for node "model.clickhouse_starschema.q3_3"
2022-01-08 16:43:08.381243 (Thread-2): Began running node model.clickhouse_starschema.q4_2
2022-01-08 16:43:08.381519 (Thread-1): Began running node test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e
2022-01-08 16:43:08.381977 (Thread-2): Acquiring new clickhouse connection "model.clickhouse_starschema.q4_2".
2022-01-08 16:43:08.382288 (Thread-4): finished collecting timing info
2022-01-08 16:43:08.382849 (Thread-1): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e".
2022-01-08 16:43:08.383155 (Thread-3): finished collecting timing info
2022-01-08 16:43:08.383544 (Thread-2): Compiling model.clickhouse_starschema.q4_2
2022-01-08 16:43:08.383901 (Thread-4): finished collecting timing info
2022-01-08 16:43:08.384313 (Thread-1): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33608), raddr=('51.250.28.188', 9440)>
2022-01-08 16:43:08.384644 (Thread-3): finished collecting timing info
2022-01-08 16:43:08.388187 (Thread-2): Writing injected SQL for node "model.clickhouse_starschema.q4_2"
2022-01-08 16:43:08.388877 (Thread-4): Finished running node model.clickhouse_starschema.q2_1
2022-01-08 16:43:08.389332 (Thread-1): Compiling test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e
2022-01-08 16:43:08.389991 (Thread-3): Finished running node model.clickhouse_starschema.q3_3
2022-01-08 16:43:08.409123 (Thread-1): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e"
2022-01-08 16:43:08.409770 (Thread-2): finished collecting timing info
2022-01-08 16:43:08.410581 (Thread-4): Began running node test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0
2022-01-08 16:43:08.411393 (Thread-2): finished collecting timing info
2022-01-08 16:43:08.411935 (Thread-3): Began running node test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1
2022-01-08 16:43:08.412635 (Thread-1): finished collecting timing info
2022-01-08 16:43:08.413630 (Thread-4): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0".
2022-01-08 16:43:08.414668 (Thread-2): Finished running node model.clickhouse_starschema.q4_2
2022-01-08 16:43:08.415669 (Thread-3): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1".
2022-01-08 16:43:08.416391 (Thread-1): finished collecting timing info
2022-01-08 16:43:08.417055 (Thread-4): Compiling test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0
2022-01-08 16:43:08.417897 (Thread-3): Compiling test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1
2022-01-08 16:43:08.419093 (Thread-1): Finished running node test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e
2022-01-08 16:43:08.429622 (Thread-3): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1"
2022-01-08 16:43:08.430680 (Thread-4): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0"
2022-01-08 16:43:08.430869 (Thread-2): Began running node test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00
2022-01-08 16:43:08.431570 (Thread-2): Acquiring new clickhouse connection "test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00".
2022-01-08 16:43:08.431739 (Thread-2): Compiling test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00
2022-01-08 16:43:08.431968 (Thread-3): finished collecting timing info
2022-01-08 16:43:08.432159 (Thread-4): finished collecting timing info
2022-01-08 16:43:08.435948 (Thread-2): Writing injected SQL for node "test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00"
2022-01-08 16:43:08.436182 (Thread-3): finished collecting timing info
2022-01-08 16:43:08.436422 (Thread-4): finished collecting timing info
2022-01-08 16:43:08.436841 (Thread-3): Finished running node test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1
2022-01-08 16:43:08.437130 (Thread-4): Finished running node test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0
2022-01-08 16:43:08.437340 (Thread-2): finished collecting timing info
2022-01-08 16:43:08.437688 (Thread-2): finished collecting timing info
2022-01-08 16:43:08.437997 (Thread-2): Finished running node test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00
2022-01-08 16:43:08.438773 (MainThread): Connection 'master' was properly closed.
2022-01-08 16:43:08.438946 (MainThread): Connection 'test.clickhouse_starschema.dbt_utils_equal_rowcount_lineorder_flat_ref_lineorder_.9b1be9867e' was properly closed.
2022-01-08 16:43:08.439091 (MainThread): Connection 'test.clickhouse_starschema.dbt_utils_at_least_one_q4_2_.532023ee00' was properly closed.
2022-01-08 16:43:08.439231 (MainThread): Connection 'test.clickhouse_starschema.dbt_utils_at_least_one_q3_3_.38271241a1' was properly closed.
2022-01-08 16:43:08.439366 (MainThread): Connection 'test.clickhouse_starschema.dbt_utils_at_least_one_q2_1_.66dced29c0' was properly closed.
2022-01-08 16:43:08.446109 (MainThread): 19:43:08 | Done.
2022-01-08 16:43:08.447574 (MainThread): Acquiring new clickhouse connection "generate_catalog".
2022-01-08 16:43:08.447740 (MainThread): 19:43:08 | Building catalog
2022-01-08 16:43:08.450993 (ThreadPoolExecutor-1_0): Acquiring new clickhouse connection "db_dbt_test__audit".
2022-01-08 16:43:08.451427 (ThreadPoolExecutor-1_1): Acquiring new clickhouse connection "db".
2022-01-08 16:43:08.457551 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-01-08 16:43:08.459733 (ThreadPoolExecutor-1_1): Opening a new connection, currently in state init
2022-01-08 16:43:08.460199 (ThreadPoolExecutor-1_0): On db_dbt_test__audit: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "db_dbt_test__audit"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'db_dbt_test__audit')
    order by columns.database, columns.table, columns.position;...
2022-01-08 16:43:08.460407 (ThreadPoolExecutor-1_1): On db: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "db"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'db')
    order by columns.database, columns.table, columns.position;...
2022-01-08 16:43:08.460714 (ThreadPoolExecutor-1_0): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:43:08.461084 (ThreadPoolExecutor-1_1): Connecting. Database: default. User: dbtclickhouse
2022-01-08 16:43:08.461323 (ThreadPoolExecutor-1_0): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:43:08.461570 (ThreadPoolExecutor-1_1): Connecting to rc1b-5dfo7kpduthp9j7f.mdb.yandexcloud.net:9440
2022-01-08 16:43:08.864763 (ThreadPoolExecutor-1_1): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:43:08.866249 (ThreadPoolExecutor-1_1): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "db"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'db')
    order by columns.database, columns.table, columns.position;
2022-01-08 16:43:08.867561 (ThreadPoolExecutor-1_1): Block "" send time: 0.000096
2022-01-08 16:43:08.926029 (ThreadPoolExecutor-1_0): Connected to ClickHouse server version 21.11.8, revision: 54450
2022-01-08 16:43:08.927031 (ThreadPoolExecutor-1_0): Query: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "db_dbt_test__audit"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'db_dbt_test__audit')
    order by columns.database, columns.table, columns.position;
2022-01-08 16:43:08.927974 (ThreadPoolExecutor-1_0): Block "" send time: 0.000085
2022-01-08 16:43:09.041877 (ThreadPoolExecutor-1_0): SQL status: OK in 0.58 seconds
2022-01-08 16:43:09.048102 (ThreadPoolExecutor-1_0): On db_dbt_test__audit: No close available on handle
2022-01-08 16:43:09.075606 (ThreadPoolExecutor-1_1): SQL status: OK in 0.61 seconds
2022-01-08 16:43:09.116129 (ThreadPoolExecutor-1_1): On db: No close available on handle
2022-01-08 16:43:09.136623 (MainThread): 19:43:09 | Catalog written to /home/iagaraev/Desktop/courses/OTUS/DHW/ht2_dbt/clickhouse_starschema/target/catalog.json
2022-01-08 16:43:09.137071 (MainThread): Flushing usage events
2022-01-08 16:43:09.137396 (MainThread): Connection 'generate_catalog' was properly closed.
2022-01-08 16:43:09.137683 (MainThread): Connection 'db_dbt_test__audit' was properly closed.
2022-01-08 16:43:09.138021 (MainThread): Connection 'db' was properly closed.
2022-01-08 16:43:09.138362 (MainThread): unclosed <ssl.SSLSocket fd=5, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=6, laddr=('192.168.2.17', 33610), raddr=('51.250.28.188', 9440)>
2022-01-08 16:43:12.887174 (MainThread): Running with dbt=0.21.1
2022-01-08 16:43:13.053393 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='/home/iagaraev/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='serve', write_json=True)
2022-01-08 16:43:13.062422 (MainThread): Tracking: do not track
2022-01-08 16:43:13.071040 (MainThread): Serving docs at 0.0.0.0:8080
2022-01-08 16:43:13.071239 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2022-01-08 16:43:13.071388 (MainThread): Press Ctrl+C to exit.


2022-01-08 16:46:09.855305 (MainThread): Flushing usage events
2022-01-08 16:46:09.865410 (MainThread): ctrl-c
